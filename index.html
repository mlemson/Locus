<!DOCTYPE html>
<html lang="nl">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta title="LOCUS Digitaal">
	<script>
		// Prevent pinch/double-touch zoom on phones; keep single-finger scrolling intact.
		(function disableTouchZoom() {
			try {
				const isCoarse = window.matchMedia && window.matchMedia('(pointer: coarse)').matches;
				if (!isCoarse) return;
				const blockPinch = (e) => {
					if (e.touches && e.touches.length > 1) {
						e.preventDefault();
					}
				};
				const canScroll = (el) => {
					if (!el || !el.closest) return false;
					if (el.closest('#green-zone, #blue-zone, #card-options, #preworld-pick-grid, #deck-modal-content, #blackhole-card-grid')) return true;
					let node = el;
					while (node && node !== document.body && node !== document.documentElement) {
						try {
							const style = window.getComputedStyle(node);
							const overflowY = style.overflowY;
							const overflowX = style.overflowX;
							const canScrollY = (overflowY === 'auto' || overflowY === 'scroll') && node.scrollHeight > node.clientHeight + 1;
							const canScrollX = (overflowX === 'auto' || overflowX === 'scroll') && node.scrollWidth > node.clientWidth + 1;
							if (canScrollY || canScrollX) return true;
						} catch (_) {}
						node = node.parentElement;
					}
					return false;
				};
				const blockPageScroll = (e) => {
					if (!canScroll(e.target)) e.preventDefault();
				};
				window.addEventListener('touchmove', blockPinch, { passive: false });
				window.addEventListener('touchmove', blockPageScroll, { passive: false });
				window.addEventListener('gesturestart', e => e.preventDefault());
				window.addEventListener('gesturechange', e => e.preventDefault());
				window.addEventListener('gestureend', e => e.preventDefault());
			} catch (_) {}
		})();
	</script>
	<script>
		/*
			EN:
			- WHY: Apply the saved theme class as early as possible to avoid a flash of the wrong theme.
		*/
		(function preloadThemeClass() {
			try {
				// Force dark mode as the default. We still keep the DOMContentLoaded
				// handler as the source-of-truth for toggles, but ensure the page
				// renders in dark immediately to avoid a flash of the wrong theme.
				document.documentElement.classList.add('dark-mode');
				// Also inject a minimal inline style to ensure immediate dark background
				// and text color before external/embedded CSS parses fully.
				var _s = document.createElement('style');
				_s.setAttribute('data-locus-theme-preload','true');
				_s.textContent = 'html,body { background: #1b1d22; color: #e5e5e5; }\n'
					+ '#menu-toggle { background: var(--color-menu-bg, #2f3546); border-color: var(--shadow-light, rgba(255,255,255,0.12)); }\n'
					+ '#menu-toggle span { background: rgba(255,255,255,0.88); }\n'
					+ '#mobile-objective-banner, #ml-objective-top { background: transparent; }\n'
					+ '#objective-zone { background: rgba(34,37,43,0.95); color: var(--color-text-light, #e5e5e5); }\n'
					+ '.card { background: var(--color-dark-gray, #333); color: inherit; }';
				document.head.appendChild(_s);
			} catch (e) {
				// Ignore storage or DOM errors (private mode / blocked storage).
			}
		})();
	</script>
		<style>
			/*
				EN: Comment tags used throughout this file:
				- WHY: reason the code exists / design intent
				- STATE: what global state / DOM state is read or written
				- OVERRIDE: this block can be overwritten later (order-dependent)
				- DUPLICATE: a similar rule/handler exists elsewhere (risk of divergence)
				- LEGACY: kept for backwards compatibility / older UI paths
				
				Note: This is a single-file app with large CSS + JS blocks; ordering matters.
			*/

			/* === Shared defaults (desktop look from 22-10 + mobile HUD from 23-10-3) === */
			html {
				min-height: 100%;
				background: var(--color-dark-bg);
				overflow-y: hidden;
				overflow-x: hidden;
				overscroll-behavior: contain;
				/* Prevent browser back-navigation on horizontal swipe (iOS Safari, Chrome) */
				overscroll-behavior-x: none;
			}

			body {
				margin: 0;
				position: relative;
				padding: 10px;
				min-height: 100%;
				width: 100%;
				overflow: hidden;
				overflow-x: hidden;
				overflow-y: hidden;
				overscroll-behavior: none;
				background: var(--color-dark-bg);
				/*
					IMPORTANT (mobile/iOS): never put emoji fonts before system UI fonts.
					Otherwise digits can render in Apple Color Emoji, which looks "weird".
					Keep emoji fonts at the end so emoji still work when needed.
				*/
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif, "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji";
				font-size: 16px;
				/*
					EN:
					- STATE: sets the page base typography + background.
				*/
				gap: 10px;
				grid-template-columns: auto;
				justify-content: center;
				align-items: start;
				color: var(--color-text-light);
				transition: background-color 0.3s, color 0.3s;
			}

			@media (max-width: 900px), (hover: none) and (pointer: coarse) {
				html, body {
					height: 100%;
					overflow: hidden;
					overscroll-behavior: none;
				}
			}

		:root {
			/* Base measurements */
			/* Fixed across all grids; the board itself is scaled to fit the screen. */
			--cell-size: 26px;
			--board-grid-gap: 2px;
			--preview-gap: 2px;
			--gap: 10px;
			--radius: 10px;
			--bottom-height: 70px;
			--side-panel-width: 120px;
			--card-size: 150px;

			/* Bottom bar sizing */
			--bottom-bar-gap: 0px;
			--bottom-bar-bottom-offset: 0px;
			--card-hand-lift: 12px;

			/* Z-index scale */
			--z-bottom: 450;      /* bottom bar */
			--z-controls: 1000;   /* controls panel */
			--z-menu: 1100;       /* menu / hamburger (must stay above other UI) */
			--z-ui: 250;          /* generic UI buttons */
			--z-blur: 400;        /* blur backdrop */
			--z-zoom: 500;        /* focused/zoomed zone */
			--z-drag: 600;        /* drag overlay (highest for dragged items) */
			--z-score: 700;       /* transient score / sparkle popups */
			--z-draggable: 600;   /* draggable block default */



			/* Colors - Dark mode (REFACTORED: Phase 2) */
			--main-bg-dark: #1a1a1a;
			--panel-bg-dark: #2d2d2d;
			--score-bg-dark: rgba(45,45,45,0.9);
			--card-bg-dark: #2d2d2d;
			
			/* Refactored colors - Phase 2 */
			--color-dark-bg: #1b1d22;
			--color-dark-panel: #2d2d2d;
			--color-text-light: #e5e5e5;
			--color-accent-blue: #4a90e2;
			--color-menu-bg: #2f3546;
			--color-dark-gray: #333;
			--color-border-dark: #2d2f36;
			
			/* Shadow utilities */
			--shadow-light: rgba(0,0,0,0.12);
			--shadow-medium: rgba(0,0,0,0.3);
			--shadow-dark: rgba(0,0,0,0.5);
		}

		* {
			box-sizing: border-box;
		}

		#drag-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100vw;
			height: 100vh;
			pointer-events: none;
			cursor: none;
			z-index: var(--z-drag);
		}

	/* Floating preview voor touch-vriendelijke kaart plaatsing */
	#floating-preview {
		position: fixed;
		/* Positie wordt dynamisch ingesteld via JS */
		width: 138px;
		min-height: 180px;
		padding: 16px;
		display: none;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: 12px;
		border-radius: 16px;
		background: linear-gradient(165deg, #ffffff 0%, #eef2ff 45%, #dfe4ff 100%);
		border: 2px solid #4a90e2;
		box-shadow: 0 18px 26px rgba(10,12,20,0.3);
		z-index: calc(var(--z-zoom) + 50);
		touch-action: none;
		cursor: grab;
		transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
		transform: scale(0.8);
		opacity: 0;
		overflow: visible;
	}		#floating-preview.dragging {
			cursor: grabbing;
			transform: scale(1.1);
			box-shadow: 0 12px 32px rgba(0,0,0,0.4);
		}

	body.dark-mode #floating-preview {
		background: linear-gradient(165deg, #2d2d2d 0%, #1f2233 45%, #1a1d2e 100%);
		border-color: #5a9fd4;
	}	#floating-preview-pattern {
		width: 100%;
		flex: 1;
		display: flex;
		align-items: center;
		justify-content: center;
		pointer-events: none;
		position: relative;
		z-index: 1;
	}		#floating-preview-rotate {
			position: absolute;
			top: 6px;
			right: 6px;
			width: 36px;
			height: 36px;
			background: #4a90e2;
			border: 2px solid white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 18px;
			color: white;
			cursor: pointer;
			touch-action: none;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			z-index: 1;
			user-select: none;
		}

		#floating-preview-rotate:active {
			transform: scale(0.95);
		}

		body.dark-mode #floating-preview-rotate {
			background: #5a9fd4;
			border-color: #1e2128;
		}

		#floating-preview-mirror {
			position: absolute;
			bottom: 6px;
			right: 6px;
			width: 36px;
			height: 36px;
			background: #9b59b6;
			border: 2px solid white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 18px;
			color: white;
			cursor: pointer;
			touch-action: none;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			z-index: 1;
			user-select: none;
		}

		#floating-preview-mirror:active {
			transform: scale(0.95);
		}

		body.dark-mode #floating-preview-mirror {
			background: #8e44ad;
			border-color: #1e2128;
		}

		#floating-preview-cancel {
			position: absolute;
			top: 6px;
			left: 6px;
			width: 36px;
			height: 36px;
			background: #e74c3c;
			border: 2px solid white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 20px;
			color: white;
			cursor: pointer;
			touch-action: none;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			z-index: calc(var(--z-zoom) + 51);
			user-select: none;
		}

		#floating-preview-cancel:active {
			transform: scale(0.95);
		}

		body.dark-mode #floating-preview-cancel {
			background: #c0392b;
			border-color: #1e2128;
		}

		/* Zoom-lens voor plaatsing preview */
		#placement-zoom-lens {
			position: fixed;
			width: 160px;
			height: 160px;
			background: rgba(255, 255, 255, 0.98);
			border: 3px solid #4a90e2;
			border-radius: 16px;
			box-shadow: 0 12px 32px rgba(0,0,0,0.5), 0 0 0 2px rgba(74, 144, 226, 0.3);
			z-index: calc(var(--z-zoom) + 1);
			pointer-events: none;
			transition: opacity 0.15s ease;
		}

		body.dark-mode #placement-zoom-lens {
			background: rgba(30, 33, 40, 0.98);
			border-color: #5a9fd4;
			box-shadow: 0 12px 32px rgba(0,0,0,0.7), 0 0 0 2px rgba(90, 159, 212, 0.3);
		}

		#zoom-lens-content {
			width: 100%;
			height: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 8px;
			overflow: hidden;
		}

		#zoom-lens-content .zoom-grid {
			display: grid;
			gap: var(--board-grid-gap, 2px);
			transform: scale(1.5);
			transform-origin: center;
		}

		#zoom-lens-content .zoom-cell {
			border-radius: 2px;
			border: 1px solid rgba(0,0,0,0.15);
		}

		body.dark-mode #zoom-lens-content .zoom-cell {
			border-color: rgba(255,255,255,0.2);
		}

		#zoom-lens-content .zoom-cell.filled {
			box-shadow: 0 2px 4px rgba(0,0,0,0.2);
		}

		#zoom-lens-content .zoom-cell.preview {
			opacity: 0.7;
			border: 2px solid rgba(74, 144, 226, 0.8);
		}

		#zoom-lens-content .zoom-cell.preview.valid {
			border-color: rgba(76, 175, 80, 0.9);
			box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
		}

		#zoom-lens-content .zoom-cell.preview.invalid {
			border-color: rgba(244, 67, 54, 0.9);
			box-shadow: 0 0 8px rgba(244, 67, 54, 0.4);
		}


		body .blur-overlay {
			pointer-events: none;
		}

		/* ============================================
		   DARK MODE - BASIS STYLING
		   ============================================
		*/
		body.dark-mode {
			background: var(--color-dark-bg);
			color: var(--color-text-light);
		}

		.board {
			display: flex;
			gap: 12px; /* ruimte tussen kolommen */
			margin: 0 auto;
			margin-top: 50px;
			touch-action: manipulation;
			position: relative;
			z-index: 1;
			transition: transform 0.25s ease;
		}

		body.board-scaled {
			overflow-y: auto;
		}

		body.board-scaled .board {
			transform-origin: top center;
		}

	.column {
		display: flex;
		flex-direction: column;
		gap: 12px; /* ruimte tussen vakken in dezelfde kolom */
		flex: 1; /* kolommen gelijk breed op mobiel */
	}
	.zone {
		/* Geen background hier - wordt per zone ingesteld */
		position: relative;
		border-radius: 10px;
		border: 1px solid #e3e6ea;
		box-shadow: 0 2px 6px rgba(0,0,0,0.12);
		box-sizing: border-box;
		padding: 10px;
		margin: 10px;
		touch-action: manipulation;
		transition: transform 0.3s ease;
		z-index: 1;
	}

	body.debug-mode .zone .cell:not(.void-cell) {
		cursor: pointer;
	}

	.red-group {
		display: flex;
		flex-wrap: wrap;
		gap: 8px;
		justify-content: center;
	}

	.red-group.zoom-focus {
		width: auto;
		min-height: 400px; /* Minimum height, niet fixed */
		height: auto; /* Laat content de height bepalen */
	}


	body.dark-mode .zone {
		border: 1px solid var(--color-border-dark);
		box-shadow: 0 4px 10px var(--shadow-dark);
	}.zone-placeholder {
			pointer-events: none;
			position: relative;
		}

		.blur-overlay {
			display: none;
			position: fixed;
			inset: 0;
			background: rgba(0, 0, 0, 0.4);
			backdrop-filter: blur(4px);
			-webkit-backdrop-filter: blur(4px);
			z-index: var(--z-blur);
		}

		body.zoomed-in .blur-overlay {
			display: block;
		}

		.zone.zoom-focus {
			position: fixed;
			top: 22%;
			left: 50%;
			transform: translate(-50%, -50%) scale(1.25);
			z-index: var(--z-zoom);
			box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
			margin: 2px;
			padding: 3px;
			border-radius: 6px;
		}

		/* Mobile (incl. larger phones): use the same zoom sizing as the compact (<550px) layout. */
		@media (max-width: 900px) {
			.zone.zoom-focus {
				position: fixed;
				top: 25%;
				left: 50%;
				transform: translate(-50%, -50%) scale(0.95);
				z-index: var(--z-zoom);
				box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
				margin: 2px;
				padding: 3px;
				border-radius: 6px;
			}

			/* Red zone: keep proportions in zoom, like compact mobile. */
			#red-zone.zoom-focus {
				flex-wrap: wrap;
				flex-direction: row;
				width: auto;
				min-width: 380px;
				height: auto;
				max-width: 90vw;
			}
		}

		/* World 3 red can be much taller; keep it centered + scrollable on mid-size viewports.
		   (â‰¤650px uses the uniform fixed-height zoom rules later.) */
		@media (min-width: 651px) and (max-width: 900px) {
			body.zoomed-in #red-zone.zoom-focus {
				top: 50%;
				transform: translate(-50%, -50%) scale(0.95);
				max-height: 85vh;
				max-height: 85svh;
				overflow: auto;
				-webkit-overflow-scrolling: touch;
				/* Ensure it stays above the blur overlay */
				z-index: var(--z-zoom);
			}
		}

		@media (max-width: 650px) {
			body.zoomed-in #yellow-zone.zoom-focus,
			body.zoomed-in #blue-zone.zoom-focus {
				top: calc(22% + 50px);
			}
		}

		/* Phone landscape (short height): scale board down so everything fits.
		   Keep this limited to coarse pointers to avoid shrinking desktop windows. */
		@media (max-height: 600px) and (orientation: landscape) and (pointer: coarse) {
			:root {
				--cell-size: 26px;
			}
		}

		/* ===== MOBILE SIDEBAR LAYOUT =====
		   Used for both mobile landscape AND mobile portrait on phones.
		   Board center, options in slim sidebars. */
		body.mobile-sidebar-layout {
			overflow: hidden;
			max-height: 100vh;
			max-height: 100svh;
		}

		body.mobile-sidebar-layout,
		body.mobile-sidebar-layout html {
			overflow: hidden;
		}

		/* Hamburger menu in mobile sidebar layout */
	body.mobile-sidebar-layout.mobile-sidebar-layout #menu-toggle {
		position: fixed;
		top: 4px;
		left: 4px;
		z-index: 1100;
		width: 36px;
		height: 36px;
		display: flex;
	}

	body.mobile-sidebar-layout.mobile-sidebar-layout #controls {
		position: fixed;
		top: 44px;
		left: 4px;
		z-index: 1099;
		max-height: calc(100vh - 50px);
		max-height: calc(100svh - 50px);
		overflow-y: auto;
	}

	body.mobile-sidebar-layout.mobile-sidebar-layout #bottom-bar {
		display: none !important;
	}

	body.mobile-sidebar-layout.mobile-sidebar-layout #mobile-objective-banner {
		}

		/* Safety net: if the sidebar class ever lingers, never apply it in portrait. */
		@media (max-width: 650px) and (orientation: portrait) {
			body.mobile-sidebar-layout {
				overflow: auto;
				max-height: none;
			}
			body.mobile-sidebar-layout html {
				overflow: auto;
			}
			body.mobile-sidebar-layout.mobile-sidebar-layout #mobile-landscape-wrapper {
				display: none !important;
			}
			body.mobile-sidebar-layout.mobile-sidebar-layout #bottom-bar {
				display: flex !important;
			}
			body.mobile-sidebar-layout.mobile-sidebar-layout #mobile-objective-banner {
				display: flex !important;
			}
		}

		/* Mobile landscape sidebar zoom mode */
		body.mobile-sidebar-layout.zoomed-in .zone.zoom-focus {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%) scale(0.85);
			z-index: var(--z-zoom);
			box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
			margin: 0;
			padding: 6px;
			border-radius: 8px;
			max-width: 100vw;
			max-height: 85vh;
			max-height: 85svh;
			overflow: auto;
		}

		body.mobile-sidebar-layout.mobile-sidebar-layout.zoomed-in #red-zone.zoom-focus {
			display: grid;
			grid-template-columns: repeat(2, max-content);
			width: auto;
			max-width: 100vw;
		}

		body.mobile-sidebar-layout.mobile-sidebar-layout.zoomed-in .zone-nav-arrow {
			display: flex !important;
		}

		body.mobile-sidebar-layout.mobile-sidebar-layout #mobile-landscape-wrapper {
			display: flex !important;
			flex-direction: row;
			align-items: stretch;
			justify-content: center;
			width: 100vw;
			height: 100vh;
			height: 100svh;
			gap: 2px;
			padding: 2px;
			padding-left: 44px; /* Room for hamburger */
			box-sizing: border-box;
			overflow: hidden;
		}

		body.mobile-sidebar-layout.mobile-sidebar-layout #ml-sidebar-left,
		body.mobile-sidebar-layout.mobile-sidebar-layout #ml-sidebar-right {
			display: flex !important;
			flex-direction: column;
			gap: 2px;
			flex: 0 0 auto;
			width: 58px;
			min-width: 50px;
			max-width: 70px;
			overflow-y: auto;
			overflow-x: hidden;
			scrollbar-width: none;
		}

		/* Landscape: slightly wider sidebars */
		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-left,
			body.mobile-sidebar-layout #ml-sidebar-right {
				width: 72px;
				min-width: 65px;
				max-width: 90px;
				gap: 3px;
			}
			
			body.mobile-sidebar-layout #mobile-landscape-wrapper {
				gap: 4px;
				padding: 4px;
			}
		}

		body.mobile-sidebar-layout #ml-sidebar-left::-webkit-scrollbar,
		body.mobile-sidebar-layout #ml-sidebar-right::-webkit-scrollbar {
			display: none;
		}

		body.mobile-sidebar-layout #ml-board-center {
			/* Don't expand to fill all remaining width: keep sidebars close to the board
			   (fixes "options too far to the sides" on phone landscape). */
			flex: 0 1 auto;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: center;
			min-width: 0;
			overflow: hidden;
			gap: 2px;
		}

		/* Small-ish desktop landscape: slightly smaller cells so zones fit cleanly. */
		@media (min-width: 651px) and (orientation: landscape) and (max-height: 760px) {
			body.desktop-landscape {
				--cell-size: 26px;
			}
		}

		/* Mid-size desktop landscape (e.g. ~950px wide / ~925px tall):
		   reduce cell size so symbols don't look oversized and the board fits better. */
		@media (min-width: 801px) and (max-width: 1100px) and (orientation: landscape) and (max-height: 980px) {
			body.desktop-landscape {
				--cell-size: 26px;
			}
		}

		/* Compact objective banner in sidebar layout */
		body.mobile-sidebar-layout #ml-objective-top {
			display: flex !important;
			width: 100%;
			padding: 2px 6px;
			background: rgba(34, 37, 43, 0.95);
			color: var(--color-text-light);
			border-radius: 6px;
			font-size: 0.65rem;
			text-align: center;
			justify-content: center;
			align-items: center;
			flex-shrink: 0;
		}

		body.mobile-sidebar-layout #ml-objective-top #objective-zone {
			min-height: auto;
			padding: 2px 8px;
			font-size: 0.6rem;
		}

		body.mobile-sidebar-layout #ml-objective-top #objective-zone h2 {
			display: none;
		}

		body.mobile-sidebar-layout #ml-board-center #board {
			transform-origin: top center;
		}

		/* Zorg voor gelijke kolomhoogtes in mobiele sidebar layout */
		body.mobile-sidebar-layout #ml-board-center #board {
			display: grid;
			grid-template-columns: repeat(2, minmax(140px, 1fr));
			gap: 8px;
			margin: 0;
		}

		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-board-center #board {
				grid-template-columns: repeat(3, minmax(130px, 1fr));
				align-items: start;
			}
		}

		body.mobile-sidebar-layout #ml-board-center #board .zone {
			margin: 0;
		}

		/* Mobile sidebar styling */
		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard,
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone,
		body.mobile-sidebar-layout #ml-sidebar-right #bonus-zone {
			padding: 3px 4px;
			font-size: 0.6rem;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard h2,
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone h2,
		body.mobile-sidebar-layout #ml-sidebar-right #bonus-zone h2 {
			display: none;
		}

		/* Gold zone in left sidebar */
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 2px;
			padding: 4px;
			background: rgba(255, 215, 0, 0.15);
			border-radius: 6px;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone::after {
			content: attr(data-coin-text);
			display: block;
			font-size: 0.6rem;
			font-weight: 700;
			padding-left: 20px; /* ruimte voor het CSS-coin icoon */
			position: relative;
		}

		/* CSS-drawn coin voor compatibele weergave (fallback voor Emoji/Edge) */
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone::before {
			content: '';
			position: absolute;
			left: 0;
			top: 50%;
			transform: translateY(-50%);
			width: 14px;
			height: 14px;
			border-radius: 50%;
			background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 60%, #d49f20);
			box-shadow: inset 0 -1px 2px rgba(0,0,0,0.2);
			border: 1px solid #c9960a;
		}

body.mobile-sidebar-layout.mobile-sidebar-layout #ml-sidebar-left #gold-zone .buy-placement-btn {
			padding: 3px 5px;
			font-size: 0.45rem;
			display: block;
		}

body.mobile-sidebar-layout.mobile-sidebar-layout #ml-sidebar-left #gold-zone #collected-coins {
			display: none;
		}

		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-left #gold-zone::after {
				font-size: 0.6rem;
			}

			body.mobile-sidebar-layout #ml-sidebar-left #gold-zone .buy-placement-btn {
				padding: 3px 5px;
				font-size: 0.45rem;
			}
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-row {
			padding: 1px 2px;
			font-size: 0.55rem;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-row .label {
			display: none;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-row .color-box {
			width: 8px;
			height: 8px;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-total {
			font-size: 0.7rem;
			padding: 2px;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-total .label {
			display: none;
		}

		body.mobile-sidebar-layout .bonus-inventory {
			flex-direction: column;
			gap: 1px;
		}

		body.mobile-sidebar-layout .bonus-badge {
			padding: 2px 4px;
			font-size: 0.5rem;
		}

		body.mobile-sidebar-layout .bonus-count {
			font-size: 0.45rem;
			padding: 1px 3px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right #card-choice-zone {
			padding: 3px;
			display: flex;
			flex-direction: column;
			gap: 4px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right #card-choice-zone h2,
		body.mobile-sidebar-layout #ml-sidebar-right #kiesKaartTitel,
		body.mobile-sidebar-layout #ml-sidebar-right #card-choice-zone br {
			display: none;
		}

		body.mobile-sidebar-layout #ml-sidebar-right #card-options {
			flex-direction: column;
			gap: 3px;
			order: 1;
		}

		/* Action buttons below cards */
		body.mobile-sidebar-layout #ml-sidebar-right #card-action-buttons {
			order: 2;
			flex-direction: row;
			flex-wrap: wrap;
			justify-content: center;
			gap: 3px;
			margin-top: 4px;
			padding-top: 4px;
			border-top: 1px solid rgba(0,0,0,0.1);
		}

		/* Portrait: smaller cards */
		body.mobile-sidebar-layout #ml-sidebar-right .card-option {
			width: 44px;
			min-height: 50px;
			padding: 2px;
			--preview-cell: 6px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-option .card-cell {
			width: 6px;
			height: 6px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-label {
			font-size: 0.4rem;
			padding: 1px 2px;
		}

		/* Landscape: allow slightly larger cards */
		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-right .card-option {
				width: 58px;
				min-height: 70px;
				padding: 4px;
				--preview-cell: 10px;
			}

			body.mobile-sidebar-layout #ml-sidebar-right .card-option .card-cell {
				width: 9px;
				height: 9px;
			}

			body.mobile-sidebar-layout #ml-sidebar-right .card-label {
				font-size: 0.5rem;
				padding: 2px 4px;
			}
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn {
			width: 22px;
			height: 22px;
			min-width: 22px;
			padding: 2px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn::before {
			font-size: 0.65rem;
		}

		/* Landscape: larger action buttons */
		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn {
				width: 24px;
				height: 24px;
				min-width: 24px;
				padding: 3px;
			}

			body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn::before {
				font-size: 0.7rem;
			}
		}
		
		.zone.portal-active {
			box-shadow: 0 0 12px 4px rgba(100, 200, 255, 0.6);
			animation: portalPulse 2s ease-in-out infinite;
		}
		
		@keyframes portalPulse {
			0%, 100% { box-shadow: 0 0 12px 4px rgba(100, 200, 255, 0.6); }
			50% { box-shadow: 0 0 20px 6px rgba(150, 220, 255, 0.8); }
		}

		/* Blue zone scroll - lang uitgezoomd, kort ingezoomd */


		#blue-zone.zoom-focus {
			/* Keep the zoomed blue zone ~2/3 of the viewport height. */
			max-height: 66vh;
			overflow-y: auto;
			overflow-x: hidden;
			/* Keep blue scrollable but hide the scrollbar visuals (no "scroll wheel"). */
			scrollbar-width: none; /* Firefox */
			-ms-overflow-style: none; /* IE/Edge legacy */
		}
		#blue-zone.zoom-focus::-webkit-scrollbar {
			width: 0;
			height: 0;
			display: none;
		}

		/*
		#red-zone {
			width: 430px;
		}
			*/

		#original-card-zone {
			width: 430px;
		}

		/* Zone navigation arrows */
		.zone-nav-arrow {
			position: fixed;
			top: 50%;
			transform: translateY(-50%);
			z-index: calc(var(--z-zoom) + 1);
			background: rgba(255, 255, 255, 0.9);
			border: 2px solid rgba(40, 55, 120, 0.3);
			border-radius: 50%;
			width: 48px;
			height: 48px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 24px;
			cursor: pointer;
			transition: all 0.2s ease;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
			user-select: none;
		}

		.zone-nav-arrow:hover {
			background: rgba(255, 255, 255, 1);
			transform: translateY(-50%) scale(1.1);
			box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
		}

		.zone-nav-arrow:active {
			transform: translateY(-50%) scale(0.95);
		}

		.zone-nav-arrow-left {
			left: 20px;
		}

		.zone-nav-arrow-right {
			right: 20px;
		}

		body.dark-mode .zone-nav-arrow {
			background: rgba(30, 35, 50, 0.9);
			border-color: rgba(140, 150, 200, 0.4);
			color: rgba(240, 242, 255, 0.9);
		}

		body.dark-mode .zone-nav-arrow:hover {
			background: rgba(40, 45, 60, 1);
		}

		/* === Mobile scaling tweaks (<=650px) === */

	/* ============================================
	   CARD CHOICE ZONE - ADDITIONAL FEATURES
	   ============================================
	   Golden cards and selection disabled states
	*/
	.card-option.card-golden {
		position: relative;
		overflow: hidden;
		/* Golden card = golden frame + glow (keep normal card background/contents). */
		border: 2px solid rgba(220,180,60,0.92);
		box-shadow:
			0 18px 26px rgba(10,12,20,0.2),
			0 0 0 2px rgba(220,180,60,0.50) inset,
			0 0 18px rgba(184,120,18,0.28);
	}

	@keyframes goldenCardShine {
		0% { transform: translateX(-70%) rotate(20deg); }
		100% { transform: translateX(70%) rotate(20deg); }
	}

	/* Subtle shine over the golden frame (does not affect the block colors). */
	.card-option.card-golden::before {
		content: '';
		position: absolute;
		top: -40%;
		left: -40%;
		width: 180%;
		height: 180%;
		background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.55) 45%, rgba(255,255,255,0) 70%);
		opacity: 0.22;
		pointer-events: none;
		transform: translateX(-70%) rotate(20deg);
		animation: goldenCardShine 3.2s linear infinite;
		z-index: 1;
	}

	.card-option.card-golden .card-pattern,
	.card-option.card-golden .card-label,
	.card-option.card-golden .card-meta {
		position: relative;
		z-index: 2;
	}

	.card-option.card-golden::after {
		background: linear-gradient(120deg, rgba(255,255,255,0.95), rgba(255,255,255,0) 60%);
		opacity: 0.72;
		mix-blend-mode: overlay;
	}

	.card-option.card-golden .card-label {
		background: rgba(120,80,0,0.1);
		color: #7c4d00;
	}

	#card-choice-zone .card-option.selection-disabled {
		opacity: 0.45;
		pointer-events: none;
		filter: grayscale(0.25);
	}

	body.dark-mode .card-option.card-golden {
		border: 2px solid rgba(200,160,30,0.78);
		box-shadow:
			0 26px 44px rgba(0,0,0,0.55),
			0 0 0 2px rgba(200,160,30,0.32) inset,
			0 0 18px rgba(227,196,94,0.22);
	}

	body.dark-mode .card-option.card-golden::before {
		opacity: 0.18;
	}

	body.dark-mode .card-option.card-golden .card-label {
		background: rgba(255,220,120,0.12);
		color: #ffe79a;
	}

	/*
		#card-choice-zone defines its own (more specific) `.card-option` background later.
		These overrides ensure golden styling remains visible inside the card-choice UI.
	*/
	#card-choice-zone .card-option.card-golden {
		border: 2px solid rgba(220,180,60,0.92);
		box-shadow:
			0 18px 26px rgba(10,12,20,0.2),
			0 0 0 2px rgba(220,180,60,0.50) inset,
			0 0 18px rgba(184,120,18,0.28);
	}

	body.dark-mode #card-choice-zone .card-option.card-golden {
		border: 2px solid rgba(200,160,30,0.78);
		box-shadow:
			0 26px 44px rgba(0,0,0,0.55),
			0 0 0 2px rgba(200,160,30,0.32) inset,
			0 0 18px rgba(227,196,94,0.22);
	}

	body.dark-mode #card-choice-zone .card-option.selection-disabled {
		opacity: 0.32;
		filter: grayscale(0.4);
	}

	/* Deck kopie kaart (extraHandSize upgrade) */
	#card-choice-zone .card-option.card-deck-copy {
		position: relative;
		border: 2px dashed rgba(100, 140, 255, 0.6);
	}
	#card-choice-zone .card-option.card-deck-copy::before {
		content: 'ðŸ“‹';
		position: absolute;
		top: -8px;
		right: -8px;
		font-size: 16px;
		background: #fff;
		border-radius: 50%;
		padding: 2px;
		box-shadow: 0 2px 6px rgba(0,0,0,0.2);
		z-index: 10;
	}
	body.dark-mode #card-choice-zone .card-option.card-deck-copy {
		border-color: rgba(140, 180, 255, 0.5);
	}
	body.dark-mode #card-choice-zone .card-option.card-deck-copy::before {
		background: #2a2a3a;
	}

	/* Lucky draw kopie kaart */
	#card-choice-zone .card-option.card-lucky-copy {
		position: relative;
		border: 2px dashed rgba(80, 200, 80, 0.6);
	}
	#card-choice-zone .card-option.card-lucky-copy::before {
		content: 'ðŸ€';
		position: absolute;
		top: -8px;
		right: -8px;
		font-size: 16px;
		background: #fff;
		border-radius: 50%;
		padding: 2px;
		box-shadow: 0 2px 6px rgba(0,0,0,0.2);
		z-index: 10;
	}
	body.dark-mode #card-choice-zone .card-option.card-lucky-copy {
		border-color: rgba(120, 220, 120, 0.5);
	}
	body.dark-mode #card-choice-zone .card-option.card-lucky-copy::before {
		background: #2a2a3a;
	}

	/*
		EN:
		- DUPLICATE/OVERRIDE: There are many `@media (max-width: 650px)` blocks in this file.
		  They stack and later rules win, so the *order* in this CSS file is part of the behavior.
		- TIP: If something "randomly" changes on mobile, search for the same selector in later @media blocks.
	*/
	@media (max-width: 650px) {


	#bottom-bar {
		padding-left: 5px;
		padding-right: 5px;
	}

	  #bottom-bar-score,
	  #bottom-bar-coins {
		flex: 0 0 50%;
		min-width: 0;
	  }

	  #bottom-bar #scoreboard,
	  #bottom-bar #gold-zone {
		width: 100%;
		padding: 6px 10px;
		box-sizing: border-box;
	  }

	  #bottom-bar #gold-zone {
		min-width: 0;
	  }

	  #bottom-bar #new-cards-btn {
		height: 48px;
		padding: 8px 12px;
		font-size: 0.76rem;
	  }

	  #bottom-bar #rotate-card-btn {
		height: 44px;
		padding: 7px 12px;
		font-size: 0.7rem;
		margin-top: 8px;
		width: 104px;
	  }

	  #bottom-bar #card-options .card-option {
		max-width: 110px;
	  }
	}

	@media (max-width: 650px) {
	  .bottom-bar-footer {
		display: flex;
		flex-direction: column;
		align-items: stretch;
		gap: 2px;
		justify-content: flex-start;
		margin-top: 10px;
	  }

	  #bottom-bar-left {
		display: flex;
		flex-direction: column;
		flex-wrap: nowrap;
		gap: 4px;
		flex: 1 1 auto;
		min-width: 0;
		align-items: stretch;
	  }

	  #bottom-bar-bonus {
		order: 2;
		flex: 0 0 auto;
		display: flex;
		flex-direction: column;
		align-items: stretch;
		justify-content: flex-start;
		gap: 8px;
	  }

	  #bottom-bar-score-coins {
		display: flex;
		flex-direction: row;
		gap: 4px;
		align-items: center;
		order: 3;
		flex: 1 1 auto;
		min-width: 0;
	  }

	  #bottom-bar-score {
		flex: 1 1 auto;
		min-width: 0;
	  }

	  #bottom-bar-coins {
		display: none;
	  }

	  #bottom-bar #scoreboard,
	  #bottom-bar #gold-zone {
		width: 100%;
		box-sizing: border-box;
		height: auto;
	  }

	  #bottom-bar #bonus-zone {
		width: auto;
		flex: 1 1 auto;
		min-width: 0;
		padding: 6px 8px;
	  }

	  /* Place the coin panel next to the bonus inventory. */
	  #bottom-bar-bonus #gold-zone {
		width: 100%;
		flex: 0 0 auto;
		padding: 3px 6px;
		margin: 0;
		display: flex;
		flex-direction: column;
		align-items: stretch;
		justify-content: flex-start;
		gap: 4px;
	  }
	  #bottom-bar-bonus #gold-zone .buy-placement-btn {
		margin-left: 0;
	  }
	  

	#bottom-bar #collected-coins {
		grid-template-rows: repeat(3, 12px);
		grid-auto-columns: 12px;
		column-gap: 4px;
		row-gap: 4px;
	}
	}


	@media (max-width: 650px) {
		:root {
			--bottom-bar-height: 140px;
			--bottom-bar-gap: 4px;
			--bottom-bar-bottom-offset: -16px;
			--card-hand-lift: 0px;
			--hand-card-width: 40px;
			--hand-card-gap: 4px;
			--hand-card-height: 80px;
		}

		#bottom-bar {
			padding-left: 5px;
			padding-right: 5px;
			margin-bottom: 5px;
		}

		#bottom-bar #scoreboard,
		#bottom-bar #gold-zone {
			padding: 6px 8px;
		}

		#bottom-bar #gold-zone {
			min-width: 0;
			gap: 9px;
		}

		#bottom-bar #card-options {
			padding-left: 0;
			padding-right: 0;
			touch-action: none;
			overflow-y: hidden;
		}

	  #bonus-zone .bonus-hint {
		display: none;
	  }

	  #bottom-bar #scoreboard {
		--score-chip-gap: 3px;
	  }
	  
	  /* Hide desktop bonus-zone on mobile (it's in bottom-bar) */
	  #original-bonus-zone {
		display: none;
	  }

	  #bottom-bar #scoreboard .score-row {
		font-size: 0.62rem;
		padding: 2px 4px;
	  }

	  #bottom-bar #scoreboard .score-row .color-box {
		width: 8px;
		height: 8px;
	  }

	  #bottom-bar #scoreboard .score-row .score {
		font-size: 0.66rem;
	  }

	  #bottom-bar #scoreboard .score-total {
		font-size: 0.68rem;
	  }

	  #bottom-bar #scoreboard .score-total .total-score {
		font-size: 0.78rem;
	  }

	  #bottom-bar #scoreboard .score-total .label {
		font-size: 0.64rem;
	  }

	#bottom-bar #card-choice-zone .card-option {
		width: var(--hand-card-width);
		max-width: var(--hand-card-width);
		height: var(--hand-card-height);
		min-height: var(--hand-card-height);
		align-self: flex-start;
		--preview-cell: 6px;
		border-radius: 6px;
		padding: 2px 3px 3px;
		gap: 2px;
	}

	#bottom-bar #card-choice-zone .card-option .card-cell {
		border-radius: 1px;
	}

	  #bottom-bar #new-cards-btn {
		height: 36px;
		padding: 6px 11px;
		font-size: 0.66rem;
	  }

	  #bottom-bar #rotate-card-btn {
		height: 34px;
		padding: 6px 10px;
		font-size: 0.62rem;
		width: 102px;
		margin-top: 6px;
	  }

	#bottom-bar #collected-coins {
		grid-template-rows: repeat(3, 12px);
		grid-auto-columns: 12px;
		column-gap: 4px;
		row-gap: 4px;
	}

	#bottom-bar .coin {
		width: 12px;
		height: 12px;
	}
	}

	@media (max-width: 520px) {
	  :root {
		--bottom-bar-height: 120px;
		--bottom-bar-gap: 4px;
		--card-hand-lift: 0px;
		--hand-card-width: 40px;
		--hand-card-gap: 4px;
		--hand-card-height: 80px;
	  }

	  #bottom-bar {
		padding-left: 4px;
		padding-right: 4px;
		padding-bottom: 4px;
	  }

	  #bottom-bar-cards {
		margin-top: 0;
		height: calc(var(--hand-card-height) + 20px);
	  }

	  #bottom-bar #card-options {
		display: flex;
		gap: 4px;
		align-items: flex-start;
		justify-content: flex-start;
		flex-wrap: nowrap;
		scroll-snap-type: x proximity;
		flex: 1 1 auto;
		min-width: 0;
		width: auto;
		max-width: 100%;
		transform: translateY(0px);
		padding: 0 0 8px 0;
		touch-action: pan-x;
		overflow-x: auto;
		overflow-y: hidden;
		scrollbar-width: thin;
		scrollbar-color: rgba(255,255,255,0.3) transparent;
	  }
	  
	  #bottom-bar #card-options::-webkit-scrollbar {
		height: 4px;
	  }
	  #bottom-bar #card-options::-webkit-scrollbar-track {
		background: transparent;
		border-radius: 2px;
	  }
	  #bottom-bar #card-options::-webkit-scrollbar-thumb {
		background: linear-gradient(90deg, rgba(255,255,255,0.25), rgba(200,210,255,0.35));
		border-radius: 2px;
	  }
	  #bottom-bar #card-options::-webkit-scrollbar-thumb:hover {
		background: linear-gradient(90deg, rgba(255,255,255,0.4), rgba(200,210,255,0.5));
	  }

	  #bottom-bar #card-choice-zone .card-option {
		width: var(--hand-card-width);
		height: var(--hand-card-height);
		min-height: var(--hand-card-height);
		align-self: flex-start;
		--preview-cell: 6px;
		border-radius: 6px;
		padding: 3px 4px 5px;
		gap: 2px;
	  }

	  #bottom-bar #card-choice-zone .card-option .card-cell {
		border-radius: 1px;
	  }

	/* Mobile: scale hand cards up on wider phones (use extra space).
	   Base (<=290px): 40x80
	   >290px: +33%
	   >340px: +66%
	   >390px: +100% (2x)
	*/
	@media (max-width: 650px) and (min-width: 291px) {
		:root {
			--hand-card-width: 53px;
			--hand-card-height: 90px;
			--bottom-bar-height: 170px;
		}
		#bottom-bar #card-choice-zone .card-option { --preview-cell: 8px; }
	}
	@media (max-width: 650px) and (min-width: 341px) {
		:root {
			--hand-card-width: 66px;
			--hand-card-height: 115px;
			--bottom-bar-height: 200px;
		}
		#bottom-bar #card-choice-zone .card-option { --preview-cell: 10px; }
	}
	@media (max-width: 650px) and (min-width: 391px) {
		:root {
			--hand-card-width: 80px;
			--hand-card-height: 140px;
			--bottom-bar-height: 230px;
		}
		#bottom-bar #card-choice-zone .card-option { --preview-cell: 12px; }
	}

	  #bottom-bar #card-choice-zone .card-option .card-cell {
		width: 8px;
		height: 8px;
	  }

	  #bottom-bar #card-choice-zone .card-option .card-pattern {
		gap: var(--preview-gap);
	  }

	  #bottom-bar #card-choice-zone .card-option .card-label {
		font-size: 0.52rem;
		padding: 1px 4px;
		gap: 1px;
	  }

	  #bottom-bar #card-choice-zone .card-option .card-label .label-dot {
		width: 5px;
		height: 5px;
	  }

	  #bottom-bar #new-cards-btn,
	  #bottom-bar #rotate-card-btn {
		width: 40px;
		height: 40px;
	  }

	  #bottom-bar #new-cards-btn::before {
		font-size: 1.6rem;
	  }

	  #bottom-bar #rotate-card-btn::before {
		font-size: 1.4rem;
	  }

	  .deck-count {
		padding: 5px 10px;
		font-size: 0.9rem;
		min-width: 45px;
		gap: 5px;
		border-radius: 9px;
	  }

	  .deck-count::before {
		font-size: 1rem;
	  }


	  #bottom-bar-left {
		gap: 3px;
	  }

	  .bottom-bar-footer {
		padding: 2px 3px 0;
	  }
	}


	@media (max-width: 650px) {
		:root {
			/* Use 0.5 for pixel-perfect scaling: 2px gaps become clean 1px after scaling */
			--board-scale: 0.5;
		}

		/* Classic mode (mobile): show ONLY the board + hamburger menu. */
		body.classic-mode #bottom-bar,
		body.classic-mode #card-choice-zone,
		body.classic-mode #bonus-zone,
		body.classic-mode #scoreboard,
		body.classic-mode #objective-zone,
		body.classic-mode #mobile-objective-banner,
		body.classic-mode #buy-placement-container,
			body.classic-mode #original-coins-zone,
			body.classic-mode #gold-zone,
			body.classic-mode .zone-info-btn,
		body.classic-mode .zone-info-popover {
			display: none;
		}

		/* Classic mode: don't scale down; board should fill the screen. */
		body.classic-mode {
			--board-scale: 1;
		}

		/* Hide the legacy UI column so the board uses the full width. */
		body.classic-mode #board > .column:last-child {
			display: none;
		}

		#original-card-zone {
			width: auto;
			max-width: 100%;
		}

		.board {
			gap: 2px;
			margin: 0;
			margin-top: 10px;
			margin-left: 5px;
			padding: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		/* Bottom bar: make the 3 hand cards visibly smaller (â‰ˆ25%), while keeping cell-size identical to the board. */
		#bottom-bar #card-choice-zone .card-option {
			width: var(--hand-card-width);
			min-height: var(--hand-card-height);
			padding: 3px 4px;
			gap: 2px;
			justify-content: flex-start;
		}
		#bottom-bar #card-choice-zone .card-pattern {
			gap: var(--preview-gap);
		}
		#bottom-bar #card-choice-zone .card-label {
			font-size: 0.52rem;
			padding: 1px 4px;
			gap: 3px;
		}
		#bottom-bar #card-choice-zone .card-meta {
			font-size: 0.6rem;
		}

		/* Red zone sub-grids: center the grid inside each quadrant (also when NOT zoomed). */
		#red-zone.red-group > .zone {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		#red-zone.red-group .grid {
			margin: 0;
		}

		/* Zones compacter maken voor betere fit */
		/* Green grid (lichtgroene binnenste area) beperken (niet tijdens zoom) */
		body:not(.zoomed-in) #green-grid {
			min-width: calc(15 * var(--cell-size));
			max-width: calc(15 * var(--cell-size) + 20px);
		}
		/* Zoomed-in: only the ACTIVE (zoom-focused) green zone may widen */
		body.zoomed-in #green-zone.zoom-focus #green-grid {
			min-width: calc(30 * var(--cell-size));
			max-width: calc(30 * var(--cell-size) + 20px);
		}

		/* Mobile: blue is vertically long by design; keep it scrollable but not a giant strip. */
		body:not(.zoomed-in) #blue-zone,
		#blue-zone--placeholder {
			overflow: auto;
		}

		/* World 2: verberg de (witte) scrollbar in de blauwe zone (blijft wel scrollbaar) */
		#blue-zone {
			scrollbar-width: none;
			-ms-overflow-style: none;
		}
		#blue-zone::-webkit-scrollbar {
			width: 0;
			height: 0;
			display: none;
		}

		/* Blue zone met scroll in zoom voor kaarten zichtbaarheid */
		#blue-zone.zoom-focus {
			max-height: 66vh;
			overflow-y: auto;
			scrollbar-width: none;
			-ms-overflow-style: none;
		}
		#blue-zone.zoom-focus::-webkit-scrollbar {
			width: 0;
			height: 0;
			display: none;
		}
		
	}

	@media (max-width: 600px) {
			:root { --bottom-bar-height: 211px; }
		.board {
			gap: 3px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		/* Green grid (lichtgroene binnenste area) beperken (niet tijdens zoom) */
		body:not(.zoomed-in) #green-grid {
			min-width: calc(15 * var(--cell-size));
			max-width: calc(15 * var(--cell-size) + 20px);
		}
		/* Zoomed-in: only the ACTIVE (zoom-focused) green zone may widen */
		body.zoomed-in #green-zone.zoom-focus #green-grid {
			min-width: calc(30 * var(--cell-size));
			max-width: calc(30 * var(--cell-size) + 20px);
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}

		/* Actieve zone komt BOVEN de blur - behoud aspect ratio */
		.zone.zoom-focus {
		  position: fixed;
		  top: 32%;
		  left: 50%;
		  transform: translate(-50%, -50%) scale(0.95);
		  z-index: var(--z-zoom);
		  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
		  margin: 2px;
		  padding: 3px;
		  border-radius: 6px;
		}

		/* Green zone zoom-focus specifiek */
		#green-zone.zoom-focus {
		  margin: 2px;
		  padding: 3px;
		  border-radius: 6px;
		}

		/* Red zone: behoud originele verhoudingen bij zoom */
		#red-zone.zoom-focus {
		  flex-wrap: wrap;
		  flex-direction: row;
		  width: auto;
		  min-width: 380px;
		  height: auto;
		  max-width: 90vw;
		}
		
	}
	
	@media (max-width: 550px) {
			:root { --bottom-bar-height: 196px; }
		.board {
			gap: 3px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}

		/* Actieve zone komt BOVEN de blur */
		.zone.zoom-focus {
		  position: fixed;
		  top: 35%;
		  left: 50%;
		  transform: translate(-50%, -50%) scale(0.95);
		  z-index: var(--z-zoom);
		  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
		}

		/* Red zone: behoud originele verhoudingen bij zoom */
		#red-zone.zoom-focus {
		  flex-wrap: wrap;
		  flex-direction: row;
		  width: auto;
		  min-width: 380px;
		  height: auto;
		  max-width: 90vw;
		}
	
	}
	  
	@media (max-width: 510px) {
	
		.board {
			gap: 3px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
	
	}

	@media (max-width: 490px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}


		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
		
		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.95);
			max-height: 80vh;
			overflow: hidden;
		}
		#blue-zone.zoom-focus {
			overflow-y: auto;
		}



		.bottom-bar-footer {
			margin-top: 0px;
			padding-top: 0px;
		}
	
	}

	@media (max-width: 450px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
		
		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.95);
			max-height: 80vh;
			overflow: hidden;
		}
		#blue-zone.zoom-focus {
			overflow-y: auto;
		}



		.bottom-bar-footer {
			margin-top: 0px;
			padding-top: 0px;
		}
	
	}

	@media (max-width: 430px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
		
		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.95);
			max-height: 80vh;
			overflow: hidden;
		}
		#blue-zone.zoom-focus {
			overflow-y: auto;
		}


		.bottom-bar-footer {
			margin-top: 0px;
			padding-top: 0px;
		}
	
	}

	@media (max-width: 410px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.93);
		}


	}
	
	@media (max-width: 390px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.60);
		}

	
	}

	/* ============================================
	   ZONE HEADERS
	   ============================================
	   H2 titels die bovenaan elke zone verschijnen (bijv. "Geel vak", "Blauw vak")
	   Dark mode krijgt lichtere grijstint voor betere leesbaarheid
	*/
	h2 { color: #555; margin:0 0 8px; font-size:1rem; text-align:center }
	body.dark-mode h2 { color: #b0b0b0; }

	/* ============================================
	   ZONE KLEUREN & AFMETINGEN
	   ============================================
	   Elk speelvak (zone) krijgt zijn eigen kleur, breedte en hoogte
	   Placeholder varianten zijn voor drag-and-drop preview
	   Dark mode krijgt donkere gradient overlays (zie verderop)
	*/
	#yellow-zone,
	#yellow-zone--placeholder { background:#f0dc7d; height: 450px; min-width: 300px; padding: 14px; }
	/* World 3: yellow zone should not stretch to the (wide) column; match grid/purple width.
	   IMPORTANT: keep zoomed-in view consistent across worlds, so apply only when NOT zoomed. */
	body.world-3:not(.zoomed-in) #yellow-zone,
	body.world-3:not(.zoomed-in) #yellow-zone--placeholder {
		min-width: 0;
		width: fit-content;
		align-self: center;
		padding: 10px;
	}
	/* Yellow (World 2): keep the generated grid visually centered (equal top/bottom spacing). */
	#yellow-zone,
	#yellow-zone--placeholder {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
	}
	#green-zone,
	#green-zone--placeholder { background:#a8d5a2; }
	/* Mobile layout: keep green aligned with red (same outer margin). */
	@media (max-width: 650px) {
		#green-zone,
		#green-zone--placeholder {
			/* Reduce the vertical gap to the red zone, keep L/R equal. */
			margin: 10px;
		}
		#red-zone,
		#red-zone--placeholder {
			/* Reduce the vertical gap to the green zone, keep L/R equal. */
			margin: 10px;
		}

		/* World 1: keep purple grid visually centered (equal margins on all sides). */
		body.world-1 #purple-zone,
		body.world-1 #purple-zone--placeholder {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}
	}
	/* World 2: keep green zone square (same width, more height). */
	body.world-2:not(.zoomed-in) #green-zone,
	body.world-2:not(.zoomed-in) #green-zone--placeholder {
		/* Width is set below; match height to that width. */
		height: calc(13 * var(--cell-size) + 80px);
		max-height: calc(13 * var(--cell-size) + 80px);
		overflow: auto;
	}
	/* Green (World 2 request): hide scrollbar visuals while keeping scroll. */
	#green-zone {
		scrollbar-width: none; /* Firefox */
		-ms-overflow-style: none; /* IE/Edge legacy */
	}
	#green-zone::-webkit-scrollbar {
		width: 0;
		height: 0;
		display: none;
	}
	#green-zone {
		cursor: grab;
	}
	#green-zone.drag-scroll-active {
		cursor: grabbing;
	}
	/* World 1: disable scrolling in green zone */
	#green-zone.no-scroll {
		overflow: hidden;
		cursor: default;
	}
	#green-zone.no-scroll.drag-scroll-active {
		cursor: default;
	}
	body.world-1 #green-zone,
	body.world-1 #green-zone--placeholder {
		overflow: hidden;
	}
	body.world-1 #green-zone #green-grid {
		max-height: none;
	}

	/* Desktop: beperk groene en rode zone breedte */
	@media (min-width: 651px) {
		#green-zone,
		#green-zone--placeholder {
			width: calc(13 * var(--cell-size) + 80px);
			max-width: calc(13 * var(--cell-size) + 80px);
		}
		#green-grid {
			max-width: calc(13 * var(--cell-size) + 40px);
		}
		/* Red zone should match the green zone width (user request). */
		#red-zone,
		#red-zone--placeholder {
			width: calc(13 * var(--cell-size) + 80px);
			max-width: calc(13 * var(--cell-size) + 80px);
			margin: 0;
		}
	}

	#yellow-zone,
	#yellow-zone--placeholder,
	#purple-zone,
	#purple-zone--placeholder {
		overflow: hidden;
	}
	#purple-zone,
	#purple-zone--placeholder { background:#a48dcc; height: 310px;  }
	#blue-zone,
	#blue-zone--placeholder { background:#6ba8d8; height: 760px; }

	/* World 4: keep the 3 visible zones aligned (same height as the blue zone) */
	@media (min-width: 651px) {
		body.world-4:not(.zoomed-in) #yellow-zone,
		body.world-4:not(.zoomed-in) #green-zone {
			height: 760px;
			max-height: 760px;
			overflow: auto;
		}

		/* World 4: force the 3 active zones to be true side-by-side columns */
		body.world-4:not(.zoomed-in) #board.board {
			display: grid;
			grid-template-columns: repeat(3, minmax(0, 1fr)) minmax(280px, 360px);
			align-items: start;
			gap: 12px;
		}
		body.world-4:not(.zoomed-in) #board.board > .column:nth-child(1),
		body.world-4:not(.zoomed-in) #board.board > .column:nth-child(2),
		body.world-4:not(.zoomed-in) #board.board > .column:nth-child(3) {
			display: contents;
		}
		body.world-4:not(.zoomed-in) #board.board > .column:nth-child(4) {
			grid-column: 4;
			grid-row: 2;
			align-self: start;
		}
		body.world-4:not(.zoomed-in) #yellow-zone { grid-column: 1; grid-row: 1; }
		body.world-4:not(.zoomed-in) #green-zone { grid-column: 2; grid-row: 1; }
		body.world-4:not(.zoomed-in) #blue-zone { grid-column: 3; grid-row: 1; }
		body.world-4:not(.zoomed-in) #purple-zone { grid-column: 1; grid-row: 2; }
		body.world-4:not(.zoomed-in) #red-zone { grid-column: 2; grid-row: 2; }
		body.world-4:not(.zoomed-in) #original-card-zone { grid-column: 4; grid-row: 1; }
	}

	/* World 4: keys/doors should visually match the active zone they are placed in */
	.cell.key-cell[data-w4-ink="geel"],
	.cell.door-cell[data-w4-ink="geel"] { color: rgba(170, 135, 20, 0.95); }
	.cell.key-cell[data-w4-ink="groen"],
	.cell.door-cell[data-w4-ink="groen"] { color: rgba(40, 140, 70, 0.95); }
	.cell.key-cell[data-w4-ink="blauw"],
	.cell.door-cell[data-w4-ink="blauw"] { color: rgba(60, 130, 210, 0.95); }
	.cell.key-cell[data-w4-ink="paars"],
	.cell.door-cell[data-w4-ink="paars"] { color: rgba(150, 110, 220, 0.95); }
	.cell.key-cell[data-w4-ink="rood"],
	.cell.door-cell[data-w4-ink="rood"] { color: rgba(220, 95, 95, 0.95); }

	/* Blue zone: vaste breedte, breder grid wordt scrollbaar */
	#blue-zone {
		width: 180px;
		max-width: 300px;
		min-width: 180px;
	}

	/* Blue (World 2): keep scroll but hide the (white) scrollbar visuals on desktop too. */
	#blue-zone {
		overflow-y: auto;
		overflow-x: auto;
		scrollbar-width: none; /* Firefox */
		-ms-overflow-style: none; /* IE/Edge legacy */
	}
	#blue-zone::-webkit-scrollbar {
		width: 0;
		height: 0;
		display: none;
	}
	#blue-zone #blue-grid {
		scrollbar-width: none;
		-ms-overflow-style: none;
	}
	#blue-zone #blue-grid::-webkit-scrollbar {
		width: 0;
		height: 0;
		display: none;
	}
	#gold-zone,
	#gold-zone--placeholder { background:#fffbea; height: 100px; width: 280px; box-shadow: 0 0 8px rgba(0,0,0,0.4); }
	#red-zone,
	#red-zone--placeholder { background:#de838c; height: auto; margin: 10px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.12);
	  box-sizing: border-box; padding: 10px; touch-action: manipulation; overflow: visible; position: relative; }
	#red-zone.red-group {
		display: grid;
		grid-template-columns: repeat(2, max-content);
		justify-content: center;
		gap: 18px;
	}
	/* World 3: lock overlay for the red-stage transition (does not participate in grid layout). */
	#world3-red-lock {
		position: absolute;
		inset: 0;
		display: none;
		align-items: center;
		justify-content: center;
		pointer-events: none;
		z-index: 20;
		color: rgba(0, 0, 0, 0.48);
		opacity: 0.85;
	}
	body.dark-mode #world3-red-lock {
		color: rgba(255, 255, 255, 0.38);
	}
	#world3-red-lock svg {
		width: 44px;
		height: 44px;
		display: block;
	}
	#red-zone.red-group > .zone {
		margin: 0;
	}
	/* Red subgrid points label (shows how many points a full subgrid yields). */
	#red-zone .red-grid-points-label {
		position: absolute;
		top: 4px;
		left: 4px;
		z-index: 25;
		pointer-events: none;
		font-size: 0.72rem;
		font-weight: 700;
		padding: 2px 7px;
		border-radius: 12px;
		background: #ffd6d1;
		border: 1px solid #ff7b73;
		color: #4b0000;
		line-height: 1;
	}
	  
	#red-grid1,
	#red-grid1--placeholder { background:#de838c; margin: 10px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid2,
	#red-grid2--placeholder { background:#de838c; margin: 10px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid3,
	#red-grid3--placeholder { background:#de838c; margin: 10px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid4,
	#red-grid4--placeholder { background:#de838c; margin: 10px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid5,
	#red-grid5--placeholder { background:#de838c; margin: 10px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid6,
	#red-grid6--placeholder { background:#de838c; margin: 10px; border-radius: 0; border:0; box-shadow: none; }
	@media (min-width: 651px) {
		#red-zone.red-group #red-grid1,
		#red-zone.red-group #red-grid2,
		#red-zone.red-group #red-grid3,
		#red-zone.red-group #red-grid4,
		#red-zone.red-group #red-grid5,
		#red-zone.red-group #red-grid6 {
			margin: 0;
		}
	}
	/* When red-zone is zoomed, remove subgrid margins so the container doesn't overflow. */
	body.zoomed-in #red-zone.zoom-focus #red-grid1,
	body.zoomed-in #red-zone.zoom-focus #red-grid2,
	body.zoomed-in #red-zone.zoom-focus #red-grid3,
	body.zoomed-in #red-zone.zoom-focus #red-grid4,
	body.zoomed-in #red-zone.zoom-focus #red-grid5,
	body.zoomed-in #red-zone.zoom-focus #red-grid6 {
		margin: 0;
	}

	/* DARK MODE: Override zone kleuren met donkere gradient */

	body.dark-mode #gold-zone--placeholder { 
		background: linear-gradient(145deg, #2d2920, #232119);
		border: 1px solid #3d3930;
	}
	

	/* ============================================
	   CEL KLEUREN PER ZONE
	   ============================================
	   Elke zone heeft cellen met hun eigen kleur schema
	   .cell = standaard (niet ingevuld)
	   .cell.active = ingevuld/actief (donkerder kleur)
	   .end-cell = speciale eindcel in groen vak
	*/
	#yellow-zone .cell,
	#yellow-zone--placeholder .cell { background: #fff3b0; color: #3e2f00; border-color: #fffba8; }
	#red-zone .cell,
	#red-zone--placeholder .cell { background: #ffd6d1; color: #4b0000; border-color: #ff7b73; }
	#purple-zone .cell,
	#purple-zone--placeholder .cell { background: #f3e8fa; border-color: #e6a8ff; }
	#green-zone .cell,
	#green-zone--placeholder .cell { background: #d6f5d6; color: #003300; border-color: #c1ffa8; } 
	#green-zone .cell.end-cell,
	#green-zone--placeholder .cell.end-cell {background-color: #7bba7b; border-color: #7bb57f; } 
	#blue-zone .cell,
	#blue-zone--placeholder .cell { background: #d6eaff; color: #001f3f; border-color: #a8d8ff; }
	#yellow-zone .cell.active,
	#yellow-zone--placeholder .cell.active { background: #cfba51; border-color: #f7dc54; } 
	/* Yellow: highlight completed lines/segments/rings a bit darker (all worlds). */
	#yellow-zone .cell.active.yellow-completed-path,
	#yellow-zone--placeholder .cell.active.yellow-completed-path {
		filter: brightness(0.86);
	}
	#red-zone .cell.active,
	#red-zone--placeholder .cell.active { background: #b56069; border-color: #ff7b73; }
	#purple-zone .cell.active,
	#purple-zone--placeholder .cell.active { background: #8f76b8; color: #33004b; border-color: #e6a8ff; }
	#green-zone .cell.active,
	#green-zone--placeholder .cell.active { background: #92c28c; border-color: #c1ffa8; }
	#green-zone .cell.end-cell.active,
	#green-zone--placeholder .cell.end-cell.active {background-color: #5da35d !important; border-color: #518755 !important; } 
#yellow-zone .cell.end-cell.active,
#yellow-zone--placeholder .cell.end-cell.active { background-color: #cfae4a; border-color: #b8963c; }
#purple-zone .cell.end-cell.active,
#purple-zone--placeholder .cell.end-cell.active { background-color: #7a5aa8; border-color: #62478a; }
#blue-zone .cell.end-cell.active,
#blue-zone--placeholder .cell.end-cell.active { background-color: #3b7aa4; border-color: #2f6386; }

	/* Bold start cells should keep the normal active background but have a thicker/darker border */
	#green-zone .cell.bold-cell.active,
	#green-zone--placeholder .cell.bold-cell.active {
		background-color: #92c28c; /* match normal green active */
		border-color: #2b572b;
	}

	/* Start cell in green should not use the dark end-cell active color */
	#green-zone .cell.start-cell.active,
	#green-zone--placeholder .cell.start-cell.active { background-color: #92c28c; border-color: #c1ffa8; }
	#blue-zone .cell.active,
	#blue-zone--placeholder .cell.active { background: #5689b0; border-color: #a8d8ff; }

	/* ============================================
	   COIN SYMBOL STYLING
	   ============================================
	   Gebruik Segoe UI Symbol / Apple Color Emoji voor coin emoji
	   zodat het correct wordt weergegeven in alle browsers
	*/
	.coin-symbol {
		font-family: "Segoe UI Symbol", "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", Arial, sans-serif;
	}
	
	/* Algemene emoji ondersteuning voor toast berichten, feedback, etc. */
	.toast-message,
	.blackhole-feedback,
	.blackhole-subtext,
	.objective-toast,
	.modal-score-summary,
	.round-summary-icon,
	.card-label,
	[class*="feedback"],
	[class*="toast"] {
		font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif, "Segoe UI Symbol", "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji";
	}
	
	/* ============================================
	   GRID LAYOUT BASIS
	   ============================================
	   Basisstijl voor alle grid containers binnen zones
	   Gebruikt CSS Grid voor automatische cel positionering
	*/
	.grid { display: grid; gap: var(--board-grid-gap, 2px); justify-content: center; margin: 20px; }
	/* Yellow (World 2): remove inner grid margin so spacing stays even and not clipped. */
	#yellow-zone #yellow-grid.grid,
	#yellow-zone--placeholder #yellow-grid.grid {
		margin: 0;
	}
	/* Purple: match Yellow centering (no inner grid margin). */
	#purple-zone #purple-grid.grid,
	#purple-zone--placeholder #purple-grid.grid {
		margin-left: 0;
		margin-right: 0;
	}
	/* Purple: World 1 keeps vertical breathing room; Worlds 2/3 remove it. */
	body.world-1 #purple-zone #purple-grid.grid,
	body.world-1 #purple-zone--placeholder #purple-grid.grid {
		margin-top: 20px;
		margin-bottom: 20px;
	}
	body.world-2:not(.zoomed-in) #purple-zone #purple-grid.grid,
	body.world-2:not(.zoomed-in) #purple-zone--placeholder #purple-grid.grid,
	body.world-3:not(.zoomed-in) #purple-zone #purple-grid.grid,
	body.world-3:not(.zoomed-in) #purple-zone--placeholder #purple-grid.grid {
		margin-top: 0;
		margin-bottom: 0;
	}
	/* Green: remove inner margin so the darker outer rim disappears. */
	#green-zone #green-grid {
		margin: 0;
		background: transparent;
	}
	
	/* ============================================
	   CEL STIJLEN - BASIS
	   ============================================
	   De individuele cellen in elk speelvak
	   .edge-cell = rode gloed voor rand-cellen (in rood vak)
	   .bold-cell = dikke zwarte rand
	   .end-cell = groene eindcel
	   .active = ingevuld met animatie
	   .gold-cell = heeft gouden muntje symbool
	*/
	.cell.edge-cell {
	  border: 2px solid rgba(255,80,80,0.95);
	  box-shadow: 0 0 10px 3px rgba(255,80,80,0.45);
	  z-index: 6; /* op de root-cellen liggen */
	  transition: box-shadow 0.18s ease, border 0.18s ease;
	}
	.cell{
	  width: var(--cell-size);
	  height: var(--cell-size);
	  background: #f9fafc;      
	  color: #222;
	  border: 1px solid #d8dee9;
	  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
	  border-radius: calc(var(--cell-size) / 4);
	  position:relative;
	  user-select:none;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  transition: background 0.25s, transform 0.15s;
	  animation: growRoot 0.3s forwards;
	}

	/* Green root cells are absolutely positioned; shrink + center them to create visible spacing. */
	#green-grid .root-cell:not(.void-cell) {
		width: calc(var(--cell-size) - 2px);
		height: calc(var(--cell-size) - 2px);
		transform: translate(1px, 1px);
	}



	/* WORLD 2 (Yellow): Alternate diagonal shading so players see the diagonal-row rule.
	   Keep it subtle and do NOT affect active/void cells. */
	#yellow-grid .cell.diag-shade-odd:not(.void-cell):not(.active) {
	  filter: brightness(0.985);
	}
	body.dark-mode #yellow-grid .cell.diag-shade-odd:not(.void-cell):not(.active) {
	  filter: brightness(1.06);
	}

	/* WORLD 3 (Yellow): alternate shading per ring (dark-light-dark) to match ring scoring. */
	body.world-3 #yellow-grid .cell.ring-shade-odd:not(.void-cell):not(.active) {
	  filter: brightness(1.02);
	}
	body.world-3 #yellow-grid .cell.ring-shade-even:not(.void-cell):not(.active) {
	  filter: brightness(0.965);
	}

	/* WORLD 1 (Yellow): alternate shading per column to match column scoring. */
	body.world-1 #yellow-grid .cell.col-shade-odd:not(.void-cell):not(.active) {
	  filter: brightness(0.97);
	}
	body.world-1 #yellow-grid .cell.col-shade-even:not(.void-cell):not(.active) {
	  filter: brightness(1.02);
	}

	/* WORLD 2 (Purple): Buitenste 2 ringen met subtiel andere achtergrondkleur */
	#purple-grid .cell.outer-ring-0:not(.void-cell):not(.active) {
	  /* Buitenste ring: iets lichter (subtiel) */
	  background: #efe8f7;
	  filter: brightness(1.00);
	}
	#purple-grid .cell.outer-ring-1:not(.void-cell):not(.active) {
	  /* Tweede ring: nog iets lichter */
	  background: #f3eefb;
	  filter: brightness(1.00);
	}
	body.dark-mode #purple-grid .cell.outer-ring-0:not(.void-cell):not(.active) {
	  background: #d3c3ea;
	  filter: brightness(0.97);
	}
	body.dark-mode #purple-grid .cell.outer-ring-1:not(.void-cell):not(.active) {
	  background: #d9ccec;
	  filter: brightness(0.97);
	}

	/* Ensure golden card frame shows in the bottom-bar hand (more specific than the hand card background rules). */
	#bottom-bar #card-choice-zone .card-option.card-golden {
		border: 2px solid rgba(220,180,60,0.92);
		box-shadow:
			0 18px 26px rgba(10,12,20,0.2),
			0 0 0 2px rgba(220,180,60,0.50) inset,
			0 0 18px rgba(184,120,18,0.28);
	}
	body.dark-mode #bottom-bar #card-choice-zone .card-option.card-golden {
		border: 2px solid rgba(200,160,30,0.78);
		box-shadow:
			0 26px 44px rgba(0,0,0,0.55),
			0 0 0 2px rgba(200,160,30,0.32) inset,
			0 0 18px rgba(227,196,94,0.22);
	}
	.cell.void-cell {
	  visibility: hidden;
	  pointer-events: none;
	  border: none;
	  background: transparent;
	  box-shadow: none;
	  animation: none;
	}
	.cell:hover { background: #eef3ff; }
	.cell.active { background: #cde3ff; border-color: #a8c9ff; color: #000; transform: scale(1.1); box-shadow: 0 0 8px rgba(58,111,247,0.25); }
	.cell.bold-cell { border: 2px solid #2c3333 !important; }
	.cell.end-cell{ background:#a7d6aa; border-color:#a7d6aa }
	.cell.end-cell.active{ background:#81b884 }
	.cell.trap-cell { position: relative; }
	.cell.trap-triggered {
	  box-shadow: 0 0 12px rgba(196,56,56,0.55), inset 0 0 10px rgba(196,56,56,0.45);
	  animation: trapPulse 0.5s ease;
	}

	@keyframes trapPulse {
	  0% { transform: scale(1); }
	  50% { transform: scale(1.05); }
	  100% { transform: scale(1); }
	}
	
	/* ============================================
	   SYMBOLEN IN CELLEN
	   ============================================
	   Gekleurde vierkantjes die in cellen kunnen verschijnen
	   Tonen welke kleur/zone de cel vertegenwoordigt
	*/
	.symbol { display: inline-block; width: calc(var(--cell-size) * 0.52); height: calc(var(--cell-size) * 0.52); border-radius: calc(var(--cell-size) * 0.12); margin: auto; border: calc(var(--cell-size) * 0.08) solid #444; background-color: #999; box-sizing: border-box; }
	.symbol.yellow { background-color: #fff48f; }
	.symbol.green  { background-color: #69cf57; }
	.symbol.purple { background-color: #ae7eed; }
	.symbol.blue   { background-color: #76a0e3; }
	.symbol.red    { background-color: #ed7e89; }
		.symbol.trap-symbol {
			width: calc(var(--cell-size) * 0.65);
			height: calc(var(--cell-size) * 0.65);
			border-radius: calc(var(--cell-size) * 0.06);
			background: #656565;
			border: none;
			transform: rotate(45deg) scale(0.75);
			pointer-events: none;
			position: relative;
			overflow: hidden;
			box-sizing: border-box;
		}

	.symbol.trap-symbol::after {
	  content: "";
	  position: absolute;
	  inset: 4px;
	  border-radius: 1px;
	  background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 50%);
	  opacity: 0.8;
	}

	.symbol.trap-symbol.trap-symbol--pit::after {
	  opacity: 0.6;
	}

	.symbol.trap-symbol.trap-symbol--black-hole {
	  background: radial-gradient(circle, #1a1a2e 0%, #0a0a15 60%, #000000 100%);
	  border-radius: 50%;
	  box-shadow: 
		0 0 15px rgba(138, 43, 226, 0.6),
		0 0 25px rgba(75, 0, 130, 0.4),
		inset 0 0 20px rgba(138, 43, 226, 0.3);
	  border: 2px solid rgba(138, 43, 226, 0.4);
	}

	.symbol.trap-symbol.trap-symbol--black-hole::after {
	  background: radial-gradient(circle, rgba(138, 43, 226, 0.2) 0%, transparent 70%);
	  opacity: 1;
	  border-radius: 50%;
	  animation: black-hole-pulse 2s ease-in-out infinite;
	}

	/* Mega Bonus Symbol - grotere bonus met shimmer effect */
		.symbol.mega-bonus-symbol {
			width: 120%;
			height: 120%;
			border-radius: calc(var(--cell-size) * 0.15);
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: calc(var(--cell-size) * 0.8);
			font-weight: bold;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			transition: transform 0.2s ease;
			z-index: 15;
	  /* Gradient glim effect over bonus color */
	  background: linear-gradient(135deg, 
		rgba(255, 255, 255, 0.4) 0%, 
		transparent 40%, 
		transparent 60%, 
		rgba(255, 255, 255, 0.4) 100%);
	  background-size: 200% 200%;
	  animation: mega-bonus-glim 2.5s ease-in-out infinite;
	  box-shadow: 0 0 15px rgba(255, 255, 255, 0.5), 
				  inset 0 0 20px rgba(255, 255, 255, 0.3);
	}

	.symbol.mega-bonus-symbol:hover {
	  transform: translate(-50%, -50%) scale(1.15);
	}

	/* Upgrade Shop Symbol - shop icoon met gouden gloed */
		.symbol.upgrade-shop-symbol {
			width: 100%;
			height: 100%;
			border-radius: calc(var(--cell-size) * 0.15);
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: calc(var(--cell-size) * 0.8);
			font-weight: bold;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			transition: transform 0.2s ease;
			z-index: 15;
		/* Diamond-like cool gradient to distinguish from traps */
		background: linear-gradient(135deg, #e6fbff 0%, #bfefff 40%, #9ad8ff 100%);
		color: #0b3b4a;
		box-shadow: 0 0 8px rgba(60,160,200,0.25), inset 0 0 6px rgba(255,255,255,0.6);
	}

/* Diamond glyph styling for inline text (toasts, titles) */
.diamond-glyph { color: #0b3b4a; font-weight: 700; text-shadow: 0 1px 0 rgba(255,255,255,0.25); }
body.dark-mode .diamond-glyph { color: #bfefff; }

	.symbol.upgrade-shop-symbol:hover {
	  transform: translate(-50%, -50%) scale(1.15);
	}

	@keyframes upgrade-shop-glim {
	  0%, 100% { 
		background-position: 0% 50%;
	  }
	  50% { 
		background-position: 100% 50%;
	  }
	}

	@keyframes mega-bonus-glim {
	  0%, 100% { 
		background-position: 0% 50%;
	  }
	  50% { 
		background-position: 100% 50%;
	  }
	}

	@keyframes black-hole-pulse {
		0%, 100% {
			transform: scale(1);
			opacity: 0.8;
		}
		50% {
			transform: scale(1.1);
			opacity: 1;
		}
	}
	
	/* Portal cel styling */
	.portal-cell {
		animation: portal-pulse 2s ease-in-out infinite;
		z-index: 10;
	}

	.portal-symbol {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		font-size: calc(var(--cell-size) * 0.9);
		z-index: 100;
		pointer-events: none;
		filter: drop-shadow(0 0 10px rgba(100, 150, 255, 1));
		animation: portal-rotate 3s linear infinite;
		text-shadow: 0 0 15px rgba(100, 150, 255, 0.8);
	}

	@keyframes portal-pulse {
		0%, 100% {
			box-shadow: 0 0 15px rgba(100, 150, 255, 0.8), inset 0 0 15px rgba(100, 150, 255, 0.5);
		}
		50% {
			box-shadow: 0 0 30px rgba(100, 150, 255, 1), inset 0 0 20px rgba(100, 150, 255, 0.7);
		}
	}

	@keyframes portal-rotate {
		0% { transform: translate(-50%, -50%) rotate(0deg); }
		100% { transform: translate(-50%, -50%) rotate(360deg); }
	}
	
	/* Gouden muntje binnen een cel (gebruikt ::after pseudo-element) */
	.gold-cell::after { content: ""; position: absolute; top: 4px; left: 4px; width: 12px; height: 12px; border-radius: 50%; background: #ffea63; border: 2px solid #171615; z-index: 1; }
	.cell.active.gold-cell::after{ background:#edcd21 }
	
	/* ============================================
	   MUNTEN VERZAMELING (GOUDEN VAK)
	   ============================================
	   Container voor de 20 muntjes in het gouden vak
	   Toont hoeveel munten je hebt verzameld/gebruikt
	*/
	#collected-coins{ display:flex; gap:6px; flex-wrap:wrap; justify-content:center; margin-top:5px;  }
	
	/* ============================================
	   INDIVIDUELE MUNTEN
	   ============================================
	   Elk muntje heeft 3 states:
	   - standaard (grijs, niet verzameld)
	   - .active (goudkleurig, verzameld maar niet gebruikt)
	   - .used (donkergrijs, al uitgegeven in shop)
	*/
	.coin {
		width: 18px;
		height: 18px;
		border-radius: 50%;
		background: rgba(255,255,255,0.18);
		border: 1px solid rgba(255,255,255,0.28);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.25), 0 0 6px rgba(0,0,0,0.25);
		transition: transform 0.2s ease, background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
	}

	.coin.active {
		background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 70%);
		border-color: #f3b12b;
		box-shadow: 0 0 8px rgba(255,209,90,0.78), inset 0 0 2px rgba(255,255,255,0.85);
	}

	.coin.used {
		background: rgba(80,82,95,0.65);
		border-color: rgba(120,124,140,0.6);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.4);
		transform: scale(1);
	}

	body.dark-mode .coin {
		background: rgba(255,255,255,0.14);
		border-color: rgba(255,255,255,0.24);
	}

	body.dark-mode .coin.active {
		background: radial-gradient(circle at 30% 30%, #ffe58c, #f5b72f 70%);
	}

	body.dark-mode .coin.used {
		background: rgba(60,60,72,0.7);
		border-color: rgba(110,110,130,0.55);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.55);
	}

	/* ============================================
	   +1 BLOKPLAATSING KNOP
	   ============================================ */
	.buy-placement-btn {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 6px;
		margin-top: 10px;
		padding: 8px 14px;
		border: 1px solid rgba(26,32,48,0.16);
		border-radius: 8px;
		background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
		color: #2b3148;
		font-weight: 600;
		font-size: 0.9rem;
		cursor: pointer;
		transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
		box-shadow: 0 12px 20px rgba(10,12,20,0.22);
	}
	.buy-placement-btn:hover:not(:disabled) {
		transform: translateY(-2px);
		box-shadow: 0 18px 28px rgba(10,12,20,0.28);
		background: linear-gradient(155deg, #f4f7ff 0%, #e2e8fb 100%);
	}
	.buy-placement-btn:active:not(:disabled) {
		transform: translateY(0);
		box-shadow: 0 10px 18px rgba(10,12,20,0.22);
	}
	.buy-placement-btn:disabled {
		opacity: 0.5;
		cursor: not-allowed;
		background: linear-gradient(135deg, #e0e0e0, #bdbdbd);
		border-color: rgba(26,32,48,0.16);
		color: #757575;
	}
	.buy-placement-arrow {
		font-size: 1.05rem;
		line-height: 1;
		opacity: 0.9;
		transform: translateY(-0.5px);
	}
	/* Hide the arrow on touch devices */
	@media (pointer: coarse) {
		.buy-placement-arrow {
			display: none;
		}
	}
	.buy-placement-rainbow-cell {
		width: 18px;
		height: 18px;
		/* Border-radius: max 5px, minder rond */
		border-radius: min(5px, calc(18px / 5));
		display: inline-block;
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.22), 0 2px 6px rgba(0,0,0,0.22);
		background: linear-gradient(
			135deg,
			#ff5757 0%,
			#ffbf3a 22%,
			#8cff6a 45%,
			#47b1ff 70%,
			#b16cff 100%
		);
	}
	.buy-placement-cost {
		display: flex;
		gap: 3px;
		background: rgba(0,0,0,0.1);
		padding: 2px 6px;
		border-radius: 4px;
		font-size: 0.8rem;
	}
	.buy-placement-cost .coin-icon {
		display: inline-block;
		width: 0.9em;
		height: 0.9em;
		border-radius: 50%;
		background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 60%, #d49f20);
		box-shadow: inset 0 -1px 2px rgba(0,0,0,0.2);
		border: 1px solid #c9960a;
	}
	body.dark-mode .buy-placement-btn {
		background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
		border-color: rgba(140,150,200,0.3);
		color: rgba(235,238,255,0.88);
		box-shadow: 0 16px 30px rgba(0,0,0,0.42);
	}
	body.dark-mode .buy-placement-btn:hover:not(:disabled) {
		background: linear-gradient(160deg, #333a52 0%, #252a3b 100%);
		box-shadow: 0 20px 34px rgba(0,0,0,0.5);
	}
	body.dark-mode .buy-placement-btn:disabled {
		background: linear-gradient(135deg, #3a3a3a, #2a2a2a);
		border-color: rgba(140,150,200,0.2);
		color: #888;
		transform: scale(1);
	}
	body.dark-mode .buy-placement-rainbow-cell {
		box-shadow: inset 0 0 0 1px rgba(255,255,255,0.12), 0 2px 8px rgba(0,0,0,0.55);
	}

	/* Gekocht blok preview in gold zone */
	#buy-placement-container {
		display: flex;
		justify-content: center;
		margin-top: 10px;
	}
	.purchased-block-preview {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 6px;
		padding: 10px 16px;
		background: linear-gradient(135deg, rgba(240,98,114,0.15), rgba(255,245,90,0.15), rgba(78,211,70,0.15), rgba(93,144,240,0.15));
		border: 2px dashed rgba(150,100,200,0.5);
		border-radius: 10px;
		cursor: grab;
		transition: transform 0.15s ease, box-shadow 0.15s ease;
		animation: pulse-glow 1.5s ease-in-out infinite;
	}
	.purchased-block-preview:hover {
		transform: scale(1.05);
		box-shadow: 0 4px 16px rgba(150,100,200,0.3);
	}
	.purchased-block-preview:active {
		cursor: grabbing;
	}
	.purchased-block-cell {
		width: 28px;
		height: 28px;
		border-radius: 4px;
		background: linear-gradient(45deg, #f06272, #fff25a, #4ed346, #5d90f0, #a35eff);
		border: 2px solid rgba(255,255,255,0.5);
		box-shadow: 0 2px 8px rgba(0,0,0,0.2);
	}
	.purchased-block-label {
		font-size: 0.75rem;
		font-weight: 600;
		color: #6b4d8a;
	}
	@media (max-width: 650px) {
		.purchased-block-label {
			display: none;
		}
		.purchased-block-preview {
			gap: 4px;
			padding: 8px 12px;
		}
	}
	body.dark-mode .purchased-block-preview {
		background: linear-gradient(135deg, rgba(240,98,114,0.1), rgba(255,245,90,0.1), rgba(78,211,70,0.1), rgba(93,144,240,0.1));
		border-color: rgba(180,140,220,0.4);
	}
	body.dark-mode .purchased-block-label {
		color: #c9b0e8;
	}
	/* Keep the purchased preview visible everywhere; it's the drag handle to place the bought block. */
	@keyframes pulse-glow {
		0%, 100% { box-shadow: 0 0 8px rgba(150,100,200,0.2); }
		50% { box-shadow: 0 0 16px rgba(150,100,200,0.4); }
	}
	
	/* ============================================
	   SCOREBORD
	   ============================================
	   Toont score per kleur + totaal
	   Gepositioneerd in kolom 4 op desktop, in bottom-bar op mobiel
	   Score-rows gebruiken kleur-dots voor compactheid
	*/
	#scoreboard {
	  background: #fffbea;
	  border-radius: 12px;
	  padding: 16px 20px;
	  color: #333;
	  font-family: "Segoe UI", sans-serif;
	  width: 280px;
	  position: relative;
	  z-index: 1;
	  box-shadow: 0 0 8px rgba(0,0,0,0.4);
	  display: flex;
	  flex-direction: column;
	  align-items: stretch;
	  gap: 12px;
	}

	#scoreboard h2 {
	  margin: 0;
	}

	body.dark-mode #scoreboard {
	  background: linear-gradient(145deg, #2d2920, #232119);
	  border: 1px solid #3d3930;
	  color: #e0e0e0;
	}

	.score-row { 
	  display: flex; 
	  align-items: center; 
	  justify-content: space-between; 
	  background: #eee; 
	  padding: 6px 10px; 
	  border-radius: 8px; 
	  margin: 0;
	  position: relative;
	  transition: transform 0.1s ease, background 0.3s, box-shadow 0.3s; 
	}

	/* Zone-info knopjes (links boven in elke zone) */
	.zone-info-btn {
		position: absolute;
		left: 8px;
		top: 8px;
		z-index: 20;
		width: 20px;
		height: 20px;
		border-radius: 999px;
		border: 1px solid rgba(0,0,0,0.18);
		background: rgba(255,255,255,0.7);
		color: rgba(0,0,0,0.75);
		font-weight: 800;
		font-size: 12px;
		line-height: 1;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		padding: 0;
		-webkit-user-select: none;
		user-select: none;
	}

	/* When a zone is scrollable, pin the info UI to the zone viewport. */
	#blue-zone .zone-info-btn,
	#green-zone .zone-info-btn {
		position: sticky;
		top: 8px;
		left: 8px;
		margin: 0 0 -20px 0;
	}
	#blue-zone .zone-info-popover,
	#green-zone .zone-info-popover {
		position: sticky;
		top: 34px;
		left: 8px;
		margin: 0 0 -140px 0;
		height: 140px;
		max-height: 140px;
		overflow: auto;
	}
	#blue-zone,
	#green-zone {
		/* Prevent horizontal layout jumps when scrollbars appear/disappear */
		scrollbar-gutter: stable;
	}

	body.dark-mode .zone-info-btn {
		border-color: rgba(255,255,255,0.18);
		background: rgba(0,0,0,0.2);
		color: rgba(255,255,255,0.82);
	}

	.zone-info-btn:focus {
		outline: 2px solid rgba(0,0,0,0.25);
		outline-offset: 2px;
	}

	body.dark-mode .zone-info-btn:focus {
		outline-color: rgba(255,255,255,0.22);
	}

	.zone-info-popover {
		position: absolute;
		left: 8px;
		right: 8px;
		top: 34px;
		z-index: 30;
		display: block;
		opacity: 0;
		visibility: hidden;
		pointer-events: none;
		transition: opacity 120ms ease;
		padding: 10px 12px;
		border-radius: 10px;
		background: rgba(255,255,255,0.95);
		border: 1px solid rgba(0,0,0,0.14);
		box-shadow: 0 8px 20px rgba(0,0,0,0.18);
		font-size: 0.82rem;
		line-height: 1.25;
		color: rgba(0,0,0,0.78);
		-webkit-backdrop-filter: blur(6px);
		backdrop-filter: blur(6px);
	}

	body.dark-mode .zone-info-popover {
		background: rgba(35, 33, 25, 0.96);
		border-color: rgba(255,255,255,0.12);
		box-shadow: 0 10px 22px rgba(0,0,0,0.55);
		color: rgba(255,255,255,0.85);
	}

	.zone[data-info-open="true"] .zone-info-popover {
		opacity: 1;
		visibility: visible;
		pointer-events: auto;
	}
	
	body.dark-mode .score-row {
	  background: #383838;
	  color: #e0e0e0;
	}

	.score-row:hover { transform: scale(1.03); background: #383838; }
	
	/* Score highlighting voor behaalde doelstellingen */
	.score-row.objective-achieved {
	  box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.6);
	  animation: objective-pulse 2s ease-in-out infinite;
	}
	
	body.dark-mode .score-row.objective-achieved {
	  box-shadow: 0 0 12px 2px rgba(255, 215, 0, 0.7);
	  animation: objective-pulse-dark 2s ease-in-out infinite;
	}
	
	@keyframes objective-pulse {
	  0%, 100% { box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.6); }
	  50% { box-shadow: 0 0 15px 3px rgba(255, 215, 0, 0.8); }
	}
	
	@keyframes objective-pulse-dark {
	  0%, 100% { box-shadow: 0 0 12px 2px rgba(255, 215, 0, 0.7); }
	  50% { box-shadow: 0 0 18px 4px rgba(255, 215, 0, 0.9); }
	}

	/* Tutorial overlay + highlights */
	#tutorial-overlay {
	  position: fixed;
	  inset: 0;
	  background: rgba(0, 0, 0, 0.55);
	  display: none;
	  align-items: center;
	  justify-content: center;
	  z-index: 9999;
	  backdrop-filter: blur(2px);
	}
	#tutorial-overlay .tutorial-card {
	  background: #111827;
	  color: #f8fafc;
	  padding: 20px 22px;
	  border-radius: 12px;
	  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.45);
	  max-width: 420px;
	  width: calc(100% - 32px);
	  text-align: center;
	  border: 1px solid rgba(255, 255, 255, 0.08);
	}
	#tutorial-overlay .tutorial-card h3 { margin: 0 0 8px 0; font-size: 1.1rem; }
	#tutorial-overlay .tutorial-card p { margin: 0 0 14px 0; opacity: 0.9; }
	#tutorial-overlay .tutorial-card button {
	  background: linear-gradient(135deg, #fbbf24, #f97316);
	  border: none;
	  color: #0f172a;
	  padding: 10px 18px;
	  border-radius: 10px;
	  font-weight: 700;
	  cursor: pointer;
	  box-shadow: 0 10px 30px rgba(249, 115, 22, 0.35);
	}
	.tutorial-glow {
	  position: relative;
	  animation: tutorial-pulse 1.6s ease-in-out infinite;
	  box-shadow: 0 0 0 2px rgba(251, 191, 36, 0.7), 0 0 16px rgba(249, 115, 22, 0.9);
	  z-index: 9998;
	}
	.tutorial-glow-soft {
	  position: relative;
	  animation: tutorial-pulse-soft 1.8s ease-in-out infinite;
	  box-shadow: 0 0 0 2px rgba(125, 211, 252, 0.55), 0 0 14px rgba(59, 130, 246, 0.7);
	  z-index: 9998;
	}
	@keyframes tutorial-pulse {
	  0% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7), 0 0 16px rgba(249, 115, 22, 0.9); }
	  50% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0.0), 0 0 22px rgba(249, 115, 22, 0.4); }
	  100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7), 0 0 16px rgba(249, 115, 22, 0.9); }
	}
	@keyframes tutorial-pulse-soft {
	  0% { box-shadow: 0 0 0 0 rgba(125, 211, 252, 0.6), 0 0 14px rgba(59, 130, 246, 0.8); }
	  50% { box-shadow: 0 0 0 10px rgba(125, 211, 252, 0.0), 0 0 18px rgba(59, 130, 246, 0.4); }
	  100% { box-shadow: 0 0 0 0 rgba(125, 211, 252, 0.6), 0 0 14px rgba(59, 130, 246, 0.8); }
	}
	#tutorial-ghost {
	  position: fixed;
	  width: 64px;
	  left: 0%;
	  height: 64px;
	  pointer-events: none;
	  z-index: 9997;
	  display: none;
	}
	#tutorial-ghost .ghost-shape {
	  width: 100%;
	  height: 100%;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  background: transparent;
	  border-radius: 10px;
	  animation: ghost-float 1.4s ease-in-out infinite;
	  opacity: 0.95;
	}
	#tutorial-ghost .ghost-shape-grid {
	  display: grid;
	  align-items: center;
	  justify-items: center;
	}
	#tutorial-ghost .ghost-shape-cell {
	  box-sizing: border-box;
	  box-shadow: 0 10px 24px rgba(0,0,0,0.30);
	}
	#tutorial-ghost .ghost-label {
	  position: absolute;
	  top: -86px;
	  left: 20%;
	  transform: translateX(-50%);
	  background: linear-gradient(135deg, #111827, #1f2937);
	  color: #f8fafc;
	  padding: 10px 14px;
	  border-radius: 12px;
	  font-size: 13px;
	  font-weight: 800;
	  white-space: normal;
	  width: 280px;
	  text-align: center;
	  border: 1px solid rgba(255, 255, 255, 0.14);
	  box-shadow: 0 12px 26px rgba(0,0,0,0.38);
	}
	#tutorial-ghost .ghost-rotate-hint {
	  position: absolute;
	  top: -40px;
	  left: 20%;
	  transform: translateX(-50%);
	  background: rgba(17,24,39,0.94);
	  color: #e5e7eb;
	  padding: 10px 14px;
	  border-radius: 12px;
	  font-size: 12px;
	  font-weight: 800;
	  white-space: normal;
	  width: 280px;
	  text-align: center;
	  border: 1px solid rgba(255, 255, 255, 0.16);
	  box-shadow: 0 14px 26px rgba(0,0,0,0.4);
	  display: none;
	}

	.purple-pair-cell {
		position: relative;
	}

	.purple-pair-cell.purple-highlight::after {
		content: '';
		position: absolute;
		top: -4px;
		left: -4px;
		right: -4px;
		bottom: -4px;
		border-radius: 6px;
		box-shadow: 0 0 0 3px rgba(152, 103, 232, 0.95), 0 0 22px rgba(152, 103, 232, 0.6);
		animation: purple-pair-pulse 1.2s ease-in-out infinite;
		pointer-events: none;
	}

	@keyframes purple-pair-pulse {
		0% { box-shadow: 0 0 0 3px rgba(152, 103, 232, 0.95), 0 0 22px rgba(152, 103, 232, 0.6); }
		50% { box-shadow: 0 0 0 5px rgba(152, 103, 232, 0.35), 0 0 30px rgba(152, 103, 232, 0.45); }
		100% { box-shadow: 0 0 0 3px rgba(152, 103, 232, 0.95), 0 0 22px rgba(152, 103, 232, 0.6); }
	}
	@keyframes ghost-float {
	  0% { transform: translateY(0); }
	  50% { transform: translateY(-6px); }
	  100% { transform: translateY(0); }
	}

	body.dark-mode .score-row:hover {
	  background: #484848;
	}

	.color-box { width: 14px; height: 14px; border-radius: 3px; margin-right: 8px; }
	.label { flex: 1; font-size: 0.9em; }
	.score { font-weight: bold; font-size: 1em; }
	.score-row.yellow .color-box { background-color: #f7e757; }
	.score-row.red .color-box { background-color: #ed7e89; }
	.score-row.green .color-box { background-color: #69cf57; }
	.score-row.purple .color-box { background-color: #ae7eed; }
	.score-row.blue .color-box { background-color: #76a0e3; }
	.score-row.bonus .color-box { background-color: #C0C0C0; }
	#scoreboard hr {
	  width: 100%;
	  border: none;
	  border-top: 1px solid rgba(0,0,0,0.08);
	  margin: 0;
	}

	body.dark-mode #scoreboard hr {
	  border-top-color: rgba(255,255,255,0.12);
	}

	#scoreboard .score-total {
	  display: flex;
	  align-items: center;
	  justify-content: space-between;
	  gap: 6px;
	  padding: 4px 8px;
	  background: #f0ead8;
	  border-radius: 6px;
	  border: 1px solid #d9d0bd;
	  font-weight: 600;
	  color: #333;
	  margin-top: 3px;
	  font-size: 0.9rem;
	  transition: box-shadow 0.3s;
	}
	
	/* Total score highlighting voor behaalde doelstellingen */
	#scoreboard .score-total.objective-achieved {
	  box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.6);
	  animation: objective-pulse 2s ease-in-out infinite;
	}
	
	body.dark-mode #scoreboard .score-total.objective-achieved {
	  box-shadow: 0 0 12px 2px rgba(255, 215, 0, 0.7);
	  animation: objective-pulse-dark 2s ease-in-out infinite;
	}

	body.dark-mode #scoreboard .score-total {
	  background: #2f3239;
	  border-color: #3d4048;
	  color: var(--color-text-light);
	}

	#scoreboard .trap-summary {
	  display: flex;
	  flex-direction: column;
	  gap: 6px;
	  padding: 10px 12px;
	  border-radius: 12px;
	  background: rgba(0,0,0,0.035);
	  border: 1px solid rgba(0,0,0,0.06);
	}

	#scoreboard .trap-summary-header {
	  display: flex;
	  justify-content: space-between;
	  align-items: center;
	  font-size: 0.78rem;
	  letter-spacing: 0.05em;
	  text-transform: uppercase;
	  color: rgba(0,0,0,0.55);
	}

	#scoreboard .trap-summary-header .trap-label {
	  font-weight: 600;
	}

	#scoreboard .trap-count {
	  font-weight: 600;
	  font-size: 0.85rem;
	  color: #c43838;
	}

	#scoreboard .trap-preview {
	  display: flex;
	  flex-wrap: wrap;
	  gap: 8px;
	  align-items: center;
	  overflow: hidden;
	  padding-bottom: 0;
	  scrollbar-width: none;
	}

	#scoreboard .trap-preview.trap-preview--compact {
	  gap: 6px;
	  row-gap: 4px;
	}

	#scoreboard .trap-preview:empty::after {
	  content: 'Geen valkuilen geactiveerd';
	  font-size: 0.85rem;
	  color: rgba(0,0,0,0.45);
	  font-style: italic;
	}

	.trap-preview::-webkit-scrollbar {
	  display: none;
	}

	.trap-preview::-webkit-scrollbar-track {
	  background: rgba(0,0,0,0.05);
	  border-radius: 6px;
	}

	.trap-preview::-webkit-scrollbar-thumb {
	  background: rgba(196,56,56,0.4);
	  border-radius: 6px;
	}

	.trap-preview--compact .trap-icon {
	  display: none;
	}

	.trap-compact-chip {
	  display: inline-flex;
	  align-items: center;
	  gap: 4px;
	  padding: 2px 9px;
	  border-radius: 999px;
	  font-weight: 600;
	  font-size: 0.8rem;
	  background: rgba(196,56,56,0.12);
	  color: #a51111;
	  border: 1px solid rgba(196,56,56,0.28);
	}

	.trap-compact-chip::before {
	  content: attr(data-symbol);
	  font-size: 1rem;
	  line-height: 1;
	}

	.trap-compact-chip span {
	  pointer-events: none;
	}

	.trap-compact-chip--black-hole {
	  background: rgba(62, 44, 143, 0.12);
	  color: #3e2c8f;
	  border-color: rgba(62, 44, 143, 0.26);
	}

	.trap-icon {
	  position: relative;
	  width: 40px;
	  height: 40px;
	  flex: 0 0 auto;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  border-radius: 10px;
	  background: radial-gradient(circle at 30% 30%, #ffeaea, #f6d3d3);
	  border: 1px solid rgba(196,56,56,0.35);
	  box-shadow: 0 4px 10px rgba(196,56,56,0.18);
	  font-size: 1.4rem;
	  color: #a51111;
	  transition: transform 0.2s ease, box-shadow 0.2s ease;
	}

	.trap-icon .penalty-chip {
	  position: absolute;
	  right: -4px;
	  bottom: -6px;
	  background: #2a0b0b;
	  color: #ffb3b3;
	  font-size: 0.7rem;
	  font-weight: 600;
	  padding: 1px 5px;
	  border-radius: 10px;
	  border: 1px solid rgba(255,255,255,0.25);
	  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
	}

	.trap-icon.trap-icon--black-hole {
	  background: radial-gradient(circle at 35% 28%, #f1ecff 0%, #d7d1fb 60%, #bfb6ef 100%);
	  border-color: rgba(110, 80, 210, 0.35);
	  color: #3e2c8f;
	  box-shadow: 0 6px 14px rgba(80, 60, 160, 0.28);
	}

	.trap-icon.trap-icon--black-hole .penalty-chip {
	  background: rgba(40, 28, 100, 0.9);
	  color: #efe8ff;
	  border-color: rgba(255,255,255,0.38);
	}

	.trap-icon span {
	  pointer-events: none;
	}

	.trap-icon span:first-child {
	  font-size: 1.05rem;
	}

	.trap-icon.highlight {
	  transform: translateY(-3px) scale(1.05);
	  box-shadow: 0 8px 16px rgba(196,56,56,0.36);
	}

	#scoreboard .score-total .label {
	  font-size: 0.85rem;
	  letter-spacing: 0.08em;
	  text-transform: uppercase;
	  opacity: 0.8;
	}

	#scoreboard .score-total .total-score {
	  font-size: 2.2rem;
	  line-height: 1;
	  font-weight: 700;
	  color: #2b1a00;
	}

	#bonus-score[data-blackhole-extra]:not([data-blackhole-extra="0"])::after {
	  content: ' +' attr(data-blackhole-extra);
	  font-size: 0.7em;
	  margin-left: 6px;
	  color: #6b63c9;
	}

	body.dark-mode #scoreboard .score-total {
	  background: linear-gradient(140deg, #3a331f, #2b2619);
	  border-color: rgba(255, 199, 63, 0.25);
	  color: #f6f1dd;
	  box-shadow: 0 16px 30px rgba(0,0,0,0.35);
	}

	body.dark-mode #scoreboard .trap-summary {
	  background: rgba(255,255,255,0.03);
	  border-color: rgba(255,255,255,0.07);
	}
	body.dark-mode #bonus-score[data-blackhole-extra]:not([data-blackhole-extra="0"])::after {
	  color: #d5d0ff;
	}

	body.dark-mode .trap-icon {
	  background: radial-gradient(circle at 30% 30%, #3c1e1e, #281111);
	  border-color: rgba(196,56,56,0.45);
	  color: #f3bbbb;
	  box-shadow: 0 4px 12px rgba(0,0,0,0.45);
	}

	body.dark-mode .trap-icon.trap-icon--black-hole {
	  background: radial-gradient(circle at 38% 32%, #403472 0%, #291f55 58%, #110b30 100%);
	  border-color: rgba(150,120,240,0.55);
	  color: #d9d5ff;
	  box-shadow: 0 6px 16px rgba(50,30,120,0.45);
	}

	body.dark-mode .trap-icon .penalty-chip {
	  background: rgba(70,20,20,0.85);
	  color: #ffc9c9;
	}

	body.dark-mode .trap-icon.trap-icon--black-hole .penalty-chip {
	  background: rgba(24,18,70,0.9);
	  color: #f0ecff;
	}

	body.dark-mode #scoreboard .trap-summary-header {
	  color: rgba(255,240,210,0.6);
	}

	body.dark-mode #scoreboard .trap-summary-header .trap-label {
	  color: rgba(255,240,210,0.9);
	}

	body.dark-mode #scoreboard .trap-count {
	  color: #ff8585;
	}

	body.dark-mode #scoreboard .trap-preview:empty::after {
	  color: rgba(255,255,255,0.35);
	}

	body.dark-mode .trap-preview::-webkit-scrollbar-track {
	  background: rgba(255,255,255,0.05);
	}

	body.dark-mode .trap-preview::-webkit-scrollbar-thumb {
	  background: rgba(255,120,120,0.45);
	}

	body.dark-mode .trap-compact-chip {
	  background: rgba(196,56,56,0.18);
	  color: #ffb3b3;
	  border-color: rgba(196,56,56,0.32);
	}

	body.dark-mode .trap-compact-chip--black-hole {
	  background: rgba(79, 64, 150, 0.22);
	  color: #d6d1ff;
	  border-color: rgba(131, 117, 210, 0.35);
	}

	body.dark-mode .trap-icon {
	  background: radial-gradient(circle at 30% 30%, #4b1c1c, #2a1212);
	  border-color: rgba(255,120,120,0.45);
	  color: #ffb3b3;
	  box-shadow: 0 4px 10px rgba(0,0,0,0.4);
	}

	body.dark-mode .trap-icon .penalty-chip {
	  background: #901717;
	  color: #ffe0e0;
	  border-color: rgba(0,0,0,0.45);
	}

	body.dark-mode #scoreboard .score-total .label {
	  color: rgba(255, 243, 205, 0.8);
	}

	body.dark-mode #scoreboard .score-total .total-score {
	  color: #ffe6a3;
	}

	/* ============================================
	   HIGH SCORE POPUP & MODAL
	   ============================================
	*/
	.highscore-toast {
		position: fixed;
		top: 80px;
		left: 50%;
		transform: translate(-50%, 0) scale(0.96);
		background: linear-gradient(120deg, #fff7d1, #ffe089);
		color: #2a1b00;
		padding: 14px 20px;
		border-radius: 16px;
		display: flex;
		align-items: center;
		gap: 12px;
		box-shadow: 0 18px 40px rgba(0,0,0,0.32);
		font-weight: 600;
		z-index: 2147483647;
		opacity: 0;
		animation: highscoreToastEnter 0.35s ease forwards;
		pointer-events: none;
	}

	.highscore-toast__icon {
		font-size: 1.5rem;
	}

	.highscore-toast__score {
		font-size: 1.25rem;
		font-weight: 800;
	}

	body.dark-mode .highscore-toast {
		background: linear-gradient(120deg, #2f2a1f, #4d3f1d);
		color: #fff6cc;
		box-shadow: 0 20px 46px rgba(0,0,0,0.6);
	}

	@keyframes highscoreToastEnter {
		0% { opacity: 0; transform: translate(-50%, -30px) scale(0.8); }
		70% { opacity: 1; transform: translate(-50%, 6px) scale(1.03); }
		100% { opacity: 1; transform: translate(-50%, 0) scale(1); }
	}

	/* High Score Modal */
	.highscore-modal-overlay {
		position: fixed;
		inset: 0;
		background: rgba(0,0,0,0.5);
		backdrop-filter: blur(4px);
		display: none;
		align-items: center;
		justify-content: center;
		z-index: 10000;
	}
	.highscore-modal-overlay.show { display: flex; }
	.highscore-modal {
		background: white;
		padding: 30px;
		border-radius: 12px;
		text-align: center;
		box-shadow: 0 10px 30px rgba(0,0,0,0.3);
		max-width: 90%;
		width: 300px;
	}
	body.dark-mode .highscore-modal {
		background: #2d2d2d;
		color: #eee;
	}
	.highscore-value {
		font-size: 3rem;
		font-weight: bold;
		color: #d4af37;
		margin: 20px 0;
	}
	.highscore-close-btn {
		background: #eee;
		border: none;
		padding: 10px 20px;
		border-radius: 6px;
		cursor: pointer;
		font-weight: bold;
	}
	.highscore-close-btn:hover { background: #ddd; }
	body.dark-mode .highscore-close-btn {
		background: #444;
		color: #eee;
	}
	body.dark-mode .highscore-close-btn:hover {
		background: #555;
	}

/* Saved-levels modal tweaks */
#saved-levels-modal .highscore-modal { width: 420px; max-width: 95%; text-align: left; }
#saved-levels-modal .highscore-modal h2 { margin: 0 0 12px 0; }
#saved-levels-modal #saved-levels-list { padding: 6px 4px; gap: 8px; }
#saved-levels-modal #saved-levels-list > div { display:flex; align-items:center; gap:8px; padding:8px; border-radius:6px; }
#saved-levels-modal #saved-levels-list > div:hover { background: rgba(0,0,0,0.03); }
#saved-levels-modal .highscore-modal button { padding:6px 10px; border-radius:6px; border:1px solid rgba(0,0,0,0.08); background:transparent; cursor:pointer; }
#saved-levels-modal .highscore-modal button:hover { background: rgba(0,0,0,0.04); }
#saved-levels-modal .trash-btn { color: #666; }
#saved-levels-modal .trash-btn:hover { color: #c0392b; }

/* Buttons: default + primary (blue) */
#saved-levels-modal .modal-btn { background: #f6f6f6; color: #222; border: 1px solid rgba(0,0,0,0.06); }
#saved-levels-modal .modal-btn.primary { background: linear-gradient(135deg,#4a90e2,#6fb1ff); color: #fff; border: none; }
#saved-levels-modal .modal-btn.primary:hover { filter: brightness(0.95); }

/* Dark mode overrides for better contrast */
body.dark-mode #saved-levels-modal .modal-btn { background: #3a3a3a; color: #eee; border: 1px solid rgba(255,255,255,0.04); }
body.dark-mode #saved-levels-modal .modal-btn.primary { background: linear-gradient(135deg,#2b6fb8,#4a90e2); color: #fff; }
body.dark-mode #saved-levels-modal .modal-btn.primary:hover { filter: brightness(1.05); }
body.dark-mode #saved-levels-modal .trash-btn { color: #ccc; }

/* Saved item title and label colors */
#saved-levels-modal .saved-title { font-size: 14px; color: rgba(0,0,0,0.9); }
body.dark-mode #saved-levels-modal .saved-title { color: #fff; }

/* Custom scrollbar for saved-levels list */
#saved-levels-modal #saved-levels-list::-webkit-scrollbar { width:10px; }
#saved-levels-modal #saved-levels-list::-webkit-scrollbar-track { background: transparent; }
#saved-levels-modal #saved-levels-list::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.12); border-radius: 6px; }
#saved-levels-modal #saved-levels-list::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.18); }

/* Saved level item text */
#saved-levels-modal .saved-obj-text { font-size: 13px; color: rgba(0,0,0,0.85); opacity: 1; }
body.dark-mode #saved-levels-modal .saved-obj-text { color: #ddd; opacity: 0.95; }

	/* ============================================
	   ANIMATIES
	   ============================================
	*/
	@keyframes popIn {
	  to { transform: translate(-50%, -50%) scale(1); }
	}

	#card-choice-zone {
	  background: #fffbea;
	  border-radius: 12px;
	  color: #333;
	  font-family: "Segoe UI", sans-serif;
	  width: min(402px, 100%);
	  box-shadow: 0 0 8px rgba(0,0,0,0.4);
	  overflow: hidden;
	}

	body.dark-mode #card-choice-zone {
	  background: linear-gradient(145deg, #22252b, #1a1c21);
	  border: 1px solid #2d2f36;
	  box-shadow: 0 0 12px rgba(0,0,0,0.6);
	  color: #e5e5e5;
	}

	#card-controls {
		display: flex;
		flex-direction: row;
		align-items: flex-start;
		justify-content: center;
		gap: 16px;
		width: 100%;
		box-sizing: border-box;
	}

	#card-options {
		flex: 1 1 auto;
		min-width: 0;
		display: flex;
		flex-wrap: wrap;
		gap: 14px;
		justify-content: center;
		align-items: flex-start;
		margin: 0;
		padding: 0;
	}

	#card-action-buttons {
		display: flex;
		flex-direction: column;
		align-items: stretch;
		gap: 14px;
		max-width: 190px;
		width: 100%;
		flex: 0 0 auto;
	}

	.card-action-btn {
		position: relative;
		display: inline-flex;
		align-items: center;
		justify-content: flex-start;
		gap: 10px;
		width: 100%;
		min-width: 0;
		margin: 0;
		padding: 12px 16px;
		border-radius: 14px;
		border: 1px solid rgba(26,32,48,0.16);
		background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
		color: #2b3148;
		font-weight: 600;
		font-size: 0.88rem;
		letter-spacing: 0.04em;
		text-transform: none;
		box-shadow: 0 12px 20px rgba(10,12,20,0.22);
		cursor: pointer;
		transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.25s ease, background 0.25s ease;
		min-height: 52px;
	}

	.card-action-btn::before {
		content: attr(data-icon);
		font-size: 1.4rem;
		line-height: 1;
	}

	.card-action-btn::after {
		content: attr(data-label);
		line-height: 1.1;
		white-space: nowrap;
	}

	/* Desktop: buttons zijn 52x52px iconen zonder tekst */
	@media (min-width: 651px) {
		/* Desktop must not show the mobile hand-scroll arrows. */
		.hand-scroll-btn,
		#card-controls.hand-scroll-enabled .hand-scroll-btn {
			display: none;
		}

		.card-action-btn {
			justify-content: center;
			padding: 12px;
			min-width: 52px;
			width: 52px;
			max-width: 52px;
			min-height: 52px;
			height: 52px;
		}

		.card-action-btn::after {
			display: none;
		}

		/* Ensure the â€œnext turnâ€ button matches the deck button and sits next to it. */
		#card-action-buttons .card-action-btn {
			width: 52px;
			max-width: 52px;
			min-width: 52px;
			justify-content: center;
		}
		#card-action-buttons .card-action-btn::after {
			display: none;
		}
		#card-action-buttons #new-cards-btn { order: 0; }
		#card-action-buttons #deck-preview { order: 1; }
		
		/* Deck preview: vierkant en zelfde kleur als andere buttons */
		.deck-preview {
			min-width: 52px;
			width: 52px;
			max-width: 52px;
			min-height: 52px;
			height: 52px;
			padding: 0;
			background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
			border: 1px solid rgba(26,32,48,0.16);
			border-radius: 14px;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			gap: 2px;
			box-shadow: 0 12px 20px rgba(10,12,20,0.2);
		}
		
		.deck-preview::before {
			content: 'ðŸ“š';
			font-size: 1.2rem;
			display: block;
			line-height: 1;
		}

		.deck-preview::after {
			display: none;
		}
		
		/* Deck preview: zorg dat icoon ook in portrait mode zichtbaar is */
		body.desktop-portrait .deck-preview::before {
			content: 'ðŸ“š';
			display: block;
		}

		.deck-count {
			position: static;
			min-width: auto;
			padding: 0;
			background: none;
			border: none;
			box-shadow: none;
			font-size: 0.75rem;
			font-weight: 700;
			color: #2b3148;
			line-height: 1;
		}

		.deck-count::before {
			display: none;
		}

		body.dark-mode .deck-preview {
			background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
			border-color: rgba(140,150,200,0.3);
		}

		body.dark-mode .deck-count {
			color: rgba(235,238,255,0.88);
		}
	}

	.card-action-btn:hover:not(:disabled),
	.card-action-btn:focus-visible {
		transform: translateY(-2px);
		box-shadow: 0 18px 28px rgba(10,12,20,0.28);
	}

	.card-action-btn:focus-visible {
		outline: 3px solid rgba(86,122,255,0.55);
		outline-offset: 3px;
	}

	.card-action-btn:disabled {
		opacity: 0.55;
		cursor: not-allowed;
		transform: none;
		box-shadow: none;
	}

	body.dark-mode .card-action-btn {
		background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
		border-color: rgba(140,150,200,0.3);
		color: rgba(235,238,255,0.88);
		box-shadow: 0 16px 30px rgba(0,0,0,0.42);
	}

	body.dark-mode .card-action-btn:hover:not(:disabled),
	body.dark-mode .card-action-btn:focus-visible {
		box-shadow: 0 20px 34px rgba(0,0,0,0.5);
	}

	/* Dark mode deck preview matching card buttons */
	body.dark-mode #card-action-buttons .deck-preview {
		background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
		border-color: rgba(140,150,200,0.3);
	}

	body.dark-mode #card-action-buttons .deck-count {
		color: rgba(235,238,255,0.88);
	}

	.deck-preview {
		position: relative;
		display: inline-flex;
		align-items: center;
		justify-content: space-between;
		gap: 10px;
		padding: 12px 16px;
		border-radius: 14px;
		border: 1px solid rgba(26,32,48,0.16);
		background: linear-gradient(160deg, #ffffff 0%, #edf1ff 100%);
		box-shadow: 0 12px 20px rgba(10,12,20,0.2);
		color: #2b3148;
		cursor: pointer;
		transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.25s ease, background 0.25s ease;
		min-height: 52px;
		flex: 0 0 auto;
	}

	.deck-preview::after {
		display: none;
	}

	.deck-preview:hover,
	.deck-preview:focus-visible {
		transform: translateY(-2px);
		box-shadow: 0 18px 28px rgba(10,12,20,0.28);
	}

	.deck-preview:focus-visible {
		outline: 3px solid rgba(86,122,255,0.55);
		outline-offset: 3px;
	}
	
	/* Verwijder outline in desktop modes */
	@media (min-width: 651px) {
		.deck-preview:focus-visible {
			outline: none;
		}
	}

	.deck-count {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 4px;
		min-width: 54px;
		padding: 6px 10px;
		border-radius: 10px;
		background: rgba(255,255,255,0.9);
		border: 1px solid rgba(26,32,48,0.16);
		box-shadow: inset 0 -1px 0 rgba(255,255,255,0.75), 0 6px 12px rgba(10,12,20,0.18);
		font-size: 1.05rem;
		font-weight: 700;
		color: #2b3148;
		font-variant-numeric: tabular-nums;
	}

	/* Desktop: deck count centered zonder icon */
	@media (min-width: 651px) {
		.deck-count {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			min-width: auto;
			padding: 0;
			background: none;
			border: none;
			box-shadow: none;
		}

		.deck-count::before {
			display: none;
		}
	}

	.deck-count::before {
		content: '\1F4DA';
		font-size: 1.1rem;
	}

	body.dark-mode .deck-preview {
		background: linear-gradient(160deg, #2c3144 0%, #1f2333 100%);
		border-color: rgba(140,150,200,0.28);
		color: rgba(235,238,255,0.9);
		box-shadow: 0 18px 30px rgba(0,0,0,0.4);
	}

	body.dark-mode .deck-preview::after {
		color: rgba(235,238,255,0.75);
	}

	body.dark-mode .deck-preview:focus-visible {
		outline-color: rgba(120,160,255,0.7);
	}

	body.dark-mode .deck-count {
		background: rgba(18,22,36,0.92);
		border-color: rgba(120,140,220,0.38);
		color: rgba(235,238,255,0.88);
		box-shadow: inset 0 -1px 0 rgba(255,255,255,0.08), 0 6px 12px rgba(0,0,0,0.42);
	}

	#turn-counter-inline {
		display: none;
	}

	body.dark-mode #turn-counter-inline {
		background: linear-gradient(145deg, #22252b, #1a1c21);
		border: 1px solid var(--color-border-dark);
		box-shadow: 0 6px 14px rgba(0,0,0,0.45);
		color: var(--color-text-light);
	}

	.card-option {
		flex: 0 0 auto;
		width: 138px;
		min-height: 180px;
		padding: 0;
		display: flex;
		flex-direction: column;
		--preview-cell: 20px;
		align-items: center;
		justify-content: center;
		gap: 12px;
		border-radius: 16px;
		background: linear-gradient(165deg, #ffffff 0%, #eef2ff 45%, #dfe4ff 100%);
		border: 1px solid rgba(40,55,120,0.18);
		box-sizing: border-box;
		box-shadow: 0 18px 26px rgba(10,12,20,0.2);
		position: relative;
		overflow: visible;
		transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
	}

	/* Desktop landscape request: cards a bit shorter (â‰ˆ10px). */
	body.desktop-landscape #card-choice-zone .card-option {
		min-height: 170px;
	}

	/* Desktop request: make cards ~20px smaller overall. */
	body.desktop-landscape .card-option {
		width: 118px;
	}

	.card-option::after {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: inherit;
		background: linear-gradient(120deg, rgba(255,255,255,0.65), rgba(255,255,255,0) 58%);
		opacity: 0.45;
		pointer-events: none;
	}

	.card-option > * {
		position: relative;
		z-index: 1;
	}

	.card-option:hover {
		transform: translateY(-6px);
		box-shadow: 0 30px 48px rgba(20,30,60,0.32);
	}

	.card-option.selected {
		border-color: rgba(82,118,255,0.6);
		box-shadow: 0 32px 52px rgba(70,90,180,0.45);
	}

	/* Card control buttons voor mobiel en touch devices - fixed positie onderaan */
	.card-control-btn {
		position: fixed;
		/* Position bottom center for touch devices */
		bottom: calc(var(--bottom-bar-height) + 10px);
		width: 44px;
		height: 44px;
		border: 2px solid white;
		border-radius: 50%;
		display: none;
		align-items: center;
		justify-content: center;
		font-size: 20px;
		color: white;
		cursor: pointer;
		box-shadow: 0 4px 12px rgba(0,0,0,0.3);
		z-index: calc(var(--z-controls) + 10);
		user-select: none;
		transition: transform 0.15s ease, opacity 0.15s ease;
		pointer-events: auto;
		touch-action: manipulation;
	}

	.card-control-btn:hover {
		transform: scale(1.1);
	}

	.card-control-btn:active {
		transform: scale(0.95);
	}

	/* Toon buttons wanneer er een selectie is */
	.card-control-btn.visible {
		display: flex;
	}

	/* When JS positions the buttons near the dragged block, override the
	   fixed layout offsets (e.g. mobile-sidebar translateY + right:15px). */
	.card-control-btn.dynamic-pos {
		right: auto;
		margin-left: 0;
		transform: none;
	}

	.card-control-rotate {
		left: 50%;
		margin-left: 75px;
		background: #4a90e2;
	}

	.card-control-mirror {
		left: 50%;
		margin-left: 25px;
		background: #9b59b6;
	}

	.card-control-cancel {
		left: 50%;
		margin-left: -25px;
		background: #e74c3c;
	}

	/* Touch portrait mode: buttons blijven onderaan gecentreerd */
	body.touch-portrait .card-control-btn {
		bottom: calc(var(--bottom-bar-height) + 10px);
		top: auto;
		right: auto;
	}
	
	/* Mobile sidebar landscape: buttons aan de rechterkant */
	body.mobile-sidebar-layout .card-control-btn {
		bottom: auto;
		top: 50%;
		left: auto;
		right: 15px;
		margin-left: 0;
	}
	body.mobile-sidebar-layout .card-control-rotate {
		transform: translateY(-85px);
	}
	body.mobile-sidebar-layout .card-control-mirror {
		transform: translateY(-30px);
	}
	body.mobile-sidebar-layout .card-control-cancel {
		transform: translateY(25px);
	}

	.card-control-btn:hover {
		transform: scale(1.1);
	}
	
	.card-control-btn:active {
		transform: scale(0.95);
	}

	body.dark-mode .card-control-rotate {
		background: #5a9fd4;
		border-color: #1e2128;
	}

	body.dark-mode .card-control-mirror {
		background: #8e44ad;
		border-color: #1e2128;
	}

	body.dark-mode .card-control-cancel {
		background: #c0392b;
		border-color: #1e2128;
	}

	.card-pattern {
		display: inline-grid;
		gap: var(--preview-gap, 2px);
		align-items: center;
		justify-items: center;
		justify-content: center;
		align-content: center;
	}

	.card-option .card-cell {
		width: var(--card-cell-size, 22px);
		height: var(--card-cell-size, 22px);
		/* Border-radius: max 5px, minder rond voor kleine cells */
		border-radius: min(5px, calc(var(--card-cell-size, 22px) / 5));
		border: 1px solid rgba(12,16,30,0.12);
		box-shadow: inset 0 0 4px rgba(0,0,0,0.18);
		background: rgba(255,255,255,0.95);
	}

	.card-label {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 6px;
		padding: 5px 10px;
		border-radius: 999px;
		background: rgba(20,24,36,0.06);
		font-size: 0.72rem;
		font-weight: 600;
		letter-spacing: 0.065em;
		text-transform: uppercase;
		color: rgba(20,24,36,0.62);
		text-align: center;
	}

	.card-meta {
		font-size: 0.72rem;
		letter-spacing: 0.05em;
		color: rgba(20,24,36,0.55);
		text-align: center;
		align-self: center;
	}

	.card-meta.card-meta--level2 {
		font-weight: 800;
		letter-spacing: 0.08em;
		text-transform: uppercase;
		color: #0f243a;
	}

	.card-effect {
		margin-top: 6px;
		font-size: 0.68rem;
		font-weight: 700;
		letter-spacing: 0.05em;
		text-transform: uppercase;
		color: rgba(20,24,36,0.62);
		background: rgba(20,24,36,0.06);
		padding: 4px 10px;
		border-radius: 999px;
		display: inline-flex;
		align-items: center;
		gap: 6px;
	}

	.card-effect.card-effect-echo {
		background: linear-gradient(135deg, #e5f1ff, #d7e4ff);
		color: #0f243a;
		padding: 8px 10px;
		border-radius: 12px;
		box-shadow: 0 10px 22px rgba(0,0,0,0.16);
		gap: 10px;
		align-self: flex-start;
	}

	.card-effect-echo .card-effect-echo-icon {
		width: 24px;
		height: 24px;
		border-radius: 7px;
		background: linear-gradient(135deg, #4fc3ff, #6a8bff);
		display: grid;
		place-items: center;
		color: #0b1b2c;
		font-weight: 800;
		font-size: 14px;
		box-shadow: 0 6px 14px rgba(0,0,0,0.16);
	}

	.card-effect-echo .card-effect-echo-text {
		display: flex;
		flex-direction: column;
		line-height: 1.05;
		gap: 1px;
	}

	.card-effect-echo .card-effect-echo-title {
		font-size: 0.78rem;
		letter-spacing: 0.07em;
	}

	.card-effect-echo .card-effect-echo-sub {
		font-size: 0.7rem;
		letter-spacing: 0.04em;
		font-weight: 700;
		opacity: 0.82;
	}

	.card-effect.card-effect-boost {
		background: linear-gradient(135deg, #fff4cc, #ffd27a);
		color: #5a3a00;
		padding: 8px 10px;
		border-radius: 12px;
		box-shadow: 0 10px 22px rgba(0,0,0,0.16);
		gap: 10px;
		align-self: flex-start;
		display: inline-flex;
		align-items: center;
	}

	.card-effect-boost .card-effect-boost-icon {
		width: 24px;
		height: 24px;
		border-radius: 7px;
		background: linear-gradient(135deg, #ffd56b, #ffb347);
		display: grid;
		place-items: center;
		color: #4c2a00;
		font-weight: 800;
		font-size: 14px;
		box-shadow: 0 6px 14px rgba(0,0,0,0.16);
	}

	.card-effect-boost .card-effect-boost-text {
		display: flex;
		flex-direction: column;
		line-height: 1.05;
		gap: 1px;
	}

	.card-effect-boost .card-effect-boost-title {
		font-size: 0.78rem;
		letter-spacing: 0.07em;
		font-weight: 800;
	}

	.card-effect-boost .card-effect-boost-sub {
		font-size: 0.7rem;
		letter-spacing: 0.04em;
		font-weight: 700;
		opacity: 0.82;
	}

	.card-boost-badge {
		position: absolute;
		bottom: 6px;
		left: 6px;
		width: 30px;
		height: 30px;
		display: flex;
		align-items: center;
		justify-content: center;
		border-radius: 10px;
		font-size: 0.72rem;
		font-weight: 800;
		color: #5a3a00;
		background: linear-gradient(135deg, #fff4cc, #ffd27a);
		box-shadow: 0 8px 16px rgba(0,0,0,0.2);
		border: 1px solid rgba(90,58,0,0.2);
		letter-spacing: 0;
		text-align: center;
		line-height: 1;
		pointer-events: none;
	}

	.card-option { position: relative; }

	.card-echo-badge {
		position: absolute;
		bottom: 6px;
		right: 6px;
		width: 30px;
		height: 30px;
		display: flex;
		align-items: center;
		justify-content: center;
		border-radius: 10px;
		font-size: 0.68rem;
		font-weight: 800;
		color: #0b1b2c;
		background: linear-gradient(135deg, #e5f1ff, #d7e4ff);
		box-shadow: 0 8px 16px rgba(0,0,0,0.2);
		pointer-events: auto;
		cursor: pointer;
		border: 1px solid rgba(12,22,36,0.12);
		letter-spacing: 0;
		text-align: center;
		line-height: 1;
	}

	.card-echo-badge:focus-visible {
		outline: 2px solid rgba(255,255,255,0.9);
		outline-offset: 2px;
	}

	.card-echo-badge[data-variant="points"] {
		background: linear-gradient(135deg, #f7e58f, #f4c542);
		color: #4c3600;
	}

	.card-echo-badge[data-variant="bonus"] {
		background: linear-gradient(135deg, #b4f1d2, #6cd3a5);
		color: #0f3825;
	}

	.card-echo-badge[data-variant="replay"] {
		background: linear-gradient(135deg, #cfe2ff, #8fb2ff);
		color: #0b1b2c;
	}

	.card-echo-badge.card-echo-badge--ready {
		box-shadow: 0 0 0 3px rgba(34,197,94,0.25), 0 8px 16px rgba(0,0,0,0.25);
	}

	.card-option.card-replay-ready .card-echo-badge {
		animation: bonus-echo-replay-pulse 0.9s ease-out 1;
	}

	@keyframes bonus-echo-replay-pulse {
		0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(74,144,226,0.55), 0 8px 16px rgba(0,0,0,0.2); }
		55% { transform: scale(1.18); box-shadow: 0 0 0 8px rgba(74,144,226,0.25), 0 10px 20px rgba(0,0,0,0.3); }
		100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(74,144,226,0), 0 8px 16px rgba(0,0,0,0.2); }
	}

	.card-echo-tooltip {
		position: absolute;
		top: 8px;
		left: 50%;
		right: auto;
		max-width: 240px;
		padding: 8px 10px;
		background: rgba(12,18,28,0.92);
		color: #f3f5ff;
		border-radius: 12px;
		box-shadow: 0 14px 30px rgba(0,0,0,0.38);
		font-size: 0.75rem;
		line-height: 1.25;
		opacity: 0;
		pointer-events: none;
		transform: translateX(-50%) translateY(6px);
		transition: opacity 0.16s ease, transform 0.16s ease;
		z-index: 3;
	}

	.card-bonus-echo:hover .card-echo-tooltip,
	.card-bonus-echo:focus-within .card-echo-tooltip,
	.card-bonus-echo.card-echo-tooltip-active .card-echo-tooltip {
		opacity: 1;
		transform: translateX(-50%) translateY(0);
	}

	body.dark-mode .card-option {
		background: linear-gradient(160deg, #2d3142 0%, #232635 45%, #1b1e2c 100%);
		border-color: rgba(120,140,220,0.2);
		box-shadow: 0 26px 44px rgba(0,0,0,0.5);
	}

	body.dark-mode .card-option::after {
		opacity: 0.25;
	}

	body.dark-mode .card-option .card-cell {
		border-color: rgba(255,255,255,0.08);
		box-shadow: inset 0 0 6px rgba(0,0,0,0.35);
		background: rgba(18,22,32,0.6);
	}

	body.dark-mode .card-label {
		background: rgba(255,255,255,0.08);
		color: rgba(255,255,255,0.82);
	}

	body.dark-mode .card-meta {
		color: rgba(255,255,255,0.65);
	}

	body.dark-mode .card-effect {
		color: rgba(255,255,255,0.85);
		background: rgba(255,255,255,0.08);
	}

	body.dark-mode .card-effect.card-effect-echo {
		background: linear-gradient(135deg, #1f2f4c, #1a2741);
		color: #e7f2ff;
		box-shadow: 0 10px 22px rgba(0,0,0,0.45);
	}

	body.dark-mode .card-effect.card-effect-boost {
		background: linear-gradient(135deg, #3b2a12, #2a1f10);
		color: #ffe9b0;
		box-shadow: 0 10px 22px rgba(0,0,0,0.45);
	}

	body.dark-mode .card-effect-boost .card-effect-boost-icon {
		background: linear-gradient(135deg, #ffcc66, #ffb347);
		color: #2a1b00;
		box-shadow: 0 6px 14px rgba(0,0,0,0.35);
	}

	body.dark-mode .card-boost-badge {
		background: linear-gradient(135deg, #3b2a12, #2a1f10);
		color: #ffe9b0;
		border-color: rgba(255,233,176,0.2);
		box-shadow: 0 8px 16px rgba(0,0,0,0.35);
	}

	body.dark-mode .card-effect-echo .card-effect-echo-icon {
		background: linear-gradient(135deg, #5ac8ff, #809cff);
		color: #0b1626;
		box-shadow: 0 6px 14px rgba(0,0,0,0.35);
	}

	#card-options {
	  display: flex;
	  flex-wrap: wrap;
	  gap: 12px;
	  justify-content: center;
	  margin-top: 12px;
	}

	@keyframes coinPop {
	  0% { transform: translate(-50%, -50%) scale(0); opacity: 0.2; }
	  70% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
	  100% { transform: translate(-50%, -50%) scale(1); }
	}


	@keyframes growRoot {
	  from { opacity: 0; transform: scale(0.5); }
	  to { opacity: 1; transform: scale(1); }
	}

	.modal-overlay {
		position: fixed;
		inset: 0;
		padding: 18px;
		display: none;
		align-items: flex-start;
		justify-content: center;
		background: rgba(10, 12, 20, 0.6);
		backdrop-filter: blur(6px);
		-webkit-backdrop-filter: blur(6px);
		z-index: 1200;
		overflow-y: auto;
	}

	.modal-overlay.show {
		display: flex;
	}

	.game-modal {
		background: #fffbea;
		border-radius: 16px;
		padding: 24px;
		width: min(420px, 100%);
		box-shadow: 0 26px 48px rgba(10, 12, 20, 0.34);
		border: 1px solid rgba(20, 24, 36, 0.18);
		color: #191d2a;
		position: relative;
	}

	body.dark-mode .game-modal {
		background: rgba(12, 14, 20, 0.95);
		border-color: rgba(255, 255, 255, 0.14);
		color: #f5f6ff;
		box-shadow: 0 30px 52px rgba(0, 0, 0, 0.55);
	}

	.game-modal h2 {
		margin-top: 0;
		margin-bottom: 8px;
		font-size: 1.35rem;
	}

	.game-modal p {
		margin: 8px 0;
		line-height: 1.5;
	}

	.modal-subtext {
		margin: 4px 0 0;
		font-size: 0.85rem;
		color: rgba(27, 33, 48, 0.7);
	}

	body.dark-mode .modal-subtext {
		color: rgba(245, 246, 255, 0.7);
	}

	.modal-actions {
		display: flex;
		flex-wrap: wrap;
		gap: 12px;
		justify-content: flex-end;
		margin-top: 20px;
	}

	.modal-actions button {
		background: linear-gradient(145deg, #ffd560, #ffb23c);
		border: 1px solid rgba(20, 24, 36, 0.14);
		border-radius: 10px;
		padding: 10px 18px;
		font-weight: 600;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease;
		color: #1f2433;
	}

	.modal-actions button:hover:not(:disabled) {
		transform: translateY(-2px);
		box-shadow: 0 14px 28px rgba(10, 12, 20, 0.28);
	}

	.modal-actions button:disabled {
		opacity: 0.6;
		cursor: not-allowed;
		box-shadow: none;
	}

	body.dark-mode .modal-actions button {
		background: linear-gradient(145deg, #2f3546, #1c2233);
		border-color: rgba(255, 255, 255, 0.12);
		color: #f5f6ff;
	}

	.modal-score-summary {
		margin-top: 14px;
		display: flex;
		flex-direction: column;
		gap: 16px;
	}

	.round-summary-cards {
		display: flex;
		flex-wrap: wrap;
		gap: 12px;
		justify-content: center;
	}

	.round-summary-card {
		flex: 1 1 160px;
		min-width: 150px;
		padding: 14px 16px;
		border-radius: 16px;
		text-align: center;
		background: linear-gradient(145deg, rgba(255, 242, 196, 0.85), rgba(255, 214, 125, 0.9));
		border: 1px solid rgba(20, 24, 36, 0.08);
		box-shadow: 0 16px 24px rgba(31, 36, 51, 0.12);
	}

	.round-summary-card--coins {
		background: linear-gradient(145deg, rgba(255, 240, 200, 0.9), rgba(255, 199, 142, 0.95));
	}

	/* Unlock Modal Styles */
	.unlock-modal {
		max-width: 500px;
		text-align: center;
	}

	/* Modal button (Doorgaan knop) */
	.modal-button {
		background: linear-gradient(145deg, #667eea, #764ba2);
		border: 1px solid rgba(102, 126, 234, 0.3);
		border-radius: 10px;
		padding: 12px 28px;
		font-weight: 600;
		font-size: 1rem;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
		color: #fff;
		box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
		margin-top: 10px;
	}

	.modal-button:hover {
		transform: translateY(-2px);
		box-shadow: 0 12px 28px rgba(102, 126, 234, 0.45);
		background: linear-gradient(145deg, #7a8ff0, #8a5cb8);
	}

	body.dark-mode .modal-button {
		background: linear-gradient(145deg, #4a5fb8, #5a3d8a);
		border-color: rgba(139, 159, 245, 0.4);
		box-shadow: 0 8px 20px rgba(74, 95, 184, 0.4);
	}

	body.dark-mode .modal-button:hover {
		background: linear-gradient(145deg, #5a6fc8, #6a4d9a);
		box-shadow: 0 12px 28px rgba(74, 95, 184, 0.55);
	}

	.unlock-modal-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
	}

	.unlock-icon {
		font-size: 64px;
		animation: unlock-bounce 0.6s ease-out;
	}

	@keyframes unlock-bounce {
		0% { transform: scale(0) rotate(-180deg); opacity: 0; }
		50% { transform: scale(1.2) rotate(10deg); }
		100% { transform: scale(1) rotate(0deg); opacity: 1; }
	}

	.unlock-title {
		font-size: 1.8rem;
		margin: 0;
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	body.dark-mode .unlock-title {
		background: linear-gradient(135deg, #8b9ff5 0%, #a77bc9 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	.unlock-items-container {
		width: 100%;
		display: flex;
		flex-direction: column;
		gap: 16px;
	}

	.unlock-item {
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
		border: 2px solid rgba(102, 126, 234, 0.3);
		border-radius: 12px;
		padding: 16px;
		display: flex;
		align-items: center;
		gap: 16px;
		animation: unlock-slide-in 0.4s ease-out backwards;
	}

	body.dark-mode .unlock-item {
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
		border-color: rgba(139, 159, 245, 0.4);
	}

	.unlock-item:nth-child(2) { animation-delay: 0.1s; }
	.unlock-item:nth-child(3) { animation-delay: 0.2s; }
	.unlock-item:nth-child(4) { animation-delay: 0.3s; }

	@keyframes unlock-slide-in {
		from { 
			opacity: 0; 
			transform: translateX(-30px);
		}
		to {
			opacity: 1;
			transform: translateX(0);
		}
	}

	.unlock-item-icon {
		font-size: 32px;
		flex-shrink: 0;
	}

	.unlock-item-content {
		flex: 1;
		text-align: left;
	}

	.unlock-item-name {
		font-weight: bold;
		font-size: 1.1rem;
		margin-bottom: 4px;
		color: #667eea;
	}

	body.dark-mode .unlock-item-name {
		color: #8b9ff5;
	}

	.unlock-item-description {
		font-size: 0.9rem;
		opacity: 0.8;
		margin: 0;
	}

	.unlock-item--feature {
		border-color: rgba(102, 126, 234, 0.5);
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
	}

	body.dark-mode .unlock-item--feature {
		border-color: rgba(139, 159, 245, 0.6);
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.25), rgba(118, 75, 162, 0.25));
	}

	.unlock-item--feature .unlock-item-name {
		color: #8b6dff;
	}

	body.dark-mode .unlock-item--feature .unlock-item-name {
		color: #a899ff;
	}

	.unlock-item--challenge {
		border-color: rgba(255, 99, 71, 0.4);
		background: linear-gradient(145deg, rgba(255, 99, 71, 0.1), rgba(255, 140, 0, 0.1));
	}

	body.dark-mode .unlock-item--challenge {
		border-color: rgba(255, 140, 0, 0.5);
		background: linear-gradient(145deg, rgba(255, 99, 71, 0.15), rgba(255, 140, 0, 0.15));
	}

	.unlock-item--challenge .unlock-item-name {
		color: #ff6347;
	}

	body.dark-mode .unlock-item--challenge .unlock-item-name {
		color: #ff8c69;
	}

	body.dark-mode .round-summary-card {
		background: linear-gradient(145deg, rgba(46, 54, 78, 0.9), rgba(32, 39, 58, 0.95));
		border-color: rgba(255, 255, 255, 0.08);
		box-shadow: 0 18px 28px rgba(5, 8, 16, 0.6);
	}

	body.dark-mode .round-summary-card--coins {
		background: linear-gradient(145deg, rgba(66, 52, 22, 0.82), rgba(97, 76, 36, 0.92));
	}

	.round-su