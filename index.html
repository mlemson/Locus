<!DOCTYPE html>
<html lang="nl">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta title="LOCUS Digitaal">
	<script>
		/*
			EN:
			- WHY: Apply the saved theme class as early as possible to avoid a flash of the wrong theme.
			- STATE: Reads `localStorage.theme` (and legacy `localStorage.darkMode`). Writes `dark-mode` on <html>.
			- OVERRIDE: The later DOMContentLoaded theme handler (applyTheme) is still the source of truth.
		*/
		(function preloadThemeClass() {
			try {
				var storedTheme = localStorage.getItem('theme');
				if (!storedTheme) {
					var legacy = localStorage.getItem('darkMode');
					if (legacy === 'true') storedTheme = 'dark';
				}
				if (storedTheme === 'dark') {
					document.documentElement.classList.add('dark-mode');
				}
			} catch (e) {
				// Ignore storage errors (private mode / blocked storage).
			}
		})();
	</script>
		<style>
			/*
				EN: Comment tags used throughout this file:
				- WHY: reason the code exists / design intent
				- STATE: what global state / DOM state is read or written
				- OVERRIDE: this block can be overwritten later (order-dependent)
				- DUPLICATE: a similar rule/handler exists elsewhere (risk of divergence)
				- LEGACY: kept for backwards compatibility / older UI paths
				
				Note: This is a single-file app with large CSS + JS blocks; ordering matters.
			*/

			/* === Shared defaults (desktop look from 22-10 + mobile HUD from 23-10-3) === */
			html {
				min-height: 100%;
				background: #f6f8fb;
				overflow-y: hidden;
				overflow-x: hidden;
				overscroll-behavior: contain;
				/* Prevent browser back-navigation on horizontal swipe (iOS Safari, Chrome) */
				overscroll-behavior-x: none;
			}

			body {
				margin: 0;
				position: relative;
				padding: 10px;
				min-height: 100%;
				width: 100%;
				background: #f6f8fb;
				/*
					IMPORTANT (mobile/iOS): never put emoji fonts before system UI fonts.
					Otherwise digits can render in Apple Color Emoji, which looks "weird".
					Keep emoji fonts at the end so emoji still work when needed.
				*/
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif, "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji";
				font-size: 16px;
				/*
					EN:
					- STATE: sets the page base typography + background.
					- LEGACY/BUG-PRONE: `gap`, `grid-template-columns`, `justify-content`, `align-items`
					  have no effect unless `display: grid` or `display: flex` is set on body.
					  If layout is controlled elsewhere (e.g. a `.layout` wrapper), these may be leftovers.
				*/
					gap: 10px;
				grid-template-columns: auto;
				justify-content: center;
				align-items: start;
				color: #222;
				transition: background-color 0.3s, color 0.3s;
			}

		:root {
			/* Base measurements */
			--cell-size: clamp(18px, 6vw, 26px);
			--board-grid-gap: 2px;
			--preview-gap: 2px;
			--gap: 10px;
			--radius: 10px;
			--bottom-height: 70px;
			--side-panel-width: 120px;
			--card-size: 150px;

			/* Bottom bar sizing */
			--bottom-bar-gap: 0px;
			--bottom-bar-bottom-offset: 0px;
			--card-hand-lift: 12px;

			/* Z-index scale */
			--z-bottom: 450;      /* bottom bar */
			--z-controls: 1000;   /* controls panel */
			--z-menu: 1100;       /* menu / hamburger (must stay above other UI) */
			--z-ui: 250;          /* generic UI buttons */
			--z-blur: 400;        /* blur backdrop */
			--z-zoom: 500;        /* focused/zoomed zone */
			--z-drag: 600;        /* drag overlay (highest for dragged items) */
			--z-score: 700;       /* transient score / sparkle popups */
			--z-draggable: 600;   /* draggable block default */

			/* Colors - Light mode */
			--main-bg-light: #f6f8fb;
			--panel-bg-light: #ffffff;
			--score-bg-light: rgba(255,255,255,0.9);
			--card-bg-light: #ffffff;
			--coin-color: #ffd700;
			--coin-border: #b8860b;

			/* Colors - Dark mode */
			--main-bg-dark: #1a1a1a;
			--panel-bg-dark: #2d2d2d;
			--score-bg-dark: rgba(45,45,45,0.9);
			--card-bg-dark: #2d2d2d;
		}

		* {
			box-sizing: border-box;
		}

		#drag-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100vw;
			height: 100vh;
			pointer-events: none;
			cursor: none;
			z-index: var(--z-drag);
		}

	/* Floating preview voor touch-vriendelijke kaart plaatsing */
	#floating-preview {
		position: fixed;
		/* Positie wordt dynamisch ingesteld via JS */
		width: 138px;
		min-height: 180px;
		padding: 16px;
		display: none;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: 12px;
		border-radius: 16px;
		background: linear-gradient(165deg, #ffffff 0%, #eef2ff 45%, #dfe4ff 100%);
		border: 2px solid #4a90e2;
		box-shadow: 0 18px 26px rgba(10,12,20,0.3);
		z-index: calc(var(--z-zoom) + 50);
		touch-action: none;
		cursor: grab;
		transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
		transform: scale(0.8);
		opacity: 0;
		overflow: visible;
	}		#floating-preview.dragging {
			cursor: grabbing;
			transform: scale(1.1);
			box-shadow: 0 12px 32px rgba(0,0,0,0.4);
		}

	body.dark-mode #floating-preview {
		background: linear-gradient(165deg, #2d2d2d 0%, #1f2233 45%, #1a1d2e 100%);
		border-color: #5a9fd4;
	}	#floating-preview-pattern {
		width: 100%;
		flex: 1;
		display: flex;
		align-items: center;
		justify-content: center;
		pointer-events: none;
		position: relative;
		z-index: 1;
	}		#floating-preview-rotate {
			position: absolute;
			top: 6px;
			right: 6px;
			width: 36px;
			height: 36px;
			background: #4a90e2;
			border: 2px solid white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 18px;
			color: white;
			cursor: pointer;
			touch-action: none;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			z-index: 1;
			user-select: none;
		}

		#floating-preview-rotate:active {
			transform: scale(0.95);
		}

		body.dark-mode #floating-preview-rotate {
			background: #5a9fd4;
			border-color: #1e2128;
		}

		#floating-preview-mirror {
			position: absolute;
			bottom: 6px;
			right: 6px;
			width: 36px;
			height: 36px;
			background: #9b59b6;
			border: 2px solid white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 18px;
			color: white;
			cursor: pointer;
			touch-action: none;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			z-index: 1;
			user-select: none;
		}

		#floating-preview-mirror:active {
			transform: scale(0.95);
		}

		body.dark-mode #floating-preview-mirror {
			background: #8e44ad;
			border-color: #1e2128;
		}

		#floating-preview-cancel {
			position: absolute;
			top: 6px;
			left: 6px;
			width: 36px;
			height: 36px;
			background: #e74c3c;
			border: 2px solid white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 20px;
			color: white;
			cursor: pointer;
			touch-action: none;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			z-index: calc(var(--z-zoom) + 51);
			user-select: none;
		}

		#floating-preview-cancel:active {
			transform: scale(0.95);
		}

		body.dark-mode #floating-preview-cancel {
			background: #c0392b;
			border-color: #1e2128;
		}

		/* Zoom-lens voor plaatsing preview */
		#placement-zoom-lens {
			position: fixed;
			width: 160px;
			height: 160px;
			background: rgba(255, 255, 255, 0.98);
			border: 3px solid #4a90e2;
			border-radius: 16px;
			box-shadow: 0 12px 32px rgba(0,0,0,0.5), 0 0 0 2px rgba(74, 144, 226, 0.3);
			z-index: calc(var(--z-zoom) + 1);
			pointer-events: none;
			transition: opacity 0.15s ease;
		}

		body.dark-mode #placement-zoom-lens {
			background: rgba(30, 33, 40, 0.98);
			border-color: #5a9fd4;
			box-shadow: 0 12px 32px rgba(0,0,0,0.7), 0 0 0 2px rgba(90, 159, 212, 0.3);
		}

		#zoom-lens-content {
			width: 100%;
			height: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 8px;
			overflow: hidden;
		}

		#zoom-lens-content .zoom-grid {
			display: grid;
			gap: var(--board-grid-gap, 2px);
			transform: scale(1.5);
			transform-origin: center;
		}

		#zoom-lens-content .zoom-cell {
			border-radius: 2px;
			border: 1px solid rgba(0,0,0,0.15);
		}

		body.dark-mode #zoom-lens-content .zoom-cell {
			border-color: rgba(255,255,255,0.2);
		}

		#zoom-lens-content .zoom-cell.filled {
			box-shadow: 0 2px 4px rgba(0,0,0,0.2);
		}

		#zoom-lens-content .zoom-cell.preview {
			opacity: 0.7;
			border: 2px solid rgba(74, 144, 226, 0.8);
		}

		#zoom-lens-content .zoom-cell.preview.valid {
			border-color: rgba(76, 175, 80, 0.9);
			box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
		}

		#zoom-lens-content .zoom-cell.preview.invalid {
			border-color: rgba(244, 67, 54, 0.9);
			box-shadow: 0 0 8px rgba(244, 67, 54, 0.4);
		}


		body .blur-overlay {
			pointer-events: none;
		}

		/* ============================================
		   DARK MODE - BASIS STYLING
		   ============================================
		*/
		body.dark-mode {
			background: #1b1d22;
			color: #e5e5e5;
		}

		.board {
			display: flex;
			gap: 12px; /* ruimte tussen kolommen */
			margin: 0 auto;
			touch-action: manipulation;
			position: relative;
			z-index: 1;
			transition: transform 0.25s ease;
		}

		body.board-scaled {
			overflow-y: auto;
		}

		body.board-scaled .board {
			transform-origin: top center;
		}

	.column {
		display: flex;
		flex-direction: column;
		gap: 12px; /* ruimte tussen vakken in dezelfde kolom */
		flex: 1; /* kolommen gelijk breed op mobiel */
	}
	.zone {
		/* Geen background hier - wordt per zone ingesteld */
		position: relative;
		border-radius: 10px;
		border: 1px solid #e3e6ea;
		box-shadow: 0 2px 6px rgba(0,0,0,0.12);
		box-sizing: border-box;
		padding: 10px;
		margin: 10px;
		touch-action: manipulation;
		transition: transform 0.3s ease;
		z-index: 1;
	}

	body.debug-mode .zone .cell:not(.void-cell) {
		cursor: pointer;
	}

	.red-group {
		display: flex;
		flex-wrap: wrap;
		gap: 8px;
		justify-content: center;
	}

	.red-group.zoom-focus {
		width: auto;
		min-height: 400px; /* Minimum height, niet fixed */
		height: auto; /* Laat content de height bepalen */
	}


	body.dark-mode .zone {
		border: 1px solid #2d2f36;
		box-shadow: 0 4px 10px rgba(0,0,0,0.5);
	}		.zone-placeholder {
			pointer-events: none;
			position: relative;
		}

		.blur-overlay {
			display: none;
			position: fixed;
			inset: 0;
			background: rgba(0, 0, 0, 0.4);
			backdrop-filter: blur(4px);
			-webkit-backdrop-filter: blur(4px);
			z-index: var(--z-blur);
		}

		body.zoomed-in .blur-overlay {
			display: block;
		}

		.zone.zoom-focus {
			position: fixed;
			top: 22%;
			left: 50%;
			transform: translate(-50%, -50%) scale(1.25);
			z-index: var(--z-zoom);
			box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
			margin: 2px;
			padding: 3px;
			border-radius: 6px;
		}

		/* Mobile (incl. larger phones): use the same zoom sizing as the compact (<550px) layout. */
		@media (max-width: 900px) {
			.zone.zoom-focus {
				position: fixed;
				top: 25%;
				left: 50%;
				transform: translate(-50%, -50%) scale(0.95);
				z-index: var(--z-zoom);
				box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
				margin: 2px;
				padding: 3px;
				border-radius: 6px;
			}

			/* Red zone: keep proportions in zoom, like compact mobile. */
			#red-zone.zoom-focus {
				flex-wrap: wrap !important;
				flex-direction: row !important;
				width: auto !important;
				min-width: 380px !important;
				height: auto !important;
				max-width: 90vw;
			}
		}

		@media (max-width: 650px) {
			body.zoomed-in #yellow-zone.zoom-focus,
			body.zoomed-in #blue-zone.zoom-focus {
				top: calc(22% + 50px);
			}
		}

		/* Phone landscape (short height): scale board down so everything fits.
		   Keep this limited to coarse pointers to avoid shrinking desktop windows. */
		@media (max-height: 600px) and (orientation: landscape) and (pointer: coarse) {
			:root {
				--cell-size: clamp(14px, 4.2vw, 20px);
			}
		}

		/* ===== MOBILE SIDEBAR LAYOUT =====
		   Used for both mobile landscape AND mobile portrait on phones.
		   Board center, options in slim sidebars. */
		body.mobile-sidebar-layout {
			overflow: hidden !important;
			max-height: 100vh;
			max-height: 100svh;
		}

		body.mobile-sidebar-layout,
		body.mobile-sidebar-layout html {
			overflow: hidden !important;
		}

		/* Hamburger menu in mobile sidebar layout */
		body.mobile-sidebar-layout #menu-toggle {
			position: fixed !important;
			top: 4px;
			left: 4px;
			z-index: 1100;
			width: 36px;
			height: 36px;
			display: flex !important;
		}

		body.mobile-sidebar-layout #controls {
			position: fixed;
			top: 44px;
			left: 4px;
			z-index: 1099;
			max-height: calc(100vh - 50px);
			max-height: calc(100svh - 50px);
			overflow-y: auto;
		}

		body.mobile-sidebar-layout #bottom-bar {
			display: none !important;
		}

		body.mobile-sidebar-layout #mobile-objective-banner {
			display: none !important;
		}

		/* Safety net: if the sidebar class ever lingers, never apply it in portrait. */
		@media (max-width: 650px) and (orientation: portrait) {
			body.mobile-sidebar-layout {
				overflow: auto !important;
				max-height: none;
			}
			body.mobile-sidebar-layout html {
				overflow: auto !important;
			}
			body.mobile-sidebar-layout #mobile-landscape-wrapper {
				display: none !important;
			}
			body.mobile-sidebar-layout #bottom-bar {
				display: flex !important;
			}
			body.mobile-sidebar-layout #mobile-objective-banner {
				display: flex !important;
			}
		}

		/* Mobile landscape sidebar zoom mode */
		body.mobile-sidebar-layout.zoomed-in .zone.zoom-focus {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%) scale(0.85);
			z-index: var(--z-zoom);
			box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
			margin: 0;
			padding: 6px;
			border-radius: 8px;
			max-width: 90vw;
			max-height: 85vh;
			max-height: 85svh;
			overflow: auto;
		}

		body.mobile-sidebar-layout.zoomed-in #red-zone.zoom-focus {
			display: grid !important;
			grid-template-columns: repeat(2, max-content) !important;
			width: auto;
			max-width: 95vw;
		}

		body.mobile-sidebar-layout.zoomed-in .zone-nav-arrow {
			display: flex;
		}

		body.mobile-sidebar-layout #mobile-landscape-wrapper {
			display: flex !important;
			flex-direction: row;
			align-items: stretch;
			justify-content: center;
			width: 100vw;
			height: 100vh;
			height: 100svh;
			gap: 2px;
			padding: 2px;
			padding-left: 44px; /* Room for hamburger */
			box-sizing: border-box;
			overflow: hidden;
		}

		body.mobile-sidebar-layout #ml-sidebar-left,
		body.mobile-sidebar-layout #ml-sidebar-right {
			display: flex !important;
			flex-direction: column;
			gap: 2px;
			flex: 0 0 auto;
			width: 58px;
			min-width: 50px;
			max-width: 70px;
			overflow-y: auto;
			overflow-x: hidden;
			scrollbar-width: none;
		}

		/* Landscape: slightly wider sidebars */
		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-left,
			body.mobile-sidebar-layout #ml-sidebar-right {
				width: 72px;
				min-width: 65px;
				max-width: 90px;
				gap: 3px;
			}
			
			body.mobile-sidebar-layout #mobile-landscape-wrapper {
				gap: 4px;
				padding: 4px;
			}
		}

		body.mobile-sidebar-layout #ml-sidebar-left::-webkit-scrollbar,
		body.mobile-sidebar-layout #ml-sidebar-right::-webkit-scrollbar {
			display: none;
		}

		body.mobile-sidebar-layout #ml-board-center {
			/* Don't expand to fill all remaining width: keep sidebars close to the board
			   (fixes "options too far to the sides" on phone landscape). */
			flex: 0 1 auto;
			display: flex;
			flex-direction: column;
			justify-content: flex-start;
			align-items: center;
			min-width: 0;
			overflow: hidden;
			gap: 2px;
		}

		/* Small-ish desktop landscape: slightly smaller cells so zones fit cleanly. */
		@media (min-width: 651px) and (orientation: landscape) and (max-height: 760px) {
			body.desktop-landscape {
				--cell-size: clamp(16px, 2.2vw, 23px);
			}
		}

		/* Compact objective banner in sidebar layout */
		body.mobile-sidebar-layout #ml-objective-top {
			display: flex !important;
			width: 100%;
			padding: 2px 6px;
			background: rgba(255, 251, 234, 0.95);
			border-radius: 6px;
			font-size: 0.65rem;
			text-align: center;
			justify-content: center;
			align-items: center;
			flex-shrink: 0;
		}

		body.dark-mode.mobile-sidebar-layout #ml-objective-top {
			background: rgba(34, 37, 43, 0.95);
			color: #e5e5e5;
		}

		body.mobile-sidebar-layout #ml-objective-top #objective-zone {
			min-height: auto;
			padding: 2px 8px;
			font-size: 0.6rem;
		}

		body.mobile-sidebar-layout #ml-objective-top #objective-zone h2 {
			display: none;
		}

		body.mobile-sidebar-layout #ml-board-center #board {
			transform-origin: top center;
		}

		/* Mobile sidebar styling */
		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard,
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone,
		body.mobile-sidebar-layout #ml-sidebar-right #bonus-zone {
			padding: 3px 4px;
			font-size: 0.6rem;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard h2,
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone h2,
		body.mobile-sidebar-layout #ml-sidebar-right #bonus-zone h2 {
			display: none;
		}

		/* Gold zone in left sidebar */
		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone {
			display: flex !important;
			flex-direction: column;
			align-items: center;
			gap: 2px;
			padding: 4px;
			background: rgba(255, 215, 0, 0.15);
			border-radius: 6px;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone::after {
			content: 'ðŸª™ ' attr(data-coin-text);
			display: block;
			font-size: 0.6rem;
			font-weight: 700;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone .buy-placement-btn {
			padding: 3px 5px;
			font-size: 0.45rem;
			display: block !important;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #gold-zone #collected-coins {
			display: none !important;
		}

		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-left #gold-zone::after {
				font-size: 0.6rem;
			}

			body.mobile-sidebar-layout #ml-sidebar-left #gold-zone .buy-placement-btn {
				padding: 3px 5px;
				font-size: 0.45rem;
			}
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-row {
			padding: 1px 2px;
			font-size: 0.55rem;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-row .label {
			display: none;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-row .color-box {
			width: 8px;
			height: 8px;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-total {
			font-size: 0.7rem;
			padding: 2px;
		}

		body.mobile-sidebar-layout #ml-sidebar-left #scoreboard .score-total .label {
			display: none;
		}

		body.mobile-sidebar-layout .bonus-inventory {
			flex-direction: column;
			gap: 1px;
		}

		body.mobile-sidebar-layout .bonus-badge {
			padding: 2px 4px;
			font-size: 0.5rem;
		}

		body.mobile-sidebar-layout .bonus-count {
			font-size: 0.45rem;
			padding: 1px 3px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right #card-choice-zone {
			padding: 3px;
			display: flex;
			flex-direction: column;
			gap: 4px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right #card-choice-zone h2,
		body.mobile-sidebar-layout #ml-sidebar-right #kiesKaartTitel,
		body.mobile-sidebar-layout #ml-sidebar-right #card-choice-zone br {
			display: none !important;
		}

		body.mobile-sidebar-layout #ml-sidebar-right #card-options {
			flex-direction: column;
			gap: 3px;
			order: 1;
		}

		/* Action buttons below cards */
		body.mobile-sidebar-layout #ml-sidebar-right #card-action-buttons {
			order: 2;
			flex-direction: row;
			flex-wrap: wrap;
			justify-content: center;
			gap: 3px;
			margin-top: 4px;
			padding-top: 4px;
			border-top: 1px solid rgba(0,0,0,0.1);
		}

		/* Portrait: smaller cards */
		body.mobile-sidebar-layout #ml-sidebar-right .card-option {
			width: 44px;
			min-height: 50px;
			padding: 2px;
			--preview-cell: 6px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-option .card-cell {
			width: 6px;
			height: 6px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-label {
			font-size: 0.4rem;
			padding: 1px 2px;
		}

		/* Landscape: allow slightly larger cards */
		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-right .card-option {
				width: 58px;
				min-height: 70px;
				padding: 4px;
				--preview-cell: 10px;
			}

			body.mobile-sidebar-layout #ml-sidebar-right .card-option .card-cell {
				width: 9px;
				height: 9px;
			}

			body.mobile-sidebar-layout #ml-sidebar-right .card-label {
				font-size: 0.5rem;
				padding: 2px 4px;
			}
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn {
			width: 22px;
			height: 22px;
			min-width: 22px;
			padding: 2px;
		}

		body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn::before {
			font-size: 0.65rem;
		}

		/* Landscape: larger action buttons */
		@media (orientation: landscape) {
			body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn {
				width: 24px;
				height: 24px;
				min-width: 24px;
				padding: 3px;
			}

			body.mobile-sidebar-layout #ml-sidebar-right .card-action-btn::before {
				font-size: 0.7rem;
			}
		}
		
		.zone.portal-active {
			box-shadow: 0 0 12px 4px rgba(100, 200, 255, 0.6);
			animation: portalPulse 2s ease-in-out infinite;
		}
		
		@keyframes portalPulse {
			0%, 100% { box-shadow: 0 0 12px 4px rgba(100, 200, 255, 0.6); }
			50% { box-shadow: 0 0 20px 6px rgba(150, 220, 255, 0.8); }
		}

		/* Blue zone scroll - lang uitgezoomd, kort ingezoomd */


		#blue-zone.zoom-focus {
			/* Keep the zoomed blue zone ~2/3 of the viewport height. */
			max-height: 66vh;
			overflow-y: auto;
			overflow-x: hidden;
			/* Keep blue scrollable but hide the scrollbar visuals (no "scroll wheel"). */
			scrollbar-width: none; /* Firefox */
			-ms-overflow-style: none; /* IE/Edge legacy */
		}
		#blue-zone.zoom-focus::-webkit-scrollbar {
			width: 0;
			height: 0;
			display: none;
		}

		/*
		#red-zone {
			width: 430px;
		}
			*/

		#original-card-zone {
			width: 430px;
		}

		/* Zone navigation arrows */
		.zone-nav-arrow {
			position: fixed;
			top: 50%;
			transform: translateY(-50%);
			z-index: calc(var(--z-zoom) + 1);
			background: rgba(255, 255, 255, 0.9);
			border: 2px solid rgba(40, 55, 120, 0.3);
			border-radius: 50%;
			width: 48px;
			height: 48px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 24px;
			cursor: pointer;
			transition: all 0.2s ease;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
			user-select: none;
		}

		.zone-nav-arrow:hover {
			background: rgba(255, 255, 255, 1);
			transform: translateY(-50%) scale(1.1);
			box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
		}

		.zone-nav-arrow:active {
			transform: translateY(-50%) scale(0.95);
		}

		.zone-nav-arrow-left {
			left: 20px;
		}

		.zone-nav-arrow-right {
			right: 20px;
		}

		body.dark-mode .zone-nav-arrow {
			background: rgba(30, 35, 50, 0.9);
			border-color: rgba(140, 150, 200, 0.4);
			color: rgba(240, 242, 255, 0.9);
		}

		body.dark-mode .zone-nav-arrow:hover {
			background: rgba(40, 45, 60, 1);
		}

		/* === Mobile scaling tweaks (<=650px) === */

	/* ============================================
	   CARD CHOICE ZONE - ADDITIONAL FEATURES
	   ============================================
	   Golden cards and selection disabled states
	*/
	.card-option.card-golden {
		position: relative;
		overflow: hidden;
		background: linear-gradient(135deg, #fff9e6 0%, #ffe082 30%, #f6c84a 60%, #c78c1f 100%);
		border: 1px solid rgba(220,180,60,0.9);
		box-shadow: 0 28px 56px rgba(184,120,18,0.45), inset 0 1px 0 rgba(255,255,255,0.6);
	}

	@keyframes goldenCardShine {
		0% { transform: translateX(-70%) rotate(20deg); }
		100% { transform: translateX(70%) rotate(20deg); }
	}

	/* Subtle shine over the golden frame (does not affect the block colors). */
	.card-option.card-golden::before {
		content: '';
		position: absolute;
		top: -40%;
		left: -40%;
		width: 180%;
		height: 180%;
		background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.55) 45%, rgba(255,255,255,0) 70%);
		opacity: 0.22;
		pointer-events: none;
		transform: translateX(-70%) rotate(20deg);
		animation: goldenCardShine 3.2s linear infinite;
		z-index: 1;
	}

	.card-option.card-golden .card-pattern,
	.card-option.card-golden .card-label,
	.card-option.card-golden .card-meta {
		position: relative;
		z-index: 2;
	}

	.card-option.card-golden::after {
		background: linear-gradient(120deg, rgba(255,255,255,0.95), rgba(255,255,255,0) 60%);
		opacity: 0.72;
		mix-blend-mode: overlay;
	}

	.card-option.card-golden .card-label {
		background: rgba(120,80,0,0.1);
		color: #7c4d00;
	}

	#card-choice-zone .card-option.selection-disabled {
		opacity: 0.45;
		pointer-events: none;
		filter: grayscale(0.25);
	}

	body.dark-mode .card-option.card-golden {
		background: linear-gradient(135deg, #5b4a14 0%, #8a6a1c 35%, #bf952a 70%, #e3c45e 100%);
		border: 1px solid rgba(200,160,30,0.8);
		box-shadow: 0 28px 52px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.08);
	}

	body.dark-mode .card-option.card-golden::before {
		opacity: 0.18;
	}

	body.dark-mode .card-option.card-golden .card-label {
		background: rgba(255,220,120,0.12);
		color: #ffe79a;
	}

	/*
		#card-choice-zone defines its own (more specific) `.card-option` background later.
		These overrides ensure golden styling remains visible inside the card-choice UI.
	*/
	#card-choice-zone .card-option.card-golden {
		background: linear-gradient(135deg, #fff9e6 0%, #ffe082 30%, #f6c84a 60%, #c78c1f 100%);
		border: 1px solid rgba(220,180,60,0.9);
		box-shadow: 0 28px 56px rgba(184,120,18,0.45), inset 0 1px 0 rgba(255,255,255,0.6);
	}

	body.dark-mode #card-choice-zone .card-option.card-golden {
		background: linear-gradient(135deg, #5b4a14 0%, #8a6a1c 35%, #bf952a 70%, #e3c45e 100%);
		border: 1px solid rgba(200,160,30,0.8);
		box-shadow: 0 28px 52px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.08);
	}

	body.dark-mode #card-choice-zone .card-option.selection-disabled {
		opacity: 0.32;
		filter: grayscale(0.4);
	}

	/* Deck kopie kaart (extraHandSize upgrade) */
	#card-choice-zone .card-option.card-deck-copy {
		position: relative;
		border: 2px dashed rgba(100, 140, 255, 0.6);
	}
	#card-choice-zone .card-option.card-deck-copy::before {
		content: 'ðŸ“‹';
		position: absolute;
		top: -8px;
		right: -8px;
		font-size: 16px;
		background: #fff;
		border-radius: 50%;
		padding: 2px;
		box-shadow: 0 2px 6px rgba(0,0,0,0.2);
		z-index: 10;
	}
	body.dark-mode #card-choice-zone .card-option.card-deck-copy {
		border-color: rgba(140, 180, 255, 0.5);
	}
	body.dark-mode #card-choice-zone .card-option.card-deck-copy::before {
		background: #2a2a3a;
	}

	/* Lucky draw kopie kaart */
	#card-choice-zone .card-option.card-lucky-copy {
		position: relative;
		border: 2px dashed rgba(80, 200, 80, 0.6);
	}
	#card-choice-zone .card-option.card-lucky-copy::before {
		content: 'ðŸ€';
		position: absolute;
		top: -8px;
		right: -8px;
		font-size: 16px;
		background: #fff;
		border-radius: 50%;
		padding: 2px;
		box-shadow: 0 2px 6px rgba(0,0,0,0.2);
		z-index: 10;
	}
	body.dark-mode #card-choice-zone .card-option.card-lucky-copy {
		border-color: rgba(120, 220, 120, 0.5);
	}
	body.dark-mode #card-choice-zone .card-option.card-lucky-copy::before {
		background: #2a2a3a;
	}

	/*
		EN:
		- DUPLICATE/OVERRIDE: There are many `@media (max-width: 650px)` blocks in this file.
		  They stack and later rules win, so the *order* in this CSS file is part of the behavior.
		- TIP: If something "randomly" changes on mobile, search for the same selector in later @media blocks.
	*/
	@media (max-width: 650px) {


	#bottom-bar {
		padding-left: 5px;
		padding-right: 5px;
	}

	  #bottom-bar-score,
	  #bottom-bar-coins {
		flex: 0 0 50%;
		min-width: 0;
	  }

	  #bottom-bar #scoreboard,
	  #bottom-bar #gold-zone {
		width: 100%;
		padding: 6px 10px;
		box-sizing: border-box;
	  }

	  #bottom-bar #gold-zone {
		min-width: 0;
	  }

	  #bottom-bar #new-cards-btn {
		height: 48px;
		padding: 8px 12px;
		font-size: 0.76rem;
	  }

	  #bottom-bar #rotate-card-btn {
		height: 44px;
		padding: 7px 12px;
		font-size: 0.7rem;
		margin-top: 8px;
		width: 104px;
	  }

	  #bottom-bar #card-options .card-option {
		max-width: 110px;
	  }
	}

	@media (max-width: 650px) {
	  .bottom-bar-footer {
		display: flex;
		flex-direction: column;
		align-items: stretch;
		gap: 2px;
		justify-content: flex-start;
		margin-top: 10px;
	  }

	  #bottom-bar-left {
		display: flex;
		flex-direction: column;
		flex-wrap: nowrap;
		gap: 4px;
		flex: 1 1 auto;
		min-width: 0;
		align-items: stretch;
	  }

	  #bottom-bar-bonus {
		order: 2;
		flex: 0 0 auto;
		display: flex;
		flex-direction: column;
		align-items: stretch;
		justify-content: flex-start;
		gap: 8px;
	  }

	  #bottom-bar-score-coins {
		display: flex;
		flex-direction: row;
		gap: 4px;
		align-items: center;
		order: 3;
		flex: 1 1 auto;
		min-width: 0;
	  }

	  #bottom-bar-score {
		flex: 1 1 auto;
		min-width: 0;
	  }

	  #bottom-bar-coins {
		display: none !important;
	  }

	  #bottom-bar #scoreboard,
	  #bottom-bar #gold-zone {
		width: 100%;
		box-sizing: border-box;
		height: auto;
	  }

	  #bottom-bar #bonus-zone {
		width: auto;
		flex: 1 1 auto;
		min-width: 0;
		padding: 6px 8px;
	  }

	  /* Place the coin panel next to the bonus inventory. */
	  #bottom-bar-bonus #gold-zone {
		width: 100% !important;
		flex: 0 0 auto;
		padding: 3px 6px;
		margin: 0;
		display: flex;
		flex-direction: column;
		align-items: stretch;
		justify-content: flex-start;
		gap: 4px;
	  }
	  #bottom-bar-bonus #gold-zone .buy-placement-btn {
		margin-left: 0;
	  }
	  

	#bottom-bar #collected-coins {
		grid-template-rows: repeat(3, 12px);
		grid-auto-columns: 12px;
		column-gap: 4px;
		row-gap: 4px;
	}
	}


	@media (max-width: 650px) {
		:root {
			--bottom-bar-height: 140px;
			--bottom-bar-gap: 4px;
			--bottom-bar-bottom-offset: -16px;
			--card-hand-lift: 0px;
			--hand-card-width: 52px;
			--hand-card-gap: 4px;
			--hand-card-height: 78px;
		}

		#bottom-bar {
			padding-left: 5px;
			padding-right: 5px;
			margin-bottom: 5px;
		}

		#bottom-bar #scoreboard,
		#bottom-bar #gold-zone {
			padding: 6px 8px;
		}

		#bottom-bar #gold-zone {
			min-width: 0;
			gap: 9px;
		}

		#bottom-bar #card-options {
			padding-left: 0;
			padding-right: 0;
			touch-action: none;
			overflow-y: hidden;
		}

	  #bonus-zone .bonus-hint {
		display: none;
	  }

	  #bottom-bar #scoreboard {
		--score-chip-gap: 3px;
	  }
	  
	  /* Hide desktop bonus-zone on mobile (it's in bottom-bar) */
	  #original-bonus-zone {
		display: none;
	  }

	  #bottom-bar #scoreboard .score-row {
		font-size: 0.62rem;
		padding: 2px 4px;
	  }

	  #bottom-bar #scoreboard .score-row .color-box {
		width: 8px;
		height: 8px;
	  }

	  #bottom-bar #scoreboard .score-row .score {
		font-size: 0.66rem;
	  }

	  #bottom-bar #scoreboard .score-total {
		font-size: 0.68rem;
	  }

	  #bottom-bar #scoreboard .score-total .total-score {
		font-size: 0.78rem;
	  }

	  #bottom-bar #scoreboard .score-total .label {
		font-size: 0.64rem;
	  }

	#bottom-bar #card-choice-zone .card-option {
		width: 98px;
		min-height: 18px;
		gap: 9px;
	}

	  #bottom-bar #new-cards-btn {
		height: 36px;
		padding: 6px 11px;
		font-size: 0.66rem;
	  }

	  #bottom-bar #rotate-card-btn {
		height: 34px;
		padding: 6px 10px;
		font-size: 0.62rem;
		width: 102px;
		margin-top: 6px;
	  }

	#bottom-bar #collected-coins {
		grid-template-rows: repeat(3, 12px);
		grid-auto-columns: 12px;
		column-gap: 4px;
		row-gap: 4px;
	}

	#bottom-bar .coin {
		width: 12px;
		height: 12px;
	}
	}

	@media (max-width: 520px) {
	  :root {
		--bottom-bar-height: 120px;
		--bottom-bar-gap: 4px;
		--card-hand-lift: 0px;
		--hand-card-width: 56px;
		--hand-card-gap: 4px;
		--hand-card-height: 70px;
	  }

	  #bottom-bar {
		padding-left: 4px;
		padding-right: 4px;
		padding-bottom: 4px;
	  }

	  #bottom-bar-cards {
		margin-top: 0;
		height: 80px;
	  }

	  #bottom-bar #card-options {
		display: flex;
		gap: 4px;
		align-items: stretch;
		justify-content: flex-start;
		flex-wrap: nowrap;
		scroll-snap-type: x proximity;
		flex: 1 1 auto;
		min-width: 0;
		width: auto;
		max-width: 100%;
		transform: translateY(0px);
		padding: 0 0 8px 0;
		touch-action: pan-x;
		overflow-x: auto;
		overflow-y: hidden;
		scrollbar-width: thin;
		scrollbar-color: rgba(255,255,255,0.3) transparent;
	  }
	  
	  #bottom-bar #card-options::-webkit-scrollbar {
		height: 4px;
	  }
	  #bottom-bar #card-options::-webkit-scrollbar-track {
		background: transparent;
		border-radius: 2px;
	  }
	  #bottom-bar #card-options::-webkit-scrollbar-thumb {
		background: linear-gradient(90deg, rgba(255,255,255,0.25), rgba(200,210,255,0.35));
		border-radius: 2px;
	  }
	  #bottom-bar #card-options::-webkit-scrollbar-thumb:hover {
		background: linear-gradient(90deg, rgba(255,255,255,0.4), rgba(200,210,255,0.5));
	  }

	  #bottom-bar #card-choice-zone .card-option {
		width: var(--hand-card-width);
		min-height: 80px;
		padding: 3px 4px 5px;
		gap: 2px;
	  }

	  #bottom-bar #card-choice-zone .card-option .card-cell {
		width: 8px;
		height: 8px;
	  }

	  #bottom-bar #card-choice-zone .card-option .card-pattern {
		gap: var(--preview-gap);
	  }

	  #bottom-bar #card-choice-zone .card-option .card-label {
		font-size: 0.52rem;
		padding: 1px 4px;
		gap: 1px;
	  }

	  #bottom-bar #card-choice-zone .card-option .card-label .label-dot {
		width: 5px;
		height: 5px;
	  }

	  #bottom-bar #new-cards-btn,
	  #bottom-bar #rotate-card-btn {
		width: 40px;
		height: 40px;
	  }

	  #bottom-bar #new-cards-btn::before {
		font-size: 1.6rem;
	  }

	  #bottom-bar #rotate-card-btn::before {
		font-size: 1.4rem;
	  }

	  .deck-count {
		padding: 5px 10px;
		font-size: 0.9rem;
		min-width: 45px;
		gap: 5px;
		border-radius: 9px;
	  }

	  .deck-count::before {
		font-size: 1rem;
	  }


	  #bottom-bar-left {
		gap: 3px;
	  }

	  .bottom-bar-footer {
		padding: 2px 3px 0;
	  }
	}


	@media (max-width: 650px) {
		:root {
			/* Use 0.5 for pixel-perfect scaling: 2px gaps become clean 1px after scaling */
			--board-scale: 0.5;
		}

		/* Classic mode (mobile): show ONLY the board + hamburger menu. */
		body.classic-mode #bottom-bar,
		body.classic-mode #card-choice-zone,
		body.classic-mode #bonus-zone,
		body.classic-mode #scoreboard,
		body.classic-mode #objective-zone,
		body.classic-mode #mobile-objective-banner,
		body.classic-mode #buy-placement-container,
		body.classic-mode #original-coins-zone,
		body.classic-mode #gold-zone,
		body.classic-mode #dark-mode-toggle,
		body.classic-mode .zone-info-btn,
		body.classic-mode .zone-info-popover {
			display: none !important;
		}

		/* Classic mode: don't scale down; board should fill the screen. */
		body.classic-mode {
			--board-scale: 1;
		}

		/* Hide the legacy UI column so the board uses the full width. */
		body.classic-mode #board > .column:last-child {
			display: none !important;
		}

		#original-card-zone {
			width: auto;
			max-width: 100%;
		}

		.board {
			gap: 2px;
			margin: 0;
			padding: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		/* Bottom bar: make the 3 hand cards visibly smaller (â‰ˆ25%), while keeping cell-size identical to the board. */
		#bottom-bar #card-choice-zone .card-option {
			width: var(--hand-card-width);
			min-height: var(--hand-card-height);
			padding: 3px 4px;
			gap: 2px;
			justify-content: flex-start;
		}
		#bottom-bar #card-choice-zone .card-pattern {
			gap: var(--preview-gap);
		}
		#bottom-bar #card-choice-zone .card-label {
			font-size: 0.52rem;
			padding: 1px 4px;
			gap: 3px;
		}
		#bottom-bar #card-choice-zone .card-meta {
			font-size: 0.6rem;
		}

		/* Red zone sub-grids: center the grid inside each quadrant (also when NOT zoomed). */
		#red-zone.red-group > .zone {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		#red-zone.red-group .grid {
			margin: 0;
		}

		/* Zones compacter maken voor betere fit */
		/* Green grid (lichtgroene binnenste area) beperken (niet tijdens zoom) */
		body:not(.zoomed-in) #green-grid {
			min-width: calc(15 * var(--cell-size)) !important;
			max-width: calc(15 * var(--cell-size) + 20px) !important;
		}
		/* Zoomed-in: groen mag breder (2Ã—) zodat niets afkapt */
		body.zoomed-in #green-grid {
			min-width: calc(30 * var(--cell-size)) !important;
			max-width: calc(30 * var(--cell-size) + 20px) !important;
		}

		/* Mobile: blue is vertically long by design; keep it scrollable but not a giant strip. */
		body:not(.zoomed-in) #blue-zone,
		#blue-zone--placeholder {
			overflow: auto;
		}

		/* World 2: verberg de (witte) scrollbar in de blauwe zone (blijft wel scrollbaar) */
		#blue-zone {
			scrollbar-width: none;
			-ms-overflow-style: none;
		}
		#blue-zone::-webkit-scrollbar {
			width: 0;
			height: 0;
			display: none;
		}

		/* Blue zone met scroll in zoom voor kaarten zichtbaarheid */
		#blue-zone.zoom-focus {
			max-height: 66vh;
			overflow-y: auto;
			scrollbar-width: none;
			-ms-overflow-style: none;
		}
		#blue-zone.zoom-focus::-webkit-scrollbar {
			width: 0;
			height: 0;
			display: none;
		}
		
	}

	@media (max-width: 600px) {
			:root { --bottom-bar-height: 211px; }
		.board {
			gap: 3px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		/* Green grid (lichtgroene binnenste area) beperken (niet tijdens zoom) */
		body:not(.zoomed-in) #green-grid {
			min-width: calc(15 * var(--cell-size)) !important;
			max-width: calc(15 * var(--cell-size) + 20px) !important;
		}
		/* Zoomed-in: groen mag breder (2Ã—) zodat niets afkapt */
		body.zoomed-in #green-grid {
			min-width: calc(30 * var(--cell-size)) !important;
			max-width: calc(30 * var(--cell-size) + 20px) !important;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}

		/* Actieve zone komt BOVEN de blur - behoud aspect ratio */
		.zone.zoom-focus {
		  position: fixed;
		  top: 32%;
		  left: 50%;
		  transform: translate(-50%, -50%) scale(0.95);
		  z-index: var(--z-zoom);
		  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
		  margin: 2px;
		  padding: 3px;
		  border-radius: 6px;
		}

		/* Green zone zoom-focus specifiek */
		#green-zone.zoom-focus {
		  margin: 2px;
		  padding: 3px;
		  border-radius: 6px;
		}

		/* Red zone: behoud originele verhoudingen bij zoom */
		#red-zone.zoom-focus {
		  flex-wrap: wrap !important;
		  flex-direction: row !important;
		  width: auto !important;
		  min-width: 380px !important;
		  height: auto !important;
		  max-width: 90vw;
		}
		
	}
	
	@media (max-width: 550px) {
			:root { --bottom-bar-height: 196px; }
		.board {
			gap: 3px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}

		/* Actieve zone komt BOVEN de blur */
		.zone.zoom-focus {
		  position: fixed;
		  top: 35%;
		  left: 50%;
		  transform: translate(-50%, -50%) scale(0.95);
		  z-index: var(--z-zoom);
		  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
		}

		/* Red zone: behoud originele verhoudingen bij zoom */
		#red-zone.zoom-focus {
		  flex-wrap: wrap !important;
		  flex-direction: row !important;
		  width: auto !important;
		  min-width: 380px !important;
		  height: auto !important;
		  max-width: 90vw;
		}
	
	}
	  
	@media (max-width: 510px) {
	
		.board {
			gap: 3px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
	
	}

	@media (max-width: 490px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}


		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
		
		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.95);
			max-height: 80vh;
			overflow: hidden;
		}
		#blue-zone.zoom-focus {
			overflow-y: auto;
		}



		.bottom-bar-footer {
			margin-top: 0px;
			padding-top: 0px;
		}
	
	}

	@media (max-width: 450px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
		
		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.95);
			max-height: 80vh;
			overflow: hidden;
		}
		#blue-zone.zoom-focus {
			overflow-y: auto;
		}



		.bottom-bar-footer {
			margin-top: 0px;
			padding-top: 0px;
		}
	
	}

	@media (max-width: 430px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
			padding: 0;
		}

		#blue-zone.zoom-focus {
			max-height: 66vh;
		}
		
		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.95);
			max-height: 80vh;
			overflow: hidden;
		}
		#blue-zone.zoom-focus {
			overflow-y: auto;
		}


		.bottom-bar-footer {
			margin-top: 0px;
			padding-top: 0px;
		}
	
	}

	@media (max-width: 410px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.93);
		}


	}
	
	@media (max-width: 390px) {
	
		:root {
			--bottom-bar-height: 175px;
		}
	
		.board {
			gap: 2px;
			transform-origin: top left;
			transition: transform 0.4s ease;	
			left: 50%;
			transform: translateX(-50%) scale(var(--board-scale, 0.5));
			max-height: none;
		}

		.zone.zoom-focus {
			transform: translate(-50%, -50%) scale(0.60);
		}

	
	}

	/* ============================================
	   ZONE HEADERS
	   ============================================
	   H2 titels die bovenaan elke zone verschijnen (bijv. "Geel vak", "Blauw vak")
	   Dark mode krijgt lichtere grijstint voor betere leesbaarheid
	*/
	h2 { color: #555; margin:0 0 8px; font-size:1rem; text-align:center }
	body.dark-mode h2 { color: #b0b0b0; }

	/* ============================================
	   ZONE KLEUREN & AFMETINGEN
	   ============================================
	   Elk speelvak (zone) krijgt zijn eigen kleur, breedte en hoogte
	   Placeholder varianten zijn voor drag-and-drop preview
	   Dark mode krijgt donkere gradient overlays (zie verderop)
	*/
	#yellow-zone,
	#yellow-zone--placeholder { background:#f0dc7d; height: 450px; min-width: 300px; padding: 14px; }
	/* Yellow (World 2): keep the generated grid visually centered (equal top/bottom spacing). */
	#yellow-zone,
	#yellow-zone--placeholder {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
	}
	#green-zone,
	#green-zone--placeholder { background:#a8d5a2; }
	/* Green (World 2 request): hide scrollbar visuals while keeping scroll. */
	#green-zone {
		scrollbar-width: none; /* Firefox */
		-ms-overflow-style: none; /* IE/Edge legacy */
	}
	#green-zone::-webkit-scrollbar {
		width: 0;
		height: 0;
		display: none;
	}
	#green-zone {
		cursor: grab;
	}
	#green-zone.drag-scroll-active {
		cursor: grabbing;
	}
	/* World 1: disable scrolling in green zone */
	#green-zone.no-scroll {
		overflow: hidden !important;
		cursor: default !important;
	}
	#green-zone.no-scroll.drag-scroll-active {
		cursor: default !important;
	}

	/* Desktop: beperk groene en rode zone breedte */
	@media (min-width: 651px) {
		#green-zone,
		#green-zone--placeholder {
			width: calc(13 * var(--cell-size) + 80px);
			max-width: calc(13 * var(--cell-size) + 80px);
		}
		#green-grid {
			max-width: calc(13 * var(--cell-size) + 40px);
		}
		/* Red zone should match the green zone width (user request). */
		#red-zone,
		#red-zone--placeholder {
			width: calc(13 * var(--cell-size) + 80px);
			max-width: calc(13 * var(--cell-size) + 80px);
			margin: 0;
		}
	}

	#yellow-zone,
	#yellow-zone--placeholder,
	#purple-zone,
	#purple-zone--placeholder {
		overflow: hidden;
	}
	#purple-zone,
	#purple-zone--placeholder { background:#a48dcc; height: 310px;  }
	#blue-zone,
	#blue-zone--placeholder { background:#6ba8d8; width: 180px; height: 791px; }

	/* Blue (World 2): keep scroll but hide the (white) scrollbar visuals on desktop too. */
	#blue-zone {
		overflow-y: auto;
		overflow-x: auto;
		scrollbar-width: none; /* Firefox */
		-ms-overflow-style: none; /* IE/Edge legacy */
	}
	#blue-zone::-webkit-scrollbar {
		width: 0;
		height: 0;
		display: none;
	}
	#blue-zone #blue-grid {
		scrollbar-width: none;
		-ms-overflow-style: none;
	}
	#blue-zone #blue-grid::-webkit-scrollbar {
		width: 0;
		height: 0;
		display: none;
	}
	#gold-zone,
	#gold-zone--placeholder { background:#fffbea; height: 100px; width: 280px; box-shadow: 0 0 8px rgba(0,0,0,0.4); }
	#red-zone,
	#red-zone--placeholder { background:#de838c; height: auto; min-height: 323px;  margin: 15px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.12);
	  box-sizing: border-box; padding: 10px; touch-action: manipulation; overflow: visible; }
	#red-zone.red-group {
		display: grid;
		grid-template-columns: repeat(2, max-content);
		justify-content: center;
		gap: 18px;
	}
	#red-zone.red-group > .zone {
		margin: 0 !important;
	}
	  
	#red-grid1,
	#red-grid1--placeholder { background:#de838c; margin: 15px; border-radius: 0; border:0; box-shadow: none !important; }
	#red-grid2,
	#red-grid2--placeholder { background:#de838c; margin: 15px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid3,
	#red-grid3--placeholder { background:#de838c; margin: 15px; border-radius: 0; border:0; box-shadow: none; }
	#red-grid4,
	#red-grid4--placeholder { background:#de838c; margin: 15px; border-radius: 0; border:0; box-shadow: none; }
	@media (min-width: 651px) {
		#red-zone.red-group #red-grid1,
		#red-zone.red-group #red-grid2,
		#red-zone.red-group #red-grid3,
		#red-zone.red-group #red-grid4 {
			margin: 0 !important;
		}
	}

	/* DARK MODE: Override zone kleuren met donkere gradient */

	body.dark-mode #gold-zone--placeholder { 
		background: linear-gradient(145deg, #2d2920, #232119);
		border: 1px solid #3d3930;
	}
	

	/* ============================================
	   CEL KLEUREN PER ZONE
	   ============================================
	   Elke zone heeft cellen met hun eigen kleur schema
	   .cell = standaard (niet ingevuld)
	   .cell.active = ingevuld/actief (donkerder kleur)
	   .end-cell = speciale eindcel in groen vak
	*/
	#yellow-zone .cell,
	#yellow-zone--placeholder .cell { background: #fff3b0; color: #3e2f00; border-color: #fffba8; }
	#red-zone .cell,
	#red-zone--placeholder .cell { background: #ffd6d1; color: #4b0000; border-color: #ff7b73; }
	#purple-zone .cell,
	#purple-zone--placeholder .cell { background: #f3e8fa; border-color: #e6a8ff; }
	#green-zone .cell,
	#green-zone--placeholder .cell { background: #d6f5d6; color: #003300; border-color: #c1ffa8; } 
	#green-zone .cell.end-cell,
	#green-zone--placeholder .cell.end-cell {background-color: #7bba7b !important; border-color: #7bb57f; } 
	#blue-zone .cell,
	#blue-zone--placeholder .cell { background: #d6eaff; color: #001f3f; border-color: #a8d8ff; }
	#yellow-zone .cell.active,
	#yellow-zone--placeholder .cell.active { background: #cfba51; border-color: #f7dc54; } 
	#red-zone .cell.active,
	#red-zone--placeholder .cell.active { background: #b56069; border-color: #ff7b73; }
	#purple-zone .cell.active,
	#purple-zone--placeholder .cell.active { background: #8f76b8; color: #33004b; border-color: #e6a8ff; }
	#green-zone .cell.active,
	#green-zone--placeholder .cell.active { background: #92c28c; border-color: #c1ffa8; }
	#green-zone .cell.end-cell.active,
	#green-zone--placeholder .cell.end-cell.active {background-color: #5da35d !important; border-color: #518755; } 
	#blue-zone .cell.active,
	#blue-zone--placeholder .cell.active { background: #5689b0; border-color: #a8d8ff; }

	/* ============================================
	   COIN SYMBOL STYLING
	   ============================================
	   Gebruik Segoe UI Symbol / Apple Color Emoji voor coin emoji
	   zodat het correct wordt weergegeven in alle browsers
	*/
	.coin-symbol {
		font-family: "Segoe UI Symbol", "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", Arial, sans-serif;
	}
	
	/* Algemene emoji ondersteuning voor toast berichten, feedback, etc. */
	.toast-message,
	.blackhole-feedback,
	.blackhole-subtext,
	.objective-toast,
	.modal-score-summary,
	.round-summary-icon,
	.card-label,
	[class*="feedback"],
	[class*="toast"] {
		font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif, "Segoe UI Symbol", "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji";
	}
	
	/* ============================================
	   GRID LAYOUT BASIS
	   ============================================
	   Basisstijl voor alle grid containers binnen zones
	   Gebruikt CSS Grid voor automatische cel positionering
	*/
	.grid { display: grid; gap: var(--board-grid-gap, 2px); justify-content: center; margin: 20px; }
	/* Yellow (World 2): remove inner grid margin so spacing stays even and not clipped. */
	#yellow-zone #yellow-grid.grid,
	#yellow-zone--placeholder #yellow-grid.grid {
		margin: 0;
	}
	/* Purple: match Yellow centering (no inner grid margin). */
	#purple-zone #purple-grid.grid,
	#purple-zone--placeholder #purple-grid.grid {
		margin: 0;
	}
	/* Green: remove inner margin so the darker outer rim disappears. */
	#green-zone #green-grid {
		margin: 0;
		background: transparent;
	}
	
	/* ============================================
	   CEL STIJLEN - BASIS
	   ============================================
	   De individuele cellen in elk speelvak
	   .edge-cell = rode gloed voor rand-cellen (in rood vak)
	   .bold-cell = dikke zwarte rand
	   .end-cell = groene eindcel
	   .active = ingevuld met animatie
	   .gold-cell = heeft gouden muntje symbool
	*/
	.cell.edge-cell {
	  border: 2px solid rgba(255,80,80,0.95);
	  box-shadow: 0 0 10px 3px rgba(255,80,80,0.45);
	  z-index: 6; /* op de root-cellen liggen */
	  transition: box-shadow 0.18s ease, border 0.18s ease;
	}
	.cell{
	  width: var(--cell-size);
	  height: var(--cell-size);
	  background: #f9fafc;      
	  color: #222;
	  border: 1px solid #d8dee9;
	  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
	  border-radius: calc(var(--cell-size) / 4);
	  position:relative;
	  user-select:none;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  transition: background 0.25s, transform 0.15s;
	  animation: growRoot 0.3s forwards;
	}

	/* Green root cells are absolutely positioned; shrink + center them to create visible spacing. */
	#green-grid .root-cell:not(.void-cell) {
		width: calc(var(--cell-size) - 2px);
		height: calc(var(--cell-size) - 2px);
		transform: translate(1px, 1px);
	}



	/* WORLD 2 (Yellow): Alternate diagonal shading so players see the diagonal-row rule.
	   Keep it subtle and do NOT affect active/void cells. */
	#yellow-grid .cell.diag-shade-odd:not(.void-cell):not(.active) {
	  filter: brightness(0.985);
	}
	body.dark-mode #yellow-grid .cell.diag-shade-odd:not(.void-cell):not(.active) {
	  filter: brightness(1.06);
	}

	/* WORLD 2 (Purple): Buitenste 2 ringen met subtiel andere achtergrondkleur */
	#purple-grid .cell.outer-ring-0:not(.void-cell):not(.active) {
	  /* Buitenste ring: iets lichter (subtiel) */
	  background: #efe8f7;
	  filter: brightness(1.00);
	}
	#purple-grid .cell.outer-ring-1:not(.void-cell):not(.active) {
	  /* Tweede ring: nog iets lichter */
	  background: #f3eefb;
	  filter: brightness(1.00);
	}
	body.dark-mode #purple-grid .cell.outer-ring-0:not(.void-cell):not(.active) {
	  background: #d3c3ea;
	  filter: brightness(0.97);
	}
	body.dark-mode #purple-grid .cell.outer-ring-1:not(.void-cell):not(.active) {
	  background: #d9ccec;
	  filter: brightness(0.97);
	}

	/* Ensure golden card frame shows in the bottom-bar hand (more specific than the hand card background rules). */
	#bottom-bar #card-choice-zone .card-option.card-golden {
		background: linear-gradient(135deg, #fff9e6 0%, #ffe082 30%, #f6c84a 60%, #c78c1f 100%);
		border: 1px solid rgba(220,180,60,0.9);
		box-shadow: 0 28px 56px rgba(184,120,18,0.45), inset 0 1px 0 rgba(255,255,255,0.6);
	}
	body.dark-mode #bottom-bar #card-choice-zone .card-option.card-golden {
		background: linear-gradient(135deg, #5b4a14 0%, #8a6a1c 35%, #bf952a 70%, #e3c45e 100%);
		border: 1px solid rgba(200,160,30,0.8);
		box-shadow: 0 28px 52px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.08);
	}
	.cell.void-cell {
	  visibility: hidden;
	  pointer-events: none;
	  border: none;
	  background: transparent;
	  box-shadow: none;
	  animation: none;
	}
	.cell:hover { background: #eef3ff; }
	.cell.active { background: #cde3ff; border-color: #a8c9ff; color: #000; transform: scale(1.1); box-shadow: 0 0 8px rgba(58,111,247,0.25); }
	.cell.bold-cell{ border:2px solid #2c3333 !important }
	.cell.end-cell{ background:#a7d6aa; border-color:#a7d6aa }
	.cell.end-cell.active{ background:#81b884 }
	.cell.trap-cell { position: relative; }
	.cell.trap-triggered {
	  box-shadow: 0 0 12px rgba(196,56,56,0.55), inset 0 0 10px rgba(196,56,56,0.45);
	  animation: trapPulse 0.5s ease;
	}

	@keyframes trapPulse {
	  0% { transform: scale(1); }
	  50% { transform: scale(1.05); }
	  100% { transform: scale(1); }
	}
	
	/* ============================================
	   SYMBOLEN IN CELLEN
	   ============================================
	   Gekleurde vierkantjes die in cellen kunnen verschijnen
	   Tonen welke kleur/zone de cel vertegenwoordigt
	*/
	.symbol { display: inline-block; width: 14px; height: 14px; border-radius: 4px; margin: auto; border:2px solid #444; background-color: #999; }
	.symbol.yellow { background-color: #fff48f; }
	.symbol.green  { background-color: #69cf57; }
	.symbol.purple { background-color: #ae7eed; }
	.symbol.blue   { background-color: #76a0e3; }
	.symbol.red    { background-color: #ed7e89; }
	.symbol.trap-symbol {
	  width: 18px;
	  height: 18px;
	  border-radius: 2px;
	  background: #656565;
	  border: none;
	  transform: rotate(45deg) scale(0.75);
	  pointer-events: none;
	  position: relative;
	  overflow: hidden;
	}

	.symbol.trap-symbol::after {
	  content: "";
	  position: absolute;
	  inset: 4px;
	  border-radius: 1px;
	  background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 50%);
	  opacity: 0.8;
	}

	.symbol.trap-symbol.trap-symbol--pit::after {
	  opacity: 0.6;
	}

	.symbol.trap-symbol.trap-symbol--black-hole {
	  background: radial-gradient(circle, #1a1a2e 0%, #0a0a15 60%, #000000 100%);
	  border-radius: 50%;
	  box-shadow: 
		0 0 15px rgba(138, 43, 226, 0.6),
		0 0 25px rgba(75, 0, 130, 0.4),
		inset 0 0 20px rgba(138, 43, 226, 0.3);
	  border: 2px solid rgba(138, 43, 226, 0.4);
	}

	.symbol.trap-symbol.trap-symbol--black-hole::after {
	  background: radial-gradient(circle, rgba(138, 43, 226, 0.2) 0%, transparent 70%);
	  opacity: 1;
	  border-radius: 50%;
	  animation: black-hole-pulse 2s ease-in-out infinite;
	}

	/* Mega Bonus Symbol - grotere bonus met shimmer effect */
	.symbol.mega-bonus-symbol {
	  width: 120%;
	  height: 120%;
	  border-radius: 8px;
	  cursor: pointer;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  font-size: 24px;
	  font-weight: bold;
	  position: absolute;
	  top: 50%;
	  left: 50%;
	  transform: translate(-50%, -50%);
	  transition: transform 0.2s ease;
	  z-index: 15;
	  /* Gradient glim effect over bonus color */
	  background: linear-gradient(135deg, 
		rgba(255, 255, 255, 0.4) 0%, 
		transparent 40%, 
		transparent 60%, 
		rgba(255, 255, 255, 0.4) 100%);
	  background-size: 200% 200%;
	  animation: mega-bonus-glim 2.5s ease-in-out infinite;
	  box-shadow: 0 0 15px rgba(255, 255, 255, 0.5), 
				  inset 0 0 20px rgba(255, 255, 255, 0.3);
	}

	.symbol.mega-bonus-symbol:hover {
	  transform: translate(-50%, -50%) scale(1.15);
	}

	/* Upgrade Shop Symbol - shop icoon met gouden gloed */
	.symbol.upgrade-shop-symbol {
	  width: 100%;
	  height: 100%;
	  border-radius: 8px;
	  cursor: pointer;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  font-size: 24px;
	  font-weight: bold;
	  position: absolute;
	  top: 50%;
	  left: 50%;
	  transform: translate(-50%, -50%);
	  transition: transform 0.2s ease;
	  z-index: 15;
	  background: rgba(255, 215, 0, 0.9);
	  box-shadow: 0 0 8px rgba(255, 215, 0, 0.45);
	}

	.symbol.upgrade-shop-symbol:hover {
	  transform: translate(-50%, -50%) scale(1.15);
	}

	@keyframes upgrade-shop-glim {
	  0%, 100% { 
		background-position: 0% 50%;
	  }
	  50% { 
		background-position: 100% 50%;
	  }
	}

	@keyframes mega-bonus-glim {
	  0%, 100% { 
		background-position: 0% 50%;
	  }
	  50% { 
		background-position: 100% 50%;
	  }
	}

	@keyframes black-hole-pulse {
		0%, 100% {
			transform: scale(1);
			opacity: 0.8;
		}
		50% {
			transform: scale(1.1);
			opacity: 1;
		}
	}
	
	/* Portal cel styling */
	.portal-cell {
		animation: portal-pulse 2s ease-in-out infinite;
		z-index: 10 !important;
	}

	.portal-symbol {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		font-size: 24px;
		z-index: 100;
		pointer-events: none;
		filter: drop-shadow(0 0 10px rgba(100, 150, 255, 1));
		animation: portal-rotate 3s linear infinite;
		text-shadow: 0 0 15px rgba(100, 150, 255, 0.8);
	}

	@keyframes portal-pulse {
		0%, 100% {
			box-shadow: 0 0 15px rgba(100, 150, 255, 0.8), inset 0 0 15px rgba(100, 150, 255, 0.5);
		}
		50% {
			box-shadow: 0 0 30px rgba(100, 150, 255, 1), inset 0 0 20px rgba(100, 150, 255, 0.7);
		}
	}

	@keyframes portal-rotate {
		0% { transform: translate(-50%, -50%) rotate(0deg); }
		100% { transform: translate(-50%, -50%) rotate(360deg); }
	}
	
	/* Gouden muntje binnen een cel (gebruikt ::after pseudo-element) */
	.gold-cell::after { content: ""; position: absolute; top: 4px; left: 4px; width: 12px; height: 12px; border-radius: 50%; background: #ffea63; border: 2px solid #171615; z-index: 1; }
	.cell.active.gold-cell::after{ background:#edcd21 }
	
	/* ============================================
	   MUNTEN VERZAMELING (GOUDEN VAK)
	   ============================================
	   Container voor de 20 muntjes in het gouden vak
	   Toont hoeveel munten je hebt verzameld/gebruikt
	*/
	#collected-coins{ display:flex; gap:6px; flex-wrap:wrap; justify-content:center; margin-top:5px;  }
	
	/* ============================================
	   INDIVIDUELE MUNTEN
	   ============================================
	   Elk muntje heeft 3 states:
	   - standaard (grijs, niet verzameld)
	   - .active (goudkleurig, verzameld maar niet gebruikt)
	   - .used (donkergrijs, al uitgegeven in shop)
	*/
	.coin {
		width: 18px;
		height: 18px;
		border-radius: 50%;
		background: rgba(255,255,255,0.18);
		border: 1px solid rgba(255,255,255,0.28);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.25), 0 0 6px rgba(0,0,0,0.25);
		transition: transform 0.2s ease, background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
	}

	.coin.active {
		background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 70%);
		border-color: #f3b12b;
		box-shadow: 0 0 8px rgba(255,209,90,0.78), inset 0 0 2px rgba(255,255,255,0.85);
		transform: scale(1.05);
	}

	.coin.used {
		background: rgba(80,82,95,0.65);
		border-color: rgba(120,124,140,0.6);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.4);
		transform: scale(1);
	}

	body.dark-mode .coin {
		background: rgba(255,255,255,0.14);
		border-color: rgba(255,255,255,0.24);
	}

	body.dark-mode .coin.active {
		background: radial-gradient(circle at 30% 30%, #ffe58c, #f5b72f 70%);
	}

	body.dark-mode .coin.used {
		background: rgba(60,60,72,0.7);
		border-color: rgba(110,110,130,0.55);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.55);
	}

	/* ============================================
	   +1 BLOKPLAATSING KNOP
	   ============================================ */
	.buy-placement-btn {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 6px;
		margin-top: 10px;
		padding: 8px 14px;
		border: 1px solid rgba(26,32,48,0.16);
		border-radius: 8px;
		background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
		color: #2b3148;
		font-weight: 600;
		font-size: 0.9rem;
		cursor: pointer;
		transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
		box-shadow: 0 12px 20px rgba(10,12,20,0.22);
	}
	.buy-placement-btn:hover:not(:disabled) {
		transform: translateY(-2px);
		box-shadow: 0 18px 28px rgba(10,12,20,0.28);
		background: linear-gradient(155deg, #f4f7ff 0%, #e2e8fb 100%);
	}
	.buy-placement-btn:active:not(:disabled) {
		transform: translateY(0);
		box-shadow: 0 10px 18px rgba(10,12,20,0.22);
	}
	.buy-placement-btn:disabled {
		opacity: 0.5;
		cursor: not-allowed;
		background: linear-gradient(135deg, #e0e0e0, #bdbdbd);
		border-color: rgba(26,32,48,0.16);
		color: #757575;
	}
	.buy-placement-arrow {
		font-size: 1.05rem;
		line-height: 1;
		opacity: 0.9;
		transform: translateY(-0.5px);
	}
	/* Hide the arrow on touch devices */
	@media (pointer: coarse) {
		.buy-placement-arrow {
			display: none;
		}
	}
	.buy-placement-rainbow-cell {
		width: 18px;
		height: 18px;
		/* Border-radius: max 5px, minder rond */
		border-radius: min(5px, calc(18px / 5));
		display: inline-block;
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.22), 0 2px 6px rgba(0,0,0,0.22);
		background: linear-gradient(
			135deg,
			#ff5757 0%,
			#ffbf3a 22%,
			#8cff6a 45%,
			#47b1ff 70%,
			#b16cff 100%
		);
	}
	.buy-placement-cost {
		display: flex;
		gap: 3px;
		background: rgba(0,0,0,0.1);
		padding: 2px 6px;
		border-radius: 4px;
		font-size: 0.8rem;
	}
	.buy-placement-cost .coin-icon {
		display: inline-block;
		width: 0.9em;
		height: 0.9em;
		border-radius: 50%;
		background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 60%, #d49f20);
		box-shadow: inset 0 -1px 2px rgba(0,0,0,0.2);
		border: 1px solid #c9960a;
	}
	body.dark-mode .buy-placement-btn {
		background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
		border-color: rgba(140,150,200,0.3);
		color: rgba(235,238,255,0.88);
		box-shadow: 0 16px 30px rgba(0,0,0,0.42);
	}
	body.dark-mode .buy-placement-btn:hover:not(:disabled) {
		background: linear-gradient(160deg, #333a52 0%, #252a3b 100%);
		box-shadow: 0 20px 34px rgba(0,0,0,0.5);
	}
	body.dark-mode .buy-placement-btn:disabled {
		background: linear-gradient(135deg, #3a3a3a, #2a2a2a);
		border-color: rgba(140,150,200,0.2);
		color: #888;
		transform: scale(1);
	}
	body.dark-mode .buy-placement-rainbow-cell {
		box-shadow: inset 0 0 0 1px rgba(255,255,255,0.12), 0 2px 8px rgba(0,0,0,0.55);
	}

	/* Gekocht blok preview in gold zone */
	#buy-placement-container {
		display: flex;
		justify-content: center;
		margin-top: 10px;
	}
	.purchased-block-preview {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 6px;
		padding: 10px 16px;
		background: linear-gradient(135deg, rgba(240,98,114,0.15), rgba(255,245,90,0.15), rgba(78,211,70,0.15), rgba(93,144,240,0.15));
		border: 2px dashed rgba(150,100,200,0.5);
		border-radius: 10px;
		cursor: grab;
		transition: transform 0.15s ease, box-shadow 0.15s ease;
		animation: pulse-glow 1.5s ease-in-out infinite;
	}
	.purchased-block-preview:hover {
		transform: scale(1.05);
		box-shadow: 0 4px 16px rgba(150,100,200,0.3);
	}
	.purchased-block-preview:active {
		cursor: grabbing;
	}
	.purchased-block-cell {
		width: 28px;
		height: 28px;
		border-radius: 4px;
		background: linear-gradient(45deg, #f06272, #fff25a, #4ed346, #5d90f0, #a35eff);
		border: 2px solid rgba(255,255,255,0.5);
		box-shadow: 0 2px 8px rgba(0,0,0,0.2);
	}
	.purchased-block-label {
		font-size: 0.75rem;
		font-weight: 600;
		color: #6b4d8a;
	}
	@media (max-width: 650px) {
		.purchased-block-label {
			display: none;
		}
		.purchased-block-preview {
			gap: 4px;
			padding: 8px 12px;
		}
	}
	body.dark-mode .purchased-block-preview {
		background: linear-gradient(135deg, rgba(240,98,114,0.1), rgba(255,245,90,0.1), rgba(78,211,70,0.1), rgba(93,144,240,0.1));
		border-color: rgba(180,140,220,0.4);
	}
	body.dark-mode .purchased-block-label {
		color: #c9b0e8;
	}
	/* Keep the purchased preview visible everywhere; it's the drag handle to place the bought block. */
	@keyframes pulse-glow {
		0%, 100% { box-shadow: 0 0 8px rgba(150,100,200,0.2); }
		50% { box-shadow: 0 0 16px rgba(150,100,200,0.4); }
	}
	
	/* ============================================
	   SCOREBORD
	   ============================================
	   Toont score per kleur + totaal
	   Gepositioneerd in kolom 4 op desktop, in bottom-bar op mobiel
	   Score-rows gebruiken kleur-dots voor compactheid
	*/
	#scoreboard {
	  background: #fffbea;
	  border-radius: 12px;
	  padding: 16px 20px;
	  color: #333;
	  font-family: "Segoe UI", sans-serif;
	  width: 280px;
	  position: relative;
	  z-index: 1;
	  box-shadow: 0 0 8px rgba(0,0,0,0.4);
	  display: flex;
	  flex-direction: column;
	  align-items: stretch;
	  gap: 12px;
	}

	#scoreboard h2 {
	  margin: 0;
	}

	body.dark-mode #scoreboard {
	  background: linear-gradient(145deg, #2d2920, #232119);
	  border: 1px solid #3d3930;
	  color: #e0e0e0;
	}

	.score-row { 
	  display: flex; 
	  align-items: center; 
	  justify-content: space-between; 
	  background: #eee; 
	  padding: 6px 10px; 
	  border-radius: 8px; 
	  margin: 0;
	  position: relative;
	  transition: transform 0.1s ease, background 0.3s, box-shadow 0.3s; 
	}

	/* Zone-info knopjes (links boven in elke zone) */
	.zone-info-btn {
		position: absolute;
		left: 8px;
		top: 8px;
		z-index: 20;
		width: 20px;
		height: 20px;
		border-radius: 999px;
		border: 1px solid rgba(0,0,0,0.18);
		background: rgba(255,255,255,0.7);
		color: rgba(0,0,0,0.75);
		font-weight: 800;
		font-size: 12px;
		line-height: 1;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		padding: 0;
		-webkit-user-select: none;
		user-select: none;
	}

	/* When a zone is scrollable, pin the info UI to the zone viewport. */
	#blue-zone .zone-info-btn,
	#green-zone .zone-info-btn {
		position: sticky;
		top: 8px;
		left: 8px;
		margin: 0 0 -20px 0;
	}
	#blue-zone .zone-info-popover,
	#green-zone .zone-info-popover {
		position: sticky;
		top: 34px;
		left: 8px;
		margin: 0 0 -140px 0;
	}

	body.dark-mode .zone-info-btn {
		border-color: rgba(255,255,255,0.18);
		background: rgba(0,0,0,0.2);
		color: rgba(255,255,255,0.82);
	}

	.zone-info-btn:focus {
		outline: 2px solid rgba(0,0,0,0.25);
		outline-offset: 2px;
	}

	body.dark-mode .zone-info-btn:focus {
		outline-color: rgba(255,255,255,0.22);
	}

	.zone-info-popover {
		position: absolute;
		left: 8px;
		right: 8px;
		top: 34px;
		z-index: 30;
		display: none;
		padding: 10px 12px;
		border-radius: 10px;
		background: rgba(255,255,255,0.95);
		border: 1px solid rgba(0,0,0,0.14);
		box-shadow: 0 8px 20px rgba(0,0,0,0.18);
		font-size: 0.82rem;
		line-height: 1.25;
		color: rgba(0,0,0,0.78);
		-webkit-backdrop-filter: blur(6px);
		backdrop-filter: blur(6px);
	}

	body.dark-mode .zone-info-popover {
		background: rgba(35, 33, 25, 0.96);
		border-color: rgba(255,255,255,0.12);
		box-shadow: 0 10px 22px rgba(0,0,0,0.55);
		color: rgba(255,255,255,0.85);
	}

	.zone[data-info-open="true"] .zone-info-popover {
		display: block;
	}
	
	body.dark-mode .score-row {
	  background: #383838;
	  color: #e0e0e0;
	}

	.score-row:hover { transform: scale(1.03); background: #383838; }
	
	/* Score highlighting voor behaalde doelstellingen */
	.score-row.objective-achieved {
	  box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.6);
	  animation: objective-pulse 2s ease-in-out infinite;
	}
	
	body.dark-mode .score-row.objective-achieved {
	  box-shadow: 0 0 12px 2px rgba(255, 215, 0, 0.7);
	  animation: objective-pulse-dark 2s ease-in-out infinite;
	}
	
	@keyframes objective-pulse {
	  0%, 100% { box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.6); }
	  50% { box-shadow: 0 0 15px 3px rgba(255, 215, 0, 0.8); }
	}
	
	@keyframes objective-pulse-dark {
	  0%, 100% { box-shadow: 0 0 12px 2px rgba(255, 215, 0, 0.7); }
	  50% { box-shadow: 0 0 18px 4px rgba(255, 215, 0, 0.9); }
	}

	body.dark-mode .score-row:hover {
	  background: #484848;
	}

	.color-box { width: 14px; height: 14px; border-radius: 3px; margin-right: 8px; }
	.label { flex: 1; font-size: 0.9em; }
	.score { font-weight: bold; font-size: 1em; }
	.score-row.yellow .color-box { background-color: #f7e757; }
	.score-row.red .color-box { background-color: #ed7e89; }
	.score-row.green .color-box { background-color: #69cf57; }
	.score-row.purple .color-box { background-color: #ae7eed; }
	.score-row.blue .color-box { background-color: #76a0e3; }
	.score-row.bonus .color-box { background-color: #C0C0C0; }
	#scoreboard hr {
	  width: 100%;
	  border: none;
	  border-top: 1px solid rgba(0,0,0,0.08);
	  margin: 0;
	}

	body.dark-mode #scoreboard hr {
	  border-top-color: rgba(255,255,255,0.12);
	}

	#scoreboard .score-total {
	  display: flex;
	  align-items: center;
	  justify-content: space-between;
	  gap: 6px;
	  padding: 4px 8px;
	  background: #f0ead8;
	  border-radius: 6px;
	  border: 1px solid #d9d0bd;
	  font-weight: 600;
	  color: #333;
	  margin-top: 3px;
	  font-size: 0.9rem;
	  transition: box-shadow 0.3s;
	}
	
	/* Total score highlighting voor behaalde doelstellingen */
	#scoreboard .score-total.objective-achieved {
	  box-shadow: 0 0 10px 2px rgba(255, 215, 0, 0.6);
	  animation: objective-pulse 2s ease-in-out infinite;
	}
	
	body.dark-mode #scoreboard .score-total.objective-achieved {
	  box-shadow: 0 0 12px 2px rgba(255, 215, 0, 0.7);
	  animation: objective-pulse-dark 2s ease-in-out infinite;
	}

	body.dark-mode #scoreboard .score-total {
	  background: #2f3239;
	  border-color: #3d4048;
	  color: #e5e5e5;
	}

	#scoreboard .trap-summary {
	  display: flex;
	  flex-direction: column;
	  gap: 6px;
	  padding: 10px 12px;
	  border-radius: 12px;
	  background: rgba(0,0,0,0.035);
	  border: 1px solid rgba(0,0,0,0.06);
	}

	#scoreboard .trap-summary-header {
	  display: flex;
	  justify-content: space-between;
	  align-items: center;
	  font-size: 0.78rem;
	  letter-spacing: 0.05em;
	  text-transform: uppercase;
	  color: rgba(0,0,0,0.55);
	}

	#scoreboard .trap-summary-header .trap-label {
	  font-weight: 600;
	}

	#scoreboard .trap-count {
	  font-weight: 600;
	  font-size: 0.85rem;
	  color: #c43838;
	}

	#scoreboard .trap-preview {
	  display: flex;
	  flex-wrap: wrap;
	  gap: 8px;
	  align-items: center;
	  overflow: hidden;
	  padding-bottom: 0;
	  scrollbar-width: none;
	}

	#scoreboard .trap-preview.trap-preview--compact {
	  gap: 6px;
	  row-gap: 4px;
	}

	#scoreboard .trap-preview:empty::after {
	  content: 'Geen valkuilen geactiveerd';
	  font-size: 0.85rem;
	  color: rgba(0,0,0,0.45);
	  font-style: italic;
	}

	.trap-preview::-webkit-scrollbar {
	  display: none;
	}

	.trap-preview::-webkit-scrollbar-track {
	  background: rgba(0,0,0,0.05);
	  border-radius: 6px;
	}

	.trap-preview::-webkit-scrollbar-thumb {
	  background: rgba(196,56,56,0.4);
	  border-radius: 6px;
	}

	.trap-preview--compact .trap-icon {
	  display: none;
	}

	.trap-compact-chip {
	  display: inline-flex;
	  align-items: center;
	  gap: 4px;
	  padding: 2px 9px;
	  border-radius: 999px;
	  font-weight: 600;
	  font-size: 0.8rem;
	  background: rgba(196,56,56,0.12);
	  color: #a51111;
	  border: 1px solid rgba(196,56,56,0.28);
	}

	.trap-compact-chip::before {
	  content: attr(data-symbol);
	  font-size: 1rem;
	  line-height: 1;
	}

	.trap-compact-chip span {
	  pointer-events: none;
	}

	.trap-compact-chip--black-hole {
	  background: rgba(62, 44, 143, 0.12);
	  color: #3e2c8f;
	  border-color: rgba(62, 44, 143, 0.26);
	}

	.trap-icon {
	  position: relative;
	  width: 40px;
	  height: 40px;
	  flex: 0 0 auto;
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  border-radius: 10px;
	  background: radial-gradient(circle at 30% 30%, #ffeaea, #f6d3d3);
	  border: 1px solid rgba(196,56,56,0.35);
	  box-shadow: 0 4px 10px rgba(196,56,56,0.18);
	  font-size: 1.4rem;
	  color: #a51111;
	  transition: transform 0.2s ease, box-shadow 0.2s ease;
	}

	.trap-icon .penalty-chip {
	  position: absolute;
	  right: -4px;
	  bottom: -6px;
	  background: #2a0b0b;
	  color: #ffb3b3;
	  font-size: 0.7rem;
	  font-weight: 600;
	  padding: 1px 5px;
	  border-radius: 10px;
	  border: 1px solid rgba(255,255,255,0.25);
	  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
	}

	.trap-icon.trap-icon--black-hole {
	  background: radial-gradient(circle at 35% 28%, #f1ecff 0%, #d7d1fb 60%, #bfb6ef 100%);
	  border-color: rgba(110, 80, 210, 0.35);
	  color: #3e2c8f;
	  box-shadow: 0 6px 14px rgba(80, 60, 160, 0.28);
	}

	.trap-icon.trap-icon--black-hole .penalty-chip {
	  background: rgba(40, 28, 100, 0.9);
	  color: #efe8ff;
	  border-color: rgba(255,255,255,0.38);
	}

	.trap-icon span {
	  pointer-events: none;
	}

	.trap-icon span:first-child {
	  font-size: 1.05rem;
	}

	.trap-icon.highlight {
	  transform: translateY(-3px) scale(1.05);
	  box-shadow: 0 8px 16px rgba(196,56,56,0.36);
	}

	#scoreboard .score-total .label {
	  font-size: 0.85rem;
	  letter-spacing: 0.08em;
	  text-transform: uppercase;
	  opacity: 0.8;
	}

	#scoreboard .score-total .total-score {
	  font-size: 2.2rem;
	  line-height: 1;
	  font-weight: 700;
	  color: #2b1a00;
	}

	#bonus-score[data-blackhole-extra]:not([data-blackhole-extra="0"])::after {
	  content: ' +' attr(data-blackhole-extra);
	  font-size: 0.7em;
	  margin-left: 6px;
	  color: #6b63c9;
	}

	body.dark-mode #scoreboard .score-total {
	  background: linear-gradient(140deg, #3a331f, #2b2619);
	  border-color: rgba(255, 199, 63, 0.25);
	  color: #f6f1dd;
	  box-shadow: 0 16px 30px rgba(0,0,0,0.35);
	}

	body.dark-mode #scoreboard .trap-summary {
	  background: rgba(255,255,255,0.03);
	  border-color: rgba(255,255,255,0.07);
	}
	body.dark-mode #bonus-score[data-blackhole-extra]:not([data-blackhole-extra="0"])::after {
	  color: #d5d0ff;
	}

	body.dark-mode .trap-icon {
	  background: radial-gradient(circle at 30% 30%, #3c1e1e, #281111);
	  border-color: rgba(196,56,56,0.45);
	  color: #f3bbbb;
	  box-shadow: 0 4px 12px rgba(0,0,0,0.45);
	}

	body.dark-mode .trap-icon.trap-icon--black-hole {
	  background: radial-gradient(circle at 38% 32%, #403472 0%, #291f55 58%, #110b30 100%);
	  border-color: rgba(150,120,240,0.55);
	  color: #d9d5ff;
	  box-shadow: 0 6px 16px rgba(50,30,120,0.45);
	}

	body.dark-mode .trap-icon .penalty-chip {
	  background: rgba(70,20,20,0.85);
	  color: #ffc9c9;
	}

	body.dark-mode .trap-icon.trap-icon--black-hole .penalty-chip {
	  background: rgba(24,18,70,0.9);
	  color: #f0ecff;
	}

	body.dark-mode #scoreboard .trap-summary-header {
	  color: rgba(255,240,210,0.6);
	}

	body.dark-mode #scoreboard .trap-summary-header .trap-label {
	  color: rgba(255,240,210,0.9);
	}

	body.dark-mode #scoreboard .trap-count {
	  color: #ff8585;
	}

	body.dark-mode #scoreboard .trap-preview:empty::after {
	  color: rgba(255,255,255,0.35);
	}

	body.dark-mode .trap-preview::-webkit-scrollbar-track {
	  background: rgba(255,255,255,0.05);
	}

	body.dark-mode .trap-preview::-webkit-scrollbar-thumb {
	  background: rgba(255,120,120,0.45);
	}

	body.dark-mode .trap-compact-chip {
	  background: rgba(196,56,56,0.18);
	  color: #ffb3b3;
	  border-color: rgba(196,56,56,0.32);
	}

	body.dark-mode .trap-compact-chip--black-hole {
	  background: rgba(79, 64, 150, 0.22);
	  color: #d6d1ff;
	  border-color: rgba(131, 117, 210, 0.35);
	}

	body.dark-mode .trap-icon {
	  background: radial-gradient(circle at 30% 30%, #4b1c1c, #2a1212);
	  border-color: rgba(255,120,120,0.45);
	  color: #ffb3b3;
	  box-shadow: 0 4px 10px rgba(0,0,0,0.4);
	}

	body.dark-mode .trap-icon .penalty-chip {
	  background: #901717;
	  color: #ffe0e0;
	  border-color: rgba(0,0,0,0.45);
	}

	body.dark-mode #scoreboard .score-total .label {
	  color: rgba(255, 243, 205, 0.8);
	}

	body.dark-mode #scoreboard .score-total .total-score {
	  color: #ffe6a3;
	}

	/* ============================================
	   HIGH SCORE POPUP & MODAL
	   ============================================
	*/
	.highscore-toast {
		position: fixed;
		top: 80px;
		left: 50%;
		transform: translate(-50%, 0) scale(0.96);
		background: linear-gradient(120deg, #fff7d1, #ffe089);
		color: #2a1b00;
		padding: 14px 20px;
		border-radius: 16px;
		display: flex !important;
		align-items: center;
		gap: 12px;
		box-shadow: 0 18px 40px rgba(0,0,0,0.32);
		font-weight: 600;
		z-index: 2147483647 !important;
		opacity: 0;
		animation: highscoreToastEnter 0.35s ease forwards;
		pointer-events: none;
	}

	.highscore-toast__icon {
		font-size: 1.5rem;
	}

	.highscore-toast__score {
		font-size: 1.25rem;
		font-weight: 800;
	}

	body.dark-mode .highscore-toast {
		background: linear-gradient(120deg, #2f2a1f, #4d3f1d);
		color: #fff6cc;
		box-shadow: 0 20px 46px rgba(0,0,0,0.6);
	}

	@keyframes highscoreToastEnter {
		0% { opacity: 0; transform: translate(-50%, -30px) scale(0.8); }
		70% { opacity: 1; transform: translate(-50%, 6px) scale(1.03); }
		100% { opacity: 1; transform: translate(-50%, 0) scale(1); }
	}

	/* High Score Modal */
	.highscore-modal-overlay {
		position: fixed;
		inset: 0;
		background: rgba(0,0,0,0.5);
		backdrop-filter: blur(4px);
		display: none;
		align-items: center;
		justify-content: center;
		z-index: 10000;
	}
	.highscore-modal-overlay.show { display: flex; }
	.highscore-modal {
		background: white;
		padding: 30px;
		border-radius: 12px;
		text-align: center;
		box-shadow: 0 10px 30px rgba(0,0,0,0.3);
		max-width: 90%;
		width: 300px;
	}
	body.dark-mode .highscore-modal {
		background: #2d2d2d;
		color: #eee;
	}
	.highscore-value {
		font-size: 3rem;
		font-weight: bold;
		color: #d4af37;
		margin: 20px 0;
	}
	.highscore-close-btn {
		background: #eee;
		border: none;
		padding: 10px 20px;
		border-radius: 6px;
		cursor: pointer;
		font-weight: bold;
	}
	.highscore-close-btn:hover { background: #ddd; }
	body.dark-mode .highscore-close-btn {
		background: #444;
		color: #eee;
	}
	body.dark-mode .highscore-close-btn:hover {
		background: #555;
	}

	/* ============================================
	   ANIMATIES
	   ============================================
	*/
	@keyframes popIn {
	  to { transform: translate(-50%, -50%) scale(1); }
	}

	#card-choice-zone {
	  background: #fffbea;
	  border-radius: 12px;
	  color: #333;
	  font-family: "Segoe UI", sans-serif;
	  width: min(402px, 100%);
	  box-shadow: 0 0 8px rgba(0,0,0,0.4);
	  overflow: hidden;
	}

	body.dark-mode #card-choice-zone {
	  background: linear-gradient(145deg, #22252b, #1a1c21);
	  border: 1px solid #2d2f36;
	  box-shadow: 0 0 12px rgba(0,0,0,0.6);
	  color: #e5e5e5;
	}

	#card-controls {
		display: flex;
		flex-direction: row;
		align-items: flex-start;
		justify-content: center;
		gap: 16px;
		width: 100%;
		box-sizing: border-box;
	}

	#card-options {
		flex: 1 1 auto;
		min-width: 0;
		display: flex;
		flex-wrap: wrap;
		gap: 14px;
		justify-content: center;
		align-items: flex-start;
		margin: 0;
		padding: 0;
	}

	#card-action-buttons {
		display: flex;
		flex-direction: column;
		align-items: stretch;
		gap: 14px;
		max-width: 190px;
		width: 100%;
		flex: 0 0 auto;
	}

	.card-action-btn {
		position: relative;
		display: inline-flex;
		align-items: center;
		justify-content: flex-start;
		gap: 10px;
		width: 100%;
		min-width: 0;
		margin: 0;
		padding: 12px 16px;
		border-radius: 14px;
		border: 1px solid rgba(26,32,48,0.16);
		background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
		color: #2b3148;
		font-weight: 600;
		font-size: 0.88rem;
		letter-spacing: 0.04em;
		text-transform: none;
		box-shadow: 0 12px 20px rgba(10,12,20,0.22);
		cursor: pointer;
		transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.25s ease, background 0.25s ease;
		min-height: 52px;
	}

	.card-action-btn::before {
		content: attr(data-icon);
		font-size: 1.4rem;
		line-height: 1;
	}

	.card-action-btn::after {
		content: attr(data-label);
		line-height: 1.1;
		white-space: nowrap;
	}

	/* Desktop: buttons zijn 52x52px iconen zonder tekst */
	@media (min-width: 651px) {
		/* Desktop must not show the mobile hand-scroll arrows. */
		.hand-scroll-btn,
		#card-controls.hand-scroll-enabled .hand-scroll-btn {
			display: none !important;
		}

		.card-action-btn {
			justify-content: center;
			padding: 12px;
			min-width: 52px;
			width: 52px;
			max-width: 52px;
			min-height: 52px;
			height: 52px;
		}

		.card-action-btn::after {
			display: none;
		}

		/* Ensure the â€œnext turnâ€ button matches the deck button and sits next to it. */
		#card-action-buttons .card-action-btn {
			width: 52px;
			max-width: 52px;
			min-width: 52px;
			justify-content: center;
		}
		#card-action-buttons .card-action-btn::after {
			display: none;
		}
		#card-action-buttons #new-cards-btn { order: 0; }
		#card-action-buttons #deck-preview { order: 1; }
		
		/* Deck preview: vierkant en zelfde kleur als andere buttons */
		.deck-preview {
			min-width: 52px;
			width: 52px;
			max-width: 52px;
			min-height: 52px;
			height: 52px;
			padding: 0;
			background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
			border: 1px solid rgba(26,32,48,0.16);
			border-radius: 14px;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			gap: 2px;
			box-shadow: 0 12px 20px rgba(10,12,20,0.2);
		}
		
		.deck-preview::before {
			content: 'ðŸ“š';
			font-size: 1.2rem;
			display: block;
			line-height: 1;
		}

		.deck-preview::after {
			display: none;
		}
		
		/* Deck preview: zorg dat icoon ook in portrait mode zichtbaar is */
		body.desktop-portrait .deck-preview::before {
			content: 'ðŸ“š';
			display: block;
		}

		.deck-count {
			position: static;
			min-width: auto;
			padding: 0;
			background: none;
			border: none;
			box-shadow: none;
			font-size: 0.75rem;
			font-weight: 700;
			color: #2b3148;
			line-height: 1;
		}

		.deck-count::before {
			display: none;
		}

		body.dark-mode .deck-preview {
			background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
			border-color: rgba(140,150,200,0.3);
		}

		body.dark-mode .deck-count {
			color: rgba(235,238,255,0.88);
		}
	}

	.card-action-btn:hover:not(:disabled),
	.card-action-btn:focus-visible {
		transform: translateY(-2px);
		box-shadow: 0 18px 28px rgba(10,12,20,0.28);
	}

	.card-action-btn:focus-visible {
		outline: 3px solid rgba(86,122,255,0.55);
		outline-offset: 3px;
	}

	.card-action-btn:disabled {
		opacity: 0.55;
		cursor: not-allowed;
		transform: none;
		box-shadow: none;
	}

	body.dark-mode .card-action-btn {
		background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
		border-color: rgba(140,150,200,0.3);
		color: rgba(235,238,255,0.88);
		box-shadow: 0 16px 30px rgba(0,0,0,0.42);
	}

	body.dark-mode .card-action-btn:hover:not(:disabled),
	body.dark-mode .card-action-btn:focus-visible {
		box-shadow: 0 20px 34px rgba(0,0,0,0.5);
	}

	/* Dark mode deck preview matching card buttons */
	body.dark-mode #card-action-buttons .deck-preview {
		background: linear-gradient(160deg, #2c3144 0%, #222635 100%);
		border-color: rgba(140,150,200,0.3);
	}

	body.dark-mode #card-action-buttons .deck-count {
		color: rgba(235,238,255,0.88);
	}

	.deck-preview {
		position: relative;
		display: inline-flex;
		align-items: center;
		justify-content: space-between;
		gap: 10px;
		padding: 12px 16px;
		border-radius: 14px;
		border: 1px solid rgba(26,32,48,0.16);
		background: linear-gradient(160deg, #ffffff 0%, #edf1ff 100%);
		box-shadow: 0 12px 20px rgba(10,12,20,0.2);
		color: #2b3148;
		cursor: pointer;
		transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.25s ease, background 0.25s ease;
		min-height: 52px;
		flex: 0 0 auto;
	}

	.deck-preview::after {
		display: none;
	}

	.deck-preview:hover,
	.deck-preview:focus-visible {
		transform: translateY(-2px);
		box-shadow: 0 18px 28px rgba(10,12,20,0.28);
	}

	.deck-preview:focus-visible {
		outline: 3px solid rgba(86,122,255,0.55);
		outline-offset: 3px;
	}
	
	/* Verwijder outline in desktop modes */
	@media (min-width: 651px) {
		.deck-preview:focus-visible {
			outline: none;
		}
	}

	.deck-count {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 4px;
		min-width: 54px;
		padding: 6px 10px;
		border-radius: 10px;
		background: rgba(255,255,255,0.9);
		border: 1px solid rgba(26,32,48,0.16);
		box-shadow: inset 0 -1px 0 rgba(255,255,255,0.75), 0 6px 12px rgba(10,12,20,0.18);
		font-size: 1.05rem;
		font-weight: 700;
		color: #2b3148;
		font-variant-numeric: tabular-nums;
	}

	/* Desktop: deck count centered zonder icon */
	@media (min-width: 651px) {
		.deck-count {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			min-width: auto;
			padding: 0;
			background: none;
			border: none;
			box-shadow: none;
		}

		.deck-count::before {
			display: none;
		}
	}

	.deck-count::before {
		content: '\1F4DA';
		font-size: 1.1rem;
	}

	body.dark-mode .deck-preview {
		background: linear-gradient(160deg, #2c3144 0%, #1f2333 100%);
		border-color: rgba(140,150,200,0.28);
		color: rgba(235,238,255,0.9);
		box-shadow: 0 18px 30px rgba(0,0,0,0.4);
	}

	body.dark-mode .deck-preview::after {
		color: rgba(235,238,255,0.75);
	}

	body.dark-mode .deck-preview:focus-visible {
		outline-color: rgba(120,160,255,0.7);
	}

	body.dark-mode .deck-count {
		background: rgba(18,22,36,0.92);
		border-color: rgba(120,140,220,0.38);
		color: rgba(235,238,255,0.88);
		box-shadow: inset 0 -1px 0 rgba(255,255,255,0.08), 0 6px 12px rgba(0,0,0,0.42);
	}

	#turn-counter-inline {
		display: none;
	}

	body.dark-mode #turn-counter-inline {
		background: linear-gradient(145deg, #22252b, #1a1c21);
		border: 1px solid #2d2f36;
		box-shadow: 0 6px 14px rgba(0,0,0,0.45);
		color: #e5e5e5;
	}

	.card-option {
		flex: 0 0 auto;
		width: 138px;
		min-height: 180px;
		padding: 0;
		display: flex;
		flex-direction: column;
		--preview-cell: 20px;
		align-items: center;
		justify-content: center;
		gap: 12px;
		border-radius: 16px;
		background: linear-gradient(165deg, #ffffff 0%, #eef2ff 45%, #dfe4ff 100%);
		border: 1px solid rgba(40,55,120,0.18);
		box-shadow: 0 18px 26px rgba(10,12,20,0.2);
		position: relative;
		overflow: visible;
		transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
	}

	/* Desktop landscape request: cards a bit shorter (â‰ˆ10px). */
	body.desktop-landscape #card-choice-zone .card-option {
		min-height: 170px;
	}

	/* Desktop request: make cards ~20px smaller overall. */
	body.desktop-landscape .card-option {
		width: 118px;
	}

	.card-option::after {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: inherit;
		background: linear-gradient(120deg, rgba(255,255,255,0.65), rgba(255,255,255,0) 58%);
		opacity: 0.45;
		pointer-events: none;
	}

	.card-option > * {
		position: relative;
		z-index: 1;
	}

	.card-option:hover {
		transform: translateY(-6px);
		box-shadow: 0 30px 48px rgba(20,30,60,0.32);
	}

	.card-option.selected {
		border-color: rgba(82,118,255,0.6);
		box-shadow: 0 32px 52px rgba(70,90,180,0.45);
	}

	/* Card control buttons voor mobiel en touch devices - fixed positie onderaan */
	.card-control-btn {
		position: fixed;
		/* Position bottom center for touch devices */
		bottom: calc(var(--bottom-bar-height) + 10px);
		width: 44px;
		height: 44px;
		border: 2px solid white;
		border-radius: 50%;
		display: none;
		align-items: center;
		justify-content: center;
		font-size: 20px;
		color: white;
		cursor: pointer;
		box-shadow: 0 4px 12px rgba(0,0,0,0.3);
		z-index: calc(var(--z-controls) + 10);
		user-select: none;
		transition: transform 0.15s ease, opacity 0.15s ease;
		pointer-events: auto;
		touch-action: manipulation;
	}

	.card-control-btn:hover {
		transform: scale(1.1);
	}

	.card-control-btn:active {
		transform: scale(0.95);
	}

	/* Toon buttons wanneer er een selectie is */
	.card-control-btn.visible {
		display: flex;
	}

	.card-control-rotate {
		left: 50%;
		margin-left: 75px;
		background: #4a90e2;
	}

	.card-control-mirror {
		left: 50%;
		margin-left: 25px;
		background: #9b59b6;
	}

	.card-control-cancel {
		left: 50%;
		margin-left: -25px;
		background: #e74c3c;
	}

	/* Touch portrait mode: buttons blijven onderaan gecentreerd */
	body.touch-portrait .card-control-btn {
		bottom: calc(var(--bottom-bar-height) + 10px);
		top: auto;
		right: auto;
	}
	
	/* Mobile sidebar landscape: buttons aan de rechterkant */
	body.mobile-sidebar-layout .card-control-btn {
		bottom: auto;
		top: 50%;
		left: auto;
		right: 15px;
		margin-left: 0;
	}
	body.mobile-sidebar-layout .card-control-rotate {
		transform: translateY(-85px);
	}
	body.mobile-sidebar-layout .card-control-mirror {
		transform: translateY(-30px);
	}
	body.mobile-sidebar-layout .card-control-cancel {
		transform: translateY(25px);
	}

	.card-control-btn:hover {
		transform: scale(1.1);
	}
	
	.card-control-btn:active {
		transform: scale(0.95);
	}

	body.dark-mode .card-control-rotate {
		background: #5a9fd4;
		border-color: #1e2128;
	}

	body.dark-mode .card-control-mirror {
		background: #8e44ad;
		border-color: #1e2128;
	}

	body.dark-mode .card-control-cancel {
		background: #c0392b;
		border-color: #1e2128;
	}

	.card-pattern {
		display: inline-grid;
		gap: var(--preview-gap, 2px);
		align-items: center;
		justify-items: center;
		justify-content: center;
		align-content: center;
	}

	.card-option .card-cell {
		width: var(--card-cell-size, 22px);
		height: var(--card-cell-size, 22px);
		/* Border-radius: max 5px, minder rond voor kleine cells */
		border-radius: min(5px, calc(var(--card-cell-size, 22px) / 5));
		border: 1px solid rgba(12,16,30,0.12);
		box-shadow: inset 0 0 4px rgba(0,0,0,0.18);
		background: rgba(255,255,255,0.95);
	}

	.card-label {
		display: inline-flex;
		align-items: center;
		gap: 6px;
		padding: 5px 10px;
		border-radius: 999px;
		background: rgba(20,24,36,0.06);
		font-size: 0.72rem;
		font-weight: 600;
		letter-spacing: 0.065em;
		text-transform: uppercase;
		color: rgba(20,24,36,0.62);
	}

	.card-label-dot {
		width: 9px;
		height: 9px;
		border-radius: 50%;
		box-shadow: 0 0 5px rgba(0,0,0,0.26);
	}

	.card-meta {
		font-size: 0.72rem;
		letter-spacing: 0.05em;
		color: rgba(20,24,36,0.55);
	}

	body.dark-mode .card-option {
		background: linear-gradient(160deg, #2d3142 0%, #232635 45%, #1b1e2c 100%);
		border-color: rgba(120,140,220,0.2);
		box-shadow: 0 26px 44px rgba(0,0,0,0.5);
	}

	body.dark-mode .card-option::after {
		opacity: 0.25;
	}

	body.dark-mode .card-option .card-cell {
		border-color: rgba(255,255,255,0.08);
		box-shadow: inset 0 0 6px rgba(0,0,0,0.35);
		background: rgba(18,22,32,0.6);
	}

	body.dark-mode .card-label {
		background: rgba(255,255,255,0.08);
		color: rgba(255,255,255,0.82);
	}

	body.dark-mode .card-label-dot {
		box-shadow: 0 0 6px rgba(0,0,0,0.45);
	}

	body.dark-mode .card-meta {
		color: rgba(255,255,255,0.65);
	}

	#card-options {
	  display: flex;
	  flex-wrap: wrap;
	  gap: 12px;
	  justify-content: center;
	  margin-top: 12px;
	}

	@keyframes coinPop {
	  0% { transform: translate(-50%, -50%) scale(0); opacity: 0.2; }
	  70% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
	  100% { transform: translate(-50%, -50%) scale(1); }
	}


	@keyframes growRoot {
	  from { opacity: 0; transform: scale(0.5); }
	  to { opacity: 1; transform: scale(1); }
	}

	.modal-overlay {
		position: fixed;
		inset: 0;
		padding: 18px;
		display: none;
		align-items: flex-start;
		justify-content: center;
		background: rgba(10, 12, 20, 0.6);
		backdrop-filter: blur(6px);
		-webkit-backdrop-filter: blur(6px);
		z-index: 1200;
		overflow-y: auto;
	}

	.modal-overlay.show {
		display: flex;
	}

	.game-modal {
		background: #fffbea;
		border-radius: 16px;
		padding: 24px;
		width: min(420px, 100%);
		box-shadow: 0 26px 48px rgba(10, 12, 20, 0.34);
		border: 1px solid rgba(20, 24, 36, 0.18);
		color: #191d2a;
		position: relative;
	}

	body.dark-mode .game-modal {
		background: rgba(12, 14, 20, 0.95);
		border-color: rgba(255, 255, 255, 0.14);
		color: #f5f6ff;
		box-shadow: 0 30px 52px rgba(0, 0, 0, 0.55);
	}

	.game-modal h2 {
		margin-top: 0;
		margin-bottom: 8px;
		font-size: 1.35rem;
	}

	.game-modal p {
		margin: 8px 0;
		line-height: 1.5;
	}

	.modal-subtext {
		margin: 4px 0 0;
		font-size: 0.85rem;
		color: rgba(27, 33, 48, 0.7);
	}

	body.dark-mode .modal-subtext {
		color: rgba(245, 246, 255, 0.7);
	}

	.modal-actions {
		display: flex;
		flex-wrap: wrap;
		gap: 12px;
		justify-content: flex-end;
		margin-top: 20px;
	}

	.modal-actions button {
		background: linear-gradient(145deg, #ffd560, #ffb23c);
		border: 1px solid rgba(20, 24, 36, 0.14);
		border-radius: 10px;
		padding: 10px 18px;
		font-weight: 600;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease;
		color: #1f2433;
	}

	.modal-actions button:hover:not(:disabled) {
		transform: translateY(-2px);
		box-shadow: 0 14px 28px rgba(10, 12, 20, 0.28);
	}

	.modal-actions button:disabled {
		opacity: 0.6;
		cursor: not-allowed;
		box-shadow: none;
	}

	body.dark-mode .modal-actions button {
		background: linear-gradient(145deg, #2f3546, #1c2233);
		border-color: rgba(255, 255, 255, 0.12);
		color: #f5f6ff;
	}

	.modal-score-summary {
		margin-top: 14px;
		display: flex;
		flex-direction: column;
		gap: 16px;
	}

	.round-summary-cards {
		display: flex;
		flex-wrap: wrap;
		gap: 12px;
		justify-content: center;
	}

	.round-summary-card {
		flex: 1 1 160px;
		min-width: 150px;
		padding: 14px 16px;
		border-radius: 16px;
		text-align: center;
		background: linear-gradient(145deg, rgba(255, 242, 196, 0.85), rgba(255, 214, 125, 0.9));
		border: 1px solid rgba(20, 24, 36, 0.08);
		box-shadow: 0 16px 24px rgba(31, 36, 51, 0.12);
	}

	.round-summary-card--coins {
		background: linear-gradient(145deg, rgba(255, 240, 200, 0.9), rgba(255, 199, 142, 0.95));
	}

	/* Unlock Modal Styles */
	.unlock-modal {
		max-width: 500px;
		text-align: center;
	}

	/* Modal button (Doorgaan knop) */
	.modal-button {
		background: linear-gradient(145deg, #667eea, #764ba2);
		border: 1px solid rgba(102, 126, 234, 0.3);
		border-radius: 10px;
		padding: 12px 28px;
		font-weight: 600;
		font-size: 1rem;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
		color: #fff;
		box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
		margin-top: 10px;
	}

	.modal-button:hover {
		transform: translateY(-2px);
		box-shadow: 0 12px 28px rgba(102, 126, 234, 0.45);
		background: linear-gradient(145deg, #7a8ff0, #8a5cb8);
	}

	body.dark-mode .modal-button {
		background: linear-gradient(145deg, #4a5fb8, #5a3d8a);
		border-color: rgba(139, 159, 245, 0.4);
		box-shadow: 0 8px 20px rgba(74, 95, 184, 0.4);
	}

	body.dark-mode .modal-button:hover {
		background: linear-gradient(145deg, #5a6fc8, #6a4d9a);
		box-shadow: 0 12px 28px rgba(74, 95, 184, 0.55);
	}

	.unlock-modal-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
	}

	.unlock-icon {
		font-size: 64px;
		animation: unlock-bounce 0.6s ease-out;
	}

	@keyframes unlock-bounce {
		0% { transform: scale(0) rotate(-180deg); opacity: 0; }
		50% { transform: scale(1.2) rotate(10deg); }
		100% { transform: scale(1) rotate(0deg); opacity: 1; }
	}

	.unlock-title {
		font-size: 1.8rem;
		margin: 0;
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	body.dark-mode .unlock-title {
		background: linear-gradient(135deg, #8b9ff5 0%, #a77bc9 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	.unlock-items-container {
		width: 100%;
		display: flex;
		flex-direction: column;
		gap: 16px;
	}

	.unlock-item {
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
		border: 2px solid rgba(102, 126, 234, 0.3);
		border-radius: 12px;
		padding: 16px;
		display: flex;
		align-items: center;
		gap: 16px;
		animation: unlock-slide-in 0.4s ease-out backwards;
	}

	body.dark-mode .unlock-item {
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
		border-color: rgba(139, 159, 245, 0.4);
	}

	.unlock-item:nth-child(2) { animation-delay: 0.1s; }
	.unlock-item:nth-child(3) { animation-delay: 0.2s; }
	.unlock-item:nth-child(4) { animation-delay: 0.3s; }

	@keyframes unlock-slide-in {
		from { 
			opacity: 0; 
			transform: translateX(-30px);
		}
		to { 
			opacity: 1; 
			transform: translateX(0);
		}
	}

	.unlock-item-icon {
		font-size: 32px;
		flex-shrink: 0;
	}

	.unlock-item-content {
		flex: 1;
		text-align: left;
	}

	.unlock-item-name {
		font-weight: bold;
		font-size: 1.1rem;
		margin-bottom: 4px;
		color: #667eea;
	}

	body.dark-mode .unlock-item-name {
		color: #8b9ff5;
	}

	.unlock-item-description {
		font-size: 0.9rem;
		opacity: 0.8;
		margin: 0;
	}

	.unlock-item--feature {
		border-color: rgba(102, 126, 234, 0.5);
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
	}

	body.dark-mode .unlock-item--feature {
		border-color: rgba(139, 159, 245, 0.6);
		background: linear-gradient(145deg, rgba(102, 126, 234, 0.25), rgba(118, 75, 162, 0.25));
	}

	.unlock-item--feature .unlock-item-name {
		color: #8b6dff;
	}

	body.dark-mode .unlock-item--feature .unlock-item-name {
		color: #a899ff;
	}

	.unlock-item--challenge {
		border-color: rgba(255, 99, 71, 0.4);
		background: linear-gradient(145deg, rgba(255, 99, 71, 0.1), rgba(255, 140, 0, 0.1));
	}

	body.dark-mode .unlock-item--challenge {
		border-color: rgba(255, 140, 0, 0.5);
		background: linear-gradient(145deg, rgba(255, 99, 71, 0.15), rgba(255, 140, 0, 0.15));
	}

	.unlock-item--challenge .unlock-item-name {
		color: #ff6347;
	}

	body.dark-mode .unlock-item--challenge .unlock-item-name {
		color: #ff8c69;
	}

	body.dark-mode .round-summary-card {
		background: linear-gradient(145deg, rgba(46, 54, 78, 0.9), rgba(32, 39, 58, 0.95));
		border-color: rgba(255, 255, 255, 0.08);
		box-shadow: 0 18px 28px rgba(5, 8, 16, 0.6);
	}

	body.dark-mode .round-summary-card--coins {
		background: linear-gradient(145deg, rgba(66, 52, 22, 0.82), rgba(97, 76, 36, 0.92));
	}

	.round-summary-icon {
		display: block;
		font-size: 1.35rem;
		margin-bottom: 6px;
	}

	.round-summary-label {
		display: block;
		font-size: 0.75rem;
		letter-spacing: 0.18em;
		text-transform: uppercase;
		color: rgba(31, 36, 51, 0.7);
		margin-bottom: 4px;
	}

	body.dark-mode .round-summary-label {
		color: rgba(245, 246, 255, 0.6);
	}

	.round-summary-value {
		display: block;
		font-size: 2.1rem;
		font-weight: 700;
		color: #1f2433;
	}

	body.dark-mode .round-summary-value {
		color: #f5f6ff;
	}

	.round-summary-bonus {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		margin-top: 8px;
		padding: 4px 10px;
		border-radius: 999px;
		font-size: 0.78rem;
		font-weight: 600;
		background: rgba(31, 36, 51, 0.08);
		color: #1f2433;
	}

	body.dark-mode .round-summary-bonus {
		background: rgba(245, 246, 255, 0.15);
		color: #f5f6ff;
	}

	.round-summary-bonus--muted {
		opacity: 0.6;
	}

	.modal-summary-line {
		display: flex;
		justify-content: space-between;
		align-items: center;
		gap: 12px;
		padding: 6px 0;
		font-size: 0.95rem;
		line-height: 1.5;
		border-bottom: 1px solid rgba(20, 24, 36, 0.1);
	}

	.modal-summary-line:last-child {
		border-bottom: none;
	}

	body.dark-mode .modal-summary-line {
		border-color: rgba(255, 255, 255, 0.12);
	}

	#deck-modal {
		width: min(90vw, 780px);
		max-height: 80vh;
	}

	.deck-modal-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
		gap: 12px;
		margin-top: 14px;
		max-height: 56vh;
		overflow-y: auto;
		padding: 0 6px;
	}

	.deck-modal-grid::-webkit-scrollbar {
		width: 6px;
	}

	.deck-modal-grid::-webkit-scrollbar-thumb {
		background: rgba(80, 90, 110, 0.35);
		border-radius: 6px;
	}

	.deck-modal-grid .card-option {
		transform: none !important;
		width: 100%;
		max-width: 120px;
		min-height: 132px;
		margin: 0 auto;
		padding: 8px;
		gap: 8px;
		justify-content: flex-start;
	}

	/* The deck overview modal is a read-only preview: clicking should NOT select cards there. */
	#deck-modal-content.deck-modal-grid .card-option {
		pointer-events: none;
		cursor: default;
	}

	/* The golden unlock modal MUST be clickable (pick 1 of 3). */
	#golden-unlock-content.deck-modal-grid .card-option {
		pointer-events: auto;
		cursor: pointer;
	}

	.deck-modal-grid .card-pattern {
		gap: 3px;
	}

	/* Deck overview: smaller preview cells than the selectable hand cards. */
	.deck-modal-grid .card-option {
		--preview-cell: 14px;
	}

	.deck-modal-grid .deck-modal-card.deck-modal-card--depleted {
		opacity: 0.35;
		filter: saturate(35%);
	}

	.deck-modal-grid .deck-modal-card.deck-modal-card--in-hand {
		opacity: 0.55;
	}

	.deck-modal-grid .card-option:hover,
	.deck-modal-grid .card-option:focus {
		transform: none;
		box-shadow: 0 18px 26px rgba(10,12,20,0.2);
	}

	body.dark-mode .deck-modal-grid .card-option:hover,
	body.dark-mode .deck-modal-grid .card-option:focus {
		box-shadow: 0 26px 44px rgba(0,0,0,0.5);
	}

	.deck-modal-grid .card-option .card-label,
	.deck-modal-grid .card-option .card-meta {
		justify-content: center;
	}

	.deck-modal-empty {
		margin: 18px 0 6px;
		text-align: center;
		color: rgba(0, 0, 0, 0.6);
	}

	.blackhole-modal {
	  width: min(92vw, 760px);
	  max-height: 82vh;
	}

	.blackhole-card-grid {
	  margin-top: 16px;
	}

	.blackhole-card-grid .blackhole-card {
	  pointer-events: auto;
	  cursor: pointer;
	  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
	}

	.blackhole-card-grid .blackhole-card:hover {
	  transform: translateY(-4px);
	  box-shadow: 0 22px 36px rgba(40, 32, 88, 0.25);
	}

	.blackhole-card-grid .blackhole-card.selected {
	  border-color: rgba(120, 100, 220, 0.58);
	  box-shadow: 0 26px 44px rgba(70, 60, 160, 0.35);
	}

	.blackhole-stats {
	  display: flex;
	  flex-wrap: wrap;
	  justify-content: space-between;
	  gap: 12px;
	  font-size: 0.95rem;
	  color: rgba(20,24,36,0.82);
	}

	.blackhole-stats strong {
	  font-weight: 700;
	  color: #3a3570;
	}

	.blackhole-feedback {
	  min-height: 18px;
	  font-size: 0.9rem;
	  color: rgba(40,40,60,0.8);
	  margin-top: 6px;
	  transition: opacity 0.2s ease;
	  opacity: 0;
	}

	.blackhole-feedback.show {
	  opacity: 1;
	}

	.blackhole-feedback[data-tone="warn"] {
	  color: #c43838;
	}

	.blackhole-actions {
	  display: flex;
	  justify-content: flex-end;
	  gap: 10px;
	}

	.blackhole-actions button {
	  min-width: 140px;
	}

	body.dark-mode .deck-modal-grid::-webkit-scrollbar-thumb {
		background: rgba(160, 170, 210, 0.25);
	}

	body.dark-mode .deck-modal-empty {
		color: rgba(255, 255, 255, 0.65);
	}
	body.dark-mode .deck-modal-grid .card-option {
	  background: linear-gradient(160deg, #2d3142 0%, #232635 45%, #1b1e2c 100%);
	  border: 1px solid rgba(120,140,220,0.2);
	  box-shadow: 0 18px 32px rgba(0,0,0,0.45);
	}

	body.dark-mode .deck-modal-grid .card-option.card-golden {
	  background: linear-gradient(135deg, #5b4a14 0%, #8a6a1c 35%, #bf952a 70%, #e3c45e 100%);
	  border: 1px solid rgba(200,160,30,0.8);
	  box-shadow: 0 22px 40px rgba(0,0,0,0.58), inset 0 1px 0 rgba(255,255,255,0.08);
	}

	body.dark-mode .deck-modal-grid .card-option::after {
	  background: linear-gradient(120deg, rgba(255,255,255,0.18), rgba(255,255,255,0));
	  opacity: 0.35;
	}

	body.dark-mode .deck-modal-grid .card-option.card-golden::after {
	  opacity: 0.28;
	}
	body.dark-mode .blackhole-stats {
	  color: rgba(220, 224, 248, 0.82);
	}

	body.dark-mode .blackhole-stats strong {
	  color: #d4cffd;
	}

	body.dark-mode .blackhole-feedback {
	  color: rgba(210, 210, 248, 0.75);
	}

	body.dark-mode .blackhole-feedback[data-tone="warn"] {
	  color: #ff9a9a;
	}

	/* Rules Modal Styling */
	#rules-modal {
		max-height: 80vh;
		overflow-y: auto;
	}

	.rules-section {
		margin-bottom: 20px;
	}

	.rules-section:last-child {
		margin-bottom: 0;
	}

	.rules-section h3 {
		margin: 0 0 10px 0;
		font-size: 1.1rem;
		font-weight: 700;
		color: rgba(20,24,36,0.9);
	}

	.rules-section ul {
		margin: 8px 0;
		padding-left: 24px;
	}

	.rules-section li {
		margin-bottom: 6px;
		line-height: 1.5;
	}

	.rules-section p {
		margin: 8px 0;
		line-height: 1.6;
	}

	.rules-section strong {
		color: rgba(20,24,36,0.95);
		font-weight: 600;
	}

	body.dark-mode .rules-section h3 {
		color: rgba(255, 255, 255, 0.95);
	}

	body.dark-mode .rules-section strong {
		color: rgba(255, 255, 255, 0.9);
	}

	/* ============================================
	   DECK MODAL & SHOP - MOBILE
	   ============================================ */
	@media (max-width: 650px) {
		#deck-modal {
			width: min(96vw, 560px);
			max-height: 74vh;
			padding: 12px;
		}

		#deck-modal h2 {
			font-size: 0.98rem;
			margin-bottom: 4px;
		}

		#deck-modal .modal-subtext {
			font-size: 0.78rem;
		}

		.deck-modal-grid {
			grid-template-columns: repeat(auto-fit, minmax(64px, 1fr));
			gap: 12px;
			padding: 0 2px;
			max-height: 54vh;
		}

		.deck-modal-grid .card-option {
			max-width: 82px;
			min-height: 112px;
			padding: 4px !important;
			overflow: hidden;
		}

		.deck-modal-grid .card-pattern {
			gap: 2px;
		}

		.deck-modal-grid .card-option {
			--preview-cell: 9px;
		}

		.deck-modal-grid .card-option .card-label {
			font-size: 0.52rem;
			padding: 2px 6px;
			gap: 4px;
			letter-spacing: 0.05em;
			text-transform: none;
			white-space: nowrap;
			max-width: 100%;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.deck-modal-grid .card-option .card-label-dot {
			width: 6px;
			height: 6px;
		}

		.deck-modal-grid .card-option .card-meta {
			font-size: 0.52rem;
			letter-spacing: 0.03em;
			white-space: nowrap;
			max-width: 100%;
			overflow: hidden;
			text-overflow: ellipsis;
		}
	}

	@media (max-width: 450px) {
		/* Deck Modal - kleinere kaarten met betere spacing */
		#deck-modal {
			width: min(94vw, 420px);
			max-height: 75vh;
			padding: 10px;
		}

		.deck-modal-grid {
			grid-template-columns: repeat(auto-fit, minmax(58px, 1fr));
			gap: 10px;
			max-height: 54vh;
		}

		.deck-modal-grid .card-option {
			min-height: 72px;
			max-width: 72px;
			padding: 4px !important;
			transform: none !important;
			overflow: hidden;
		}

		.deck-modal-grid .card-pattern {
			gap: var(--preview-gap);
		}

		.deck-modal-grid .card-option {
			--preview-cell: 8px;
		}

		.deck-modal-grid .card-option .card-label {
			font-size: 0.5rem;
			padding: 2px 6px;
			gap: 4px;
			letter-spacing: 0.03em;
			text-transform: none;
			white-space: nowrap;
			max-width: 100%;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.deck-modal-grid .card-option .card-meta {
			font-size: 0.5rem;
			letter-spacing: 0.02em;
			white-space: nowrap;
			max-width: 100%;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		/* Shop Modal - compactere layout */
		#shop-modal {
			width: min(96vw, 420px) !important;
			max-height: 72vh;
			padding: 12px 14px;
			gap: 8px;
		}

		#shop-modal h2 {
			font-size: 0.88rem;
		}

		/* Verberg uitleg tekst */
		#shop-modal-message {
			display: none !important;
		}

		/* Verberg shop-card-header */
		.shop-card-header {
			display: none !important;
		}

		/* Shop cards - kleiner schalen */
		.shop-card {
			transform: scale(0.85);
			transform-origin: center;
			padding: 8px !important;
			gap: 6px !important;
		}

		.shop-card-list {
			grid-template-columns: repeat(2, 1fr) !important;
			gap: 16px;
		}

		.shop-card-preview {
			max-width: 100%;
		}

		.shop-card-preview .card-option {
			width: 100%;
			min-height: 120px;
		}

		/* Shop lower grid - force side by side with flexbox */
		.shop-lower-grid {
			display: flex !important;
			flex-direction: row !important;
			gap: 10px !important;
			width: 100% !important;
		}

		.shop-upgrades-section,
		.shop-bonus-section {
			flex: 1 1 0 !important;
			min-width: 0 !important;
			width: auto !important;
			max-width: none !important;
			padding: 12px !important;
			flex-direction: column !important;
			align-items: stretch !important;
			justify-content: flex-start !important;
			border-radius: 12px !important;
		}

		.shop-section-title {
			font-size: 0.72rem !important;
			margin-bottom: 10px !important;
		}

		.shop-section-title::before {
			font-size: 0.85rem !important;
		}

		.shop-upgrade-container {
			display: grid !important;
			grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
			gap: 10px !important;
			width: 100% !important;
		}

		/* Bonus container ook single column */
		.shop-bonus-container {
			display: flex !important;
			flex-direction: column !important;
			gap: 10px !important;
			width: 100% !important;
		}

		/* Bonus cards compacter - verticale layout */
		.shop-bonus-card {
			flex-direction: column !important;
			align-items: flex-start !important;
			gap: 8px !important;
			padding: 10px 12px !important;
		}

		.shop-bonus-info {
			width: 100%;
			gap: 8px !important;
			font-size: 0.75rem !important;
		}

		.shop-bonus-swatch {
			width: 16px !important;
			height: 16px !important;
		}

		.shop-bonus-actions {
			width: 100%;
		}

		.shop-bonus-actions button {
			width: 100%;
			padding: 8px 12px !important;
			font-size: 0.75rem !important;
		}

		.shop-upgrade-card {
			padding: 12px !important;
			gap: 8px !important;
		}

		.shop-upgrade-card::before {
			height: 2px !important;
		}

		.shop-upgrade-header {
			font-size: 0.8rem !important;
		}

		.upgrade-icon {
			width: 28px !important;
			height: 28px !important;
			font-size: 1rem !important;
			border-radius: 8px !important;
		}

		.shop-upgrade-desc {
			font-size: 0.7rem !important;
			line-height: 1.35 !important;
		}

		.shop-upgrade-actions button {
			padding: 8px 14px !important;
			font-size: 0.75rem !important;
			border-radius: 8px !important;
		}

		.shop-empty-state {
			padding: 14px !important;
			font-size: 0.72rem !important;
		}
	}

	/* ============================================
	   SHOP MODAL - BASIS (DESKTOP)
	   ============================================
	   Pop-up winkel waar je met munten extra kaarten en upgrades kunt kopen
	   2-kolommen layout: kaarten links, upgrades rechts
	*/
	#shop-modal {
		display: flex;
		flex-direction: column;
		gap: 18px;
		padding: 24px;
		background: linear-gradient(160deg, rgba(255,255,255,0.98), rgba(232,238,252,0.92));
		border: 1px solid rgba(60,70,140,0.12);
		box-shadow: 0 32px 54px rgba(12,18,38,0.25);
		border-radius: 20px;
		max-width: 920px;
		width: min(92vw, 920px);
		margin: auto;
		max-height: calc(100vh - 36px);
		overflow-y: auto;
		overscroll-behavior: contain;
		-webkit-overflow-scrolling: touch;
		contain: layout paint;
		scrollbar-width: thin;
		scrollbar-color: rgba(100, 120, 180, 0.5) transparent;
	}

	/* Shop overlay: avoid nested scrolling (keeps scrolling smooth inside the modal). */
	#shop-modal-layer {
		overflow: hidden;
		overscroll-behavior: contain;
	}
	
	#shop-modal::-webkit-scrollbar {
		width: 8px;
	}
	#shop-modal::-webkit-scrollbar-track {
		background: transparent;
		border-radius: 4px;
	}
	#shop-modal::-webkit-scrollbar-thumb {
		background: linear-gradient(180deg, rgba(100, 120, 180, 0.6), rgba(80, 100, 160, 0.4));
		border-radius: 4px;
		border: 1px solid rgba(255,255,255,0.2);
	}
	#shop-modal::-webkit-scrollbar-thumb:hover {
		background: linear-gradient(180deg, rgba(120, 140, 200, 0.8), rgba(100, 120, 180, 0.6));
	}

	body.dark-mode #shop-modal {
		background: linear-gradient(160deg, rgba(28,30,44,0.96), rgba(20,22,35,0.96));
		border-color: rgba(140,150,220,0.22);
		box-shadow: 0 34px 60px rgba(0,0,0,0.55);
		scrollbar-color: rgba(140, 160, 220, 0.4) transparent;
	}
	body.dark-mode #shop-modal::-webkit-scrollbar-thumb {
		background: linear-gradient(180deg, rgba(100, 120, 180, 0.5), rgba(80, 100, 160, 0.3));
		border-color: rgba(255,255,255,0.1);
	}
	body.dark-mode #shop-modal::-webkit-scrollbar-thumb:hover {
		background: linear-gradient(180deg, rgba(120, 140, 200, 0.6), rgba(100, 120, 180, 0.5));
	}
	body.dark-mode .shop-coin-display {
		background: linear-gradient(145deg, rgba(42,44,62,0.92), rgba(32,34,52,0.9));
		border-color: rgba(160, 178, 255, 0.24);
		box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08), 0 18px 34px rgba(0,0,0,0.5);
	}
	body.dark-mode .shop-coin-label {
		color: rgba(214, 220, 255, 0.72);
	}
	body.dark-mode .shop-coin-balance {
		color: #f6f7ff;
	}
	body.dark-mode .shop-coin-display.is-empty {
		background: linear-gradient(145deg, rgba(110, 32, 32, 0.4), rgba(140, 28, 28, 0.35));
		border-color: rgba(255, 120, 120, 0.35);
	}
	body.dark-mode .shop-coin-display.is-empty .shop-coin-label {
		color: rgba(255, 196, 196, 0.78);
	}
	body.dark-mode .shop-coin-display.is-empty .shop-coin-balance {
		color: rgba(255, 220, 220, 0.9);
	}

	.shop-modal-header {
		display: flex;
		flex-wrap: wrap;
		justify-content: space-between;
		align-items: center;
		gap: 16px;
	}

	.shop-coin-display {
		display: inline-flex;
		align-items: center;
		gap: 10px;
		padding: 6px 14px;
		border-radius: 999px;
		background: linear-gradient(145deg, rgba(255,255,255,0.96), rgba(236,246,255,0.92));
		border: 1px solid rgba(120,140,200,0.25);
		box-shadow: inset 0 0 0 1px rgba(255,255,255,0.25), 0 16px 28px rgba(14,22,48,0.16);
	}

	.shop-coin-label {
		font-size: 0.78rem;
		font-weight: 600;
		letter-spacing: 0.05em;
		text-transform: uppercase;
		color: rgba(24,32,60,0.68);
	}

	.shop-coin-balance {
		position: relative;
		font-weight: 700;
		font-size: 1.05rem;
		color: #1c253c;
		padding-left: 1.4em;
		min-width: 2.4em;
		text-align: right;
	}

	.shop-coin-balance::before {
		content: "";
		position: absolute;
		left: 0;
		top: 50%;
		transform: translateY(-50%);
		width: 1em;
		height: 1em;
		border-radius: 50%;
		background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 60%, #d49f20);
		box-shadow: inset 0 -2px 4px rgba(0,0,0,0.2), 0 1px 2px rgba(0,0,0,0.15);
		border: 1px solid #c9960a;
	}

	.shop-coin-display.is-empty {
		background: linear-gradient(145deg, rgba(245, 80, 80, 0.1), rgba(255, 140, 140, 0.12));
		border-color: rgba(220, 90, 90, 0.24);
	}

	.shop-coin-display.is-empty .shop-coin-label {
		color: rgba(160, 48, 48, 0.8);
	}

	.shop-coin-display.is-empty .shop-coin-balance {
		color: rgba(164, 52, 52, 0.9);
	}

	/* 2-kolommen grid voor shop inhoud */
	.shop-content-grid {
		display: flex;
		flex-direction: column;
		gap: 24px;
		margin-top: 12px;
		align-items: stretch;
	}
	
	.shop-lower-grid {
		display: grid;
		grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
		gap: 24px 28px;
		align-items: start;
	}

	/* Modal close button styling */
	.modal-close-btn {
		position: absolute;
		top: 16px;
		right: 16px;
		width: 32px;
		height: 32px;
		border: none;
		background: rgba(0,0,0,0.08);
		border-radius: 50%;
		font-size: 24px;
		line-height: 1;
		color: #666;
		cursor: pointer;
		transition: all 0.2s ease;
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 0;
		z-index: 10;
	}

	.modal-close-btn:hover {
		background: rgba(0,0,0,0.12);
		color: #333;
		transform: scale(1.1);
	}

	body.dark-mode .modal-close-btn {
		background: rgba(255,255,255,0.1);
		color: #ccc;
	}

	body.dark-mode .modal-close-btn:hover {
		background: rgba(255,255,255,0.15);
		color: #fff;
	}

	/* Elke sectie (kaarten of upgrades) */
	.shop-section {
		display: flex;
		flex-direction: column;
		gap: 16px;
	}

	.shop-upgrades-section,
	.shop-bonus-section,
	.shop-freeplace-section {
		display: flex;
		flex-direction: column;
		align-items: stretch;
		gap: 14px;
		padding: 20px;
		border-radius: 16px;
		background: linear-gradient(160deg, rgba(248,250,255,0.95), rgba(240,244,255,0.9));
		border: 1px solid rgba(40,55,120,0.12);
		box-shadow: 0 8px 24px rgba(12,18,38,0.08);
		position: relative;
	}

	.shop-upgrades-section::before,
	.shop-bonus-section::before,
	.shop-freeplace-section::before {
		content: '';
		position: absolute;
		top: 0;
		left: 20px;
		right: 20px;
		height: 1px;
		background: linear-gradient(90deg, transparent, rgba(40,55,120,0.15), transparent);
	}

	body.dark-mode .shop-upgrades-section,
	body.dark-mode .shop-bonus-section,
	body.dark-mode .shop-freeplace-section {
		background: linear-gradient(160deg, rgba(36,40,60,0.95), rgba(24,28,44,0.95));
		border-color: rgba(150,170,240,0.2);
		box-shadow: 0 12px 32px rgba(0,0,0,0.4);
	}

	body.dark-mode .shop-upgrades-section::before,
	body.dark-mode .shop-bonus-section::before,
	body.dark-mode .shop-freeplace-section::before {
		background: linear-gradient(90deg, transparent, rgba(150,170,240,0.2), transparent);
	}

	.shop-section-title {
		margin: 0 0 4px 0;
		font-size: 0.85rem;
		font-weight: 700;
		letter-spacing: 0.08em;
		text-transform: uppercase;
		color: rgba(20,24,46,0.6);
		display: flex;
		align-items: center;
		gap: 8px;
	}

	.shop-section-title::before {
		content: 'âš™ï¸';
		font-size: 1rem;
	}

	.shop-bonus-section .shop-section-title::before {
		content: 'ðŸŽ';
	}

	body.dark-mode .shop-section-title {
		color: rgba(240,242,255,0.6);
	}

	.shop-upgrade-container {
		margin-top: 0;
		padding: 0;
		border-radius: 0;
		background: transparent;
		border: none;
		box-shadow: none;
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 12px;
	}

	.shop-empty-state {
		margin: 0;
		padding: 20px;
		font-size: 0.85rem;
		font-weight: 500;
		color: rgba(24,32,52,0.55);
		text-align: center;
		background: rgba(0,0,0,0.03);
		border-radius: 12px;
		border: 1px dashed rgba(40,55,120,0.15);
	}

	body.dark-mode .shop-empty-state {
		color: rgba(235,238,255,0.5);
		background: rgba(255,255,255,0.03);
		border-color: rgba(150,170,240,0.15);
	}

	/* Kaarten sectie (links) met rechter border */
	.shop-cards-section {
		border-right: 1px solid rgba(40,55,120,0.12);
		padding-right: 20px;
	}

	@media (max-width: 720px) {
		.shop-cards-section {
			border-right: none;
			padding-right: 0;
			border-bottom: 1px solid rgba(40,55,120,0.12);
			padding-bottom: 18px;
		}
		.shop-upgrades-section,
		.shop-bonus-section {
			padding: 16px;
		}
		body.dark-mode .shop-cards-section {
			border-bottom-color: rgba(140,150,200,0.22);
		}
		.shop-card-list {
			grid-template-columns: 1fr;
		}
		.shop-card-price {
			align-self: flex-start;
		}
		.shop-card-actions {
			margin-top: 0;
		}
	}

	/* Grid van kaarten in de shop */
	.shop-card-list {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
		gap: 24px;
		align-items: stretch;
	}

	#shop-card-options {
		flex: 1 1 auto;
	}

	#shop-upgrade-container {
		flex: 0 0 auto;
	}

	body.dark-mode .shop-section-title {
		color: rgba(240,242,255,0.85);
	}

	body.dark-mode .shop-cards-section {
		border-right-color: rgba(140,150,200,0.25);
	}

	.shop-section--empty {
		opacity: 0.75;
	}

	.shop-empty-state {
		margin: 0;
		font-size: 0.84rem;
		font-weight: 600;
		color: rgba(24,32,52,0.68);
	}

	body.dark-mode .shop-empty-state {
		color: rgba(235,238,255,0.64);
	}

	/* Individuele shop kaart met prijs en koop knop */
	.shop-card {
		border: 2px solid rgba(40, 55, 120, 0.15);
		border-radius: 20px;
		padding: 20px;
		background: linear-gradient(155deg, rgba(255,255,255,0.98), rgba(248,252,255,0.95));
		display: flex;
		flex-direction: column;
		gap: 16px;
		box-shadow: 0 4px 16px rgba(12,18,38,0.08), 0 12px 40px rgba(12,18,38,0.12);
		transition: transform 0.2s ease, box-shadow 0.2s ease;
		position: relative;
		overflow: hidden;
	}
	
	.shop-card::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		height: 4px;
		background: linear-gradient(90deg, #ffb347, #ffda76, #ffc65d);
		opacity: 0;
		transition: opacity 0.2s ease;
	}
	
	.shop-card:hover {
		transform: translateY(-4px);
		box-shadow: 0 8px 24px rgba(12,18,38,0.12), 0 16px 48px rgba(12,18,38,0.16);
	}
	
	.shop-card:hover::before {
		opacity: 1;
	}
	
	.shop-card-random {
		border-color: rgba(255, 215, 0, 0.4);
		background: linear-gradient(155deg, rgba(255,252,245,0.98), rgba(255,248,235,0.95));
	}
	
	.shop-card-random::before {
		background: linear-gradient(90deg, #ffd700, #ffed4e, #ffd700);
	}

	body.dark-mode .shop-card {
		background: linear-gradient(155deg, rgba(38,42,58,0.95), rgba(28,32,48,0.95));
		border-color: rgba(160, 170, 240, 0.22);
		box-shadow: 0 4px 16px rgba(0,0,0,0.25), 0 12px 40px rgba(0,0,0,0.35);
	}
	
	body.dark-mode .shop-card:hover {
		box-shadow: 0 8px 24px rgba(0,0,0,0.35), 0 16px 48px rgba(0,0,0,0.45);
	}
	
	body.dark-mode .shop-card-random {
		border-color: rgba(255, 215, 0, 0.3);
		background: linear-gradient(155deg, rgba(48,44,32,0.95), rgba(38,36,28,0.95));
	}

	.shop-card-header {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 12px;
		font-weight: 700;
		font-size: 1.05rem;
	}
	
	/* Verberg lege header voor random kaarten */
	.shop-card-random .shop-card-header:empty {
		display: none;
	}
	
	.shop-card-header span:first-child {
		flex: 1;
		color: #1a2644;
	}
	
	body.dark-mode .shop-card-header span:first-child {
		color: #e8ebff;
	}
	
	.card-meta {
		font-size: 0.75rem;
		font-weight: 700;
		padding: 4px 10px;
		border-radius: 12px;
		background: rgba(100, 120, 200, 0.12);
		color: #3d4e7a;
		letter-spacing: 0.05em;
		text-transform: uppercase;
	}
	
	body.dark-mode .card-meta {
		background: rgba(120, 140, 220, 0.18);
		color: #a8b8ff;
	}

	.shop-card-price {
		font-size: 1rem;
		font-weight: 700;
		color: #e67e22;
		letter-spacing: 0.02em;
		padding: 6px 14px;
		background: rgba(230, 126, 34, 0.08);
		border-radius: 12px;
		display: inline-block;
	}

	body.dark-mode .shop-card-price {
		color: #ffb84d;
		background: rgba(255, 184, 77, 0.12);
	}

	.shop-card-preview {
		display: flex;
		justify-content: center;
		align-items: center;
		padding: 20px;
		border-radius: 16px;
		background: linear-gradient(145deg, rgba(235,242,255,0.6), rgba(245,248,255,0.8));
		border: 1px solid rgba(100, 120, 200, 0.08);
		min-height: 160px;
	}

	body.dark-mode .shop-card-preview {
		background: linear-gradient(145deg, rgba(20,24,36,0.4), rgba(28,32,44,0.6));
		border-color: rgba(120, 140, 220, 0.12);
	}

	.shop-card-actions {
		display: flex;
		justify-content: stretch;
		align-items: center;
		margin-top: 4px;
	}

	.shop-card-actions button {
		flex: 1;
		background: linear-gradient(145deg, #ffb347, #ff9f33);
		border: 2px solid rgba(230, 126, 34, 0.3);
		border-radius: 14px;
		padding: 12px 24px;
		font-weight: 700;
		font-size: 0.95rem;
		letter-spacing: 0.04em;
		cursor: pointer;
		transition: all 0.2s ease;
		box-shadow: 0 4px 12px rgba(255, 140, 50, 0.25);
		color: #fff;
		text-shadow: 0 1px 2px rgba(0,0,0,0.2);
	}

	.shop-card-actions button:hover:not(:disabled) {
		transform: translateY(-2px);
		box-shadow: 0 6px 20px rgba(255, 140, 50, 0.35);
		background: linear-gradient(145deg, #ffc55a, #ffb347);
	}
	
	.shop-card-actions button:active:not(:disabled) {
		transform: translateY(0);
	}

	.shop-card-actions button:disabled {
		cursor: not-allowed;
		opacity: 0.5;
		box-shadow: none;
		background: linear-gradient(145deg, #aaa, #999);
		border-color: rgba(100, 100, 100, 0.3);
	}

	.shop-upgrade-container {
		margin-top: 0;
		padding: 0;
		border-radius: 0;
		background: transparent;
		border: none;
		box-shadow: none;
		display: grid;
		grid-template-columns: repeat(2, minmax(0, 1fr));
		gap: 12px;
		width: 100%;
	}

	.shop-upgrade-card {
		min-width: 0;
	}

	/* Mystery Card Styles */
	.mystery-card-container {
		width: 100%;
		height: 200px;
		perspective: 1000px;
		position: relative;
	}

	.mystery-card-inner {
		width: 100%;
		height: 100%;
		transition: transform 0.8s;
		transform-style: preserve-3d;
		position: relative;
	}

	.mystery-card-inner.flipped {
		transform: rotateY(180deg);
	}

	.mystery-card-front,
	.mystery-card-back {
		position: absolute;
		width: 100%;
		height: 100%;
		backface-visibility: hidden;
		display: flex;
		align-items: center;
		justify-content: center;
		border-radius: 12px;
	}

	.mystery-card-front {
		background: linear-gradient(145deg, #4a4a4a, #2a2a2a);
		border: 2px solid rgba(255, 215, 0, 0.5);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
	}

	.mystery-card-front .question-mark {
		font-size: 96px;
		font-weight: bold;
		color: #ffd700;
		text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
		animation: pulse 2s ease-in-out infinite;
	}

	@keyframes pulse {
		0%, 100% {
			opacity: 1;
			transform: scale(1);
		}
		50% {
			opacity: 0.7;
			transform: scale(1.1);
		}
	}

	.mystery-card-back {
		transform: rotateY(180deg);
		background: white;
		padding: 15px;
	}

	body.dark-mode .mystery-card-back {
		background: rgba(28,32,44,0.95);
	}

	.shop-upgrade-container h3 {
		margin: 0;
		font-size: 0.92rem;
	}

	.shop-upgrade-container p {
		margin: 0;
		font-size: 0.78rem;
		color: rgba(20,24,36,0.7);
	}

	.shop-upgrade-actions {
		display: flex;
		gap: 10px;
		align-items: center;
		flex-wrap: wrap;
	}

	.shop-upgrade-actions button {
		background: linear-gradient(145deg, #ffe580, #ffbd4f);
		border: 1px solid rgba(140, 95, 10, 0.35);
		color: #5a2d00;
		border-radius: 999px;
		padding: 7px 16px;
		font-weight: 700;
		letter-spacing: 0.04em;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease;
	}

	.shop-upgrade-actions button:disabled {
		opacity: 0.5;
		cursor: not-allowed;
		transform: none;
		box-shadow: none;
	}

	.shop-upgrade-actions button:not(:disabled):hover {
		transform: translateY(-1px);
		box-shadow: 0 10px 18px rgba(180,120,20,0.26);
	}

	.shop-bonus-container {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
		gap: 14px;
		align-items: start;
	}

	.shop-bonus-card {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 12px;
		padding: 10px 14px;
		border-radius: 14px;
		background: rgba(255,255,255,0.78);
		border: 1px solid rgba(40,55,120,0.12);
		box-shadow: 0 14px 26px rgba(12,18,38,0.12);
		height: 100%;
	}

	body.dark-mode .shop-bonus-card {
		background: rgba(28,30,48,0.92);
		border-color: rgba(150,170,240,0.18);
		box-shadow: 0 16px 30px rgba(0,0,0,0.45);
	}

	.shop-bonus-info {
		display: flex;
		align-items: center;
		gap: 10px;
		font-weight: 600;
		color: rgba(26,34,52,0.88);
	}

	body.dark-mode .shop-bonus-info {
		color: rgba(235,238,255,0.88);
	}

	.shop-bonus-swatch {
		width: 20px;
		height: 20px;
		border-radius: 6px;
		border: 2px solid rgba(0,0,0,0.08);
		box-shadow: inset 0 0 0 1px rgba(255,255,255,0.4);
	}

	body.dark-mode .shop-bonus-swatch {
		border-color: rgba(255,255,255,0.12);
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.35);
	}

	.shop-bonus-actions button {
		background: linear-gradient(145deg, #8be6ff, #44bdf1);
		border: 1px solid rgba(20,60,120,0.24);
		border-radius: 999px;
		padding: 7px 16px;
		font-weight: 700;
		color: #04344f;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease;
		box-shadow: 0 12px 20px rgba(68,189,241,0.26);
	}

	.shop-bonus-actions button:hover:not(:disabled) {
		transform: translateY(-1px);
		box-shadow: 0 16px 28px rgba(68,189,241,0.32);
	}

	.shop-bonus-actions button:disabled {
		opacity: 0.45;
		cursor: not-allowed;
		box-shadow: none;
	}

	body.dark-mode .shop-bonus-actions button {
		color: #062f45;
	}
	body.dark-mode .shop-bonus-upgrade-btn {
		background: linear-gradient(145deg, #d8a640, #f0c04f);
		border-color: rgba(255,223,128,0.4);
		color: #fff6d2;
	}

	.shop-bonus-upgrade-btn {
		background: linear-gradient(145deg, #ffe580, #ffbd4f);
		border: 1px solid rgba(140, 95, 10, 0.35);
		color: #5a2d00;
	}

	.shop-bonus-upgrade-btn:hover:not(:disabled) {
		transform: translateY(-1px);
		box-shadow: 0 14px 24px rgba(180,120,20,0.25);
	}

	.shop-bonus-status {
		display: inline-flex;
		align-items: center;
		gap: 6px;
		font-size: 0.78rem;
		font-weight: 700;
		padding: 6px 12px;
		border-radius: 999px;
		background: linear-gradient(135deg, rgba(255,255,255,0.85), rgba(240,245,255,0.75));
		border: 1px solid rgba(120,140,200,0.28);
		color: rgba(26,32,52,0.78);
	}

	body.dark-mode .shop-bonus-status {
		background: linear-gradient(135deg, rgba(40,42,60,0.9), rgba(32,34,52,0.88));
		border-color: rgba(180,196,255,0.26);
		color: rgba(236,240,255,0.85);
	}

	.shop-upgrade-note {
		font-size: 0.72rem;
		color: rgba(20,24,36,0.65);
	}

	.shop-upgrade-card {
		padding: 16px 18px;
		border-radius: 16px;
		background: linear-gradient(155deg, rgba(255,255,255,0.95), rgba(248,250,255,0.9));
		border: 1px solid rgba(40,55,120,0.12);
		box-shadow: 0 8px 24px rgba(12,18,38,0.1);
		display: flex;
		flex-direction: column;
		gap: 12px;
		height: 100%;
		transition: transform 0.2s ease, box-shadow 0.2s ease;
		position: relative;
		overflow: hidden;
	}

	.shop-upgrade-card::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		height: 3px;
		background: linear-gradient(90deg, #a78bfa, #818cf8, #6366f1);
		opacity: 0.7;
	}

	.shop-upgrade-card:hover {
		transform: translateY(-2px);
		box-shadow: 0 12px 32px rgba(12,18,38,0.15);
	}

	.shop-upgrade-card--locked {
		opacity: 0.6;
	}

	.shop-upgrade-card--locked::before {
		background: linear-gradient(90deg, #9ca3af, #6b7280);
	}

	.shop-upgrade-card--owned::before {
		background: linear-gradient(90deg, #34d399, #10b981, #059669);
	}

	.shop-upgrade-header {
		display: flex;
		align-items: center;
		gap: 10px;
		font-weight: 700;
		font-size: 0.95rem;
		color: #1a2644;
	}

	.upgrade-icon {
		font-size: 1.4rem;
		width: 36px;
		height: 36px;
		display: flex;
		align-items: center;
		justify-content: center;
		background: linear-gradient(145deg, rgba(167,139,250,0.15), rgba(129,140,248,0.1));
		border-radius: 10px;
		flex-shrink: 0;
	}

	.shop-upgrade-desc {
		margin: 0;
		font-size: 0.82rem;
		color: rgba(20,24,36,0.7);
		line-height: 1.45;
	}

	.shop-upgrade-price {
		display: inline-flex;
		align-items: center;
		gap: 4px;
		font-size: 0.85rem;
		font-weight: 700;
		color: #e67e22;
		padding: 4px 10px;
		background: rgba(230, 126, 34, 0.1);
		border-radius: 8px;
		margin-top: auto;
	}

	.shop-upgrade-actions {
		display: flex;
		gap: 10px;
		align-items: center;
		flex-wrap: wrap;
		margin-top: auto;
	}

	.shop-upgrade-actions button {
		background: linear-gradient(145deg, #a78bfa, #818cf8);
		border: none;
		color: #fff;
		border-radius: 10px;
		padding: 10px 18px;
		font-weight: 700;
		font-size: 0.85rem;
		letter-spacing: 0.03em;
		cursor: pointer;
		transition: transform 0.2s ease, box-shadow 0.2s ease;
		box-shadow: 0 4px 12px rgba(129,140,248,0.3);
	}

	.shop-upgrade-actions button:disabled {
		opacity: 0.5;
		cursor: not-allowed;
		transform: none;
		box-shadow: none;
		background: linear-gradient(145deg, #9ca3af, #6b7280);
	}

	.shop-upgrade-actions button:not(:disabled):hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 20px rgba(129,140,248,0.4);
	}

	body.dark-mode .shop-upgrade-note {
		color: rgba(240,242,255,0.65);
	}

	body.dark-mode .shop-upgrade-card {
		background: linear-gradient(155deg, rgba(38,42,58,0.95), rgba(28,32,48,0.95));
		border-color: rgba(150,170,240,0.2);
		box-shadow: 0 8px 24px rgba(0,0,0,0.35);
	}

	body.dark-mode .shop-upgrade-card:hover {
		box-shadow: 0 12px 32px rgba(0,0,0,0.45);
	}

	body.dark-mode .shop-upgrade-header {
		color: #e8ebff;
	}

	body.dark-mode .upgrade-icon {
		background: linear-gradient(145deg, rgba(167,139,250,0.25), rgba(129,140,248,0.15));
	}

	body.dark-mode .shop-upgrade-desc {
		color: rgba(240,242,255,0.7);
	}

	body.dark-mode .shop-upgrade-price {
		color: #ffb84d;
		background: rgba(255, 184, 77, 0.15);
	}

	body.dark-mode .shop-upgrade-actions button {
		background: linear-gradient(145deg, #a78bfa, #818cf8);
		color: #fff;
	}

	body.dark-mode .shop-card-actions button {
		background: linear-gradient(145deg, #ffa940, #ff8835);
		border-color: rgba(255, 255, 255, 0.16);
	}

	.shop-card .card-option {
		flex: 0 0 auto;
		width: 138px;
		min-height: 180px;
		padding: 0;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: 12px;
		border-radius: 16px;
		background: linear-gradient(165deg, #ffffff 0%, #eef2ff 45%, #dfe4ff 100%);
		border: 1px solid rgba(40,55,120,0.18);
		box-shadow: 0 18px 26px rgba(10,12,20,0.2);
		position: relative;
		overflow: hidden;
		transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
	}

	.shop-card .card-option::after {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: inherit;
		background: linear-gradient(120deg, rgba(255,255,255,0.65), rgba(255,255,255,0) 58%);
		opacity: 0.45;
		pointer-events: none;
	}

	.shop-card .card-option > * {
		position: relative;
		z-index: 1;
	}

	.shop-card .card-pattern {
		display: grid;
		gap: 4px;
		align-items: center;
		justify-items: center;
	}

	.shop-card .card-option .card-cell {
		width: 22px;
		height: 22px;
		/* Border-radius: max 5px, minder rond */
		border-radius: min(5px, calc(22px / 5));
		border: 1px solid rgba(12,16,30,0.12);
		box-shadow: inset 0 0 4px rgba(0,0,0,0.18);
		background: rgba(255,255,255,0.95);
	}

	.shop-card .card-label {
		display: inline-flex;
		align-items: center;
		gap: 6px;
		padding: 5px 10px;
		border-radius: 999px;
		background: rgba(30, 40, 70, 0.08);
		font-size: 0.72rem;
		font-weight: 600;
		letter-spacing: 0.04em;
		color: #2a2f45;
		box-shadow: inset 0 0 0 1px rgba(40,55,120,0.16);
	}

	.shop-card .card-label-dot {
		display: inline-block;
		width: 10px;
		height: 10px;
		border-radius: 50%;
		box-shadow: 0 0 6px rgba(0,0,0,0.2);
	}

	.shop-card .card-meta {
		font-size: 0.75rem;
		font-weight: 600;
		letter-spacing: 0.05em;
		text-transform: uppercase;
		color: rgba(30, 35, 60, 0.85);
	}

	body.dark-mode .shop-card .card-option {
		background: rgba(20, 24, 36, 0.82);
		border-color: rgba(255, 255, 255, 0.16);
		box-shadow: 0 18px 36px rgba(0, 0, 0, 0.5);
	}

	body.dark-mode .shop-card .card-option::after {
		background: linear-gradient(120deg, rgba(255,255,255,0.24), rgba(255,255,255,0) 62%);
	}

	body.dark-mode .shop-card .card-option .card-cell {
		border-color: rgba(255,255,255,0.08);
		background: rgba(32, 36, 52, 0.92);
	}

	body.dark-mode .shop-card .card-label {
		background: rgba(255,255,255,0.1);
		color: #f3f4ff;
		box-shadow: inset 0 0 0 1px rgba(255,255,255,0.18);
	}

	body.dark-mode .shop-card .card-meta {
		color: rgba(240, 242, 255, 0.75);
	}

	/* Mobile shop modal optimization */
	@media (max-width: 650px) {
		.game-modal {
			padding: 14px;
			width: clamp(320px, 94vw, 480px);
		}

		#shop-modal {
			width: clamp(320px, 94vw, 480px);
			max-height: 72vh;
			padding: 10px 16px;
			gap: 10px;
			overflow-y: auto;
		}

		#shop-modal h2 {
			font-size: 0.94rem;
			margin: 0 0 4px;
		}

		#shop-modal p {
			font-size: 0.74rem;
			margin: 0 0 6px 0;
		}

		.shop-content-grid {
			display: grid;
			grid-template-columns: minmax(0, 1fr);
			gap: 12px;
			margin-top: 8px;
			align-items: start;
		}

		.shop-section {
			min-width: 220px;
		}

		.shop-cards-section {
			border: none;
			padding-right: 0;
			padding-bottom: 0;
		}

		#shop-card-options {
			max-height: none;
			overflow: visible;
		}

		.shop-card-list {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
			gap: 10px;
			margin-top: 8px;
		}

		.shop-card {
			padding: 10px;
			gap: 8px;
			align-items: center;
		}

		.shop-card .card-option {
			width: 100%;
			max-width: none;
			min-height: 110px;
			gap: 6px;
		}

		.shop-card .card-pattern {
			gap: 2px;
		}

		.shop-card .card-option .card-cell {
			width: 12px;
			height: 12px;
			/* Border-radius: max 5px, minder rond */
			border-radius: min(5px, calc(12px / 5));
		}

		.shop-card .card-label {
			padding: 3px 6px;
			font-size: 0.6rem;
			gap: 3px;
		}

		.shop-card .card-label-dot {
			width: 6px;
			height: 6px;
		}

		.shop-card .card-meta {
			font-size: 0.62rem;
		}

		.shop-card-price {
			font-size: 0.78rem;
		}

		.shop-card-actions {
			width: 100%;
		}

		.shop-card-actions button {
			padding: 5px 10px;
			font-size: 0.78rem;
		}

		.modal-actions {
			gap: 8px;
			margin-top: 10px;
		}

		.modal-actions button {
			padding: 7px 14px;
			font-size: 0.84rem;
		}

		.shop-upgrade-container {
			padding: 0;
			margin-top: 0;
			display: grid;
			grid-template-columns: repeat(2, minmax(0, 1fr));
			gap: 10px;
		}

		.shop-upgrade-card {
			padding: 8px 10px;
			gap: 6px;
			height: 100%;
		}

		.shop-upgrade-header {
			font-size: 0.8rem;
			gap: 6px;
		}

		.upgrade-icon {
			font-size: 1rem;
		}

		.shop-upgrade-desc {
			font-size: 0.68rem;
			line-height: 1.35;
		}

		.shop-upgrade-price {
			font-size: 0.78rem;
		}

		.shop-upgrade-actions {
			justify-content: flex-start;
		}

		.shop-upgrade-actions button {
			padding: 5px 10px;
			font-size: 0.74rem;
		}
	}


	@media (max-width: 520px) {
		#shop-modal {
			width: clamp(300px, 96vw, 420px);
			max-height: 70vh;
			padding: 10px 14px;
			gap: 8px;
		}

		#shop-modal h2 {
			font-size: 0.9rem;
		}

		#shop-modal p {
			font-size: 0.72rem;
		}

		.shop-content-grid {
			grid-template-columns: minmax(0, 1fr);
			gap: 10px;
		}

		.shop-section-title {
			font-size: 0.8rem;
		}

		.shop-card-list {
			grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
			gap: 8px;
		}

		.shop-card {
			padding: 8px;
			gap: 6px;
		}

		.shop-card .card-option {
			min-height: 104px;
		}

		.shop-card .card-option .card-cell {
			width: 11px;
			height: 11px;
			/* Border-radius erft van base regel */
		}

		.shop-card-header {
			font-size: 0.74rem;
		}

		.shop-card-price {
			font-size: 0.76rem;
		}

		.shop-card-actions button {
			padding: 4px 10px;
			font-size: 0.76rem;
		}

		.modal-actions button {
			padding: 6px 12px;
			font-size: 0.82rem;
		}

		.shop-upgrade-card {
			padding: 7px 9px;
		}

		.shop-upgrade-header {
			font-size: 0.78rem;
		}

		.upgrade-icon {
			font-size: 0.96rem;
		}

		.shop-upgrade-desc {
			font-size: 0.65rem;
		}

		.shop-upgrade-container {
			grid-template-columns: repeat(2, minmax(0, 1fr));
			gap: 9px;
		}

		.shop-upgrade-actions button {
			padding: 4px 10px;
			font-size: 0.72rem;
		}
	}

	@media (max-width: 380px) {
		#shop-modal {
			width: clamp(280px, 96vw, 360px);
			max-height: 68vh;
			padding: 9px 12px;
			gap: 6px;
		}

		#shop-modal h2 {
			font-size: 0.86rem;
		}

		#shop-modal p {
			font-size: 0.68rem;
		}

		.shop-content-grid {
			grid-template-columns: minmax(0, 1fr);
			gap: 9px;
		}

		.shop-section-title {
			font-size: 0.76rem;
		}

		.shop-card-list {
			grid-template-columns: repeat(auto-fit, minmax(115px, 1fr));
			gap: 7px;
		}

		.shop-card {
			padding: 7px;
		}

		.shop-card .card-option {
			min-height: 98px;
		}

		.shop-card .card-option .card-cell {
			width: 10px;
			height: 10px;
			/* Border-radius erft van base regel */
		}

		.shop-card-header {
			font-size: 0.7rem;
		}

		.shop-card-price {
			font-size: 0.72rem;
		}

		.shop-card-actions button {
			padding: 4px 9px;
			font-size: 0.72rem;
		}

		.modal-actions {
			margin-top: 8px;
		}

		.modal-actions button {
			padding: 6px 10px;
			font-size: 0.8rem;
		}

		.shop-upgrade-card {
			padding: 6px 9px;
		}

		.shop-upgrade-header {
			font-size: 0.74rem;
		}

		.upgrade-icon {
			font-size: 0.92rem;
		}

		.shop-upgrade-desc {
			font-size: 0.62rem;
		}

		.shop-upgrade-container {
			grid-template-columns: repeat(2, minmax(0, 1fr));
			gap: 8px;
		}

		.shop-upgrade-actions button {
			padding: 4px 9px;
			font-size: 0.7rem;
		}
	}

	/* VERWIJDERD: Dubbele #card-choice-zone .card-option styling - deze stond al eerder gedefinieerd */

	@keyframes coinPop {
	  0% { transform: translate(-50%, -50%) scale(0); opacity: 0.2; }
	  70% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
	  100% { transform: translate(-50%, -50%) scale(1); }
	}

	.objective-toast {
		position: fixed;
		top: 18px;
		left: 50%;
		transform: translateX(-50%);
		background: linear-gradient(135deg, #1f2a4d 0%, #283663 60%, #1e2959 100%);
		color: #f0f4ff;
		padding: 10px 18px;
		border-radius: 999px;
		font-size: 0.85rem;
		font-weight: 600;
		letter-spacing: 0.04em;
		box-shadow: 0 14px 28px rgba(10,22,60,0.35);
		opacity: 0;
		pointer-events: none;
		transition: opacity 0.25s ease, transform 0.25s ease;
		z-index: 1200;
	}

	body.dark-mode .objective-toast {
		background: linear-gradient(135deg, #101423 0%, #1a1f33 65%, #181c2b 100%);
		color: #f7f9ff;
		box-shadow: 0 16px 28px rgba(0,0,0,0.5);
	}

	.objective-toast.show {
		opacity: 1;
		transform: translateX(-50%) translateY(0);
	}


	@keyframes growRoot {
	  from { opacity: 0; transform: scale(0.5); }
	  to { opacity: 1; transform: scale(1); }
	}

	/* === Mobile layout (<=650px): keep compact 23-10 HUD === */
	@media (max-width: 650px) {
		body {
			display: block;
			position: relative;
			width: 100%;
			min-height: 100svh;
			height: 100svh;
			margin: 0;
			padding: 16px 8px calc(var(--bottom-bar-clearance) + 24px);
			padding-top: 62px;
			box-sizing: border-box;
			background: linear-gradient(180deg, #171822 0%, #101018 55%, #0a0b12 100%);
			color: #f5f6ff;
			overflow-x: hidden;
			overflow-y: hidden;
		}

		html {
			background: #101018;
		}

		body.dark-mode {
			background: linear-gradient(180deg, #0b0c10 0%, #040406 100%);
			color: #f5f6ff;
		}

		#mobile-objective-banner {
			display: flex;
			position: fixed;
			top: calc(env(safe-area-inset-top, 0px) + 4px);
			left: 10px;
			right: 10px;
			z-index: calc(var(--z-blur) + 20);
			justify-content: center;
			pointer-events: none;
		}

		body.zoomed-in #mobile-objective-banner {
			filter: none;
		}

		#mobile-objective-banner #objective-zone {
			pointer-events: none;
			width: min(100%, 328px);
			padding: 10px 12px 8px;
			gap: 4px;
			border-radius: 14px;
			box-shadow: 0 12px 26px rgba(10,18,35,0.28);
		}

		/* Mobile: force objective panel to stack (avoid desktop flex-row quirks and odd number spacing). */
		#mobile-objective-banner #objective-zone {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			text-align: center;
		}
		#mobile-objective-banner #objective-current {
			display: block;
			width: 100%;
			text-align: center;
		}
		#mobile-objective-banner #objective-current strong {
			white-space: nowrap;
		}

		#mobile-objective-banner #objective-zone h2 {
			margin: 0;
			font-size: 0.66rem;
			letter-spacing: 0.08em;
			text-transform: uppercase;
			color: rgba(20,24,36,0.72);
		}

		body.dark-mode #mobile-objective-banner #objective-zone h2 {
			color: rgba(230,235,255,0.8);
		}

		#mobile-objective-banner .objective-current {
			font-size: 0.78rem;
			line-height: 1.35;
		}

		#mobile-objective-banner .objective-history {
			display: none;
		}

		/* ============================================
		   HAMBURGER MENU KNOP (MOBIEL)
		   ============================================
		   Gouden ronde knop linksboven met 3 streepjes
		   Opent/sluit het controls menu
		   Animeer naar X wanneer open (.active class)
		*/
		#menu-toggle {
			position: fixed;
			left: 8px;
			top: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			flex-direction: column;
			gap: 3px;
			width: 30px;
			height: 30px;
			padding: 6px;
			border-radius: 6px;
			background: linear-gradient(145deg, #ffd560, #ffb23c);
			border: 1px solid rgba(255,255,255,0.35);
			box-shadow: 0 4px 10px rgba(0,0,0,0.28);
			cursor: pointer;
			transition: transform 0.2s ease, box-shadow 0.2s ease;
			z-index: var(--z-menu);
		}

		#menu-toggle:hover {
			transform: scale(1.05);
			box-shadow: 0 6px 14px rgba(0,0,0,0.32);
		}

		#menu-toggle span {
			display: block;
			width: 14px;
			height: 2px;
			background: #1c1c1c;
			border-radius: 2px;
			transition: transform 0.28s ease, opacity 0.28s ease;
		}

		#menu-toggle.active span:nth-child(1) { transform: translateY(6px) rotate(45deg); }
		#menu-toggle.active span:nth-child(2) { opacity: 0; }
		#menu-toggle.active span:nth-child(3) { transform: translateY(-6px) rotate(-45deg); }

		body.dark-mode #menu-toggle {
			background: linear-gradient(145deg, #2f3546, #1c2233);
			border-color: rgba(255,255,255,0.12);
		}

		body.dark-mode #menu-toggle span {
			background: rgba(255,255,255,0.88);
		}

		/* ============================================
		   CONTROLS MENU (MOBIEL)
		   ============================================
		   Pop-up menu met game controls (nieuw spel, reset, dark mode, etc.)
		   Verschijnt naast hamburger knop wanneer .open class wordt toegevoegd
		   Alleen op mobiel (<650px), op desktop is dit altijd fixed zichtbaar
		*/
		#controls {
			position: fixed;
			left: 64px;
			top: 12px;
			right: auto;
			bottom: auto;
			transform: translateX(0);
			opacity: 1;
			pointer-events: auto;
			background: rgba(18,20,28,0.96);
			border: 1px solid rgba(255,255,255,0.14);
			border-radius: 12px;
			padding: 10px 12px;
			box-shadow: 0 8px 20px rgba(0,0,0,0.38);
			transition: transform 0.28s ease, opacity 0.2s ease;
			z-index: calc(var(--z-controls) - 1);
			display: none;
			flex-direction: column;
			gap: 6px;
			min-width: 160px;
		}

		#controls.open {
			transform: translateX(0);
			opacity: 1;
			pointer-events: auto;
			display: flex;
		}

		body.dark-mode #controls {
			background: rgba(8,9,14,0.96);
			border-color: rgba(255,255,255,0.1);
		}

		#controls button {
			background: rgba(255,255,255,0.08);
			border: 1px solid rgba(255,255,255,0.18);
			color: #f5f6ff;
			padding: 10px 14px;
			border-radius: 8px;
			cursor: pointer;
			transition: background 0.2s ease;
			width: 100%;
			text-align: left;
			font-size: 0.9rem;
		}

		#controls button:disabled {
			opacity: 0.55;
			cursor: not-allowed;
		}

		#controls #debug-mode-toggle {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 12px;
			font-weight: 600;
		}

		#controls #debug-mode-toggle.debug-active {
			background: linear-gradient(145deg, rgba(112,198,255,0.28), rgba(72,132,255,0.32));
			border-color: rgba(112, 198, 255, 0.5);
			box-shadow: inset 0 0 0 1px rgba(255,255,255,0.18);
		}

		#controls button:hover:not(:disabled) {
			background: rgba(255,255,255,0.12);
		}

		/* Dark mode toggle binnen het menu (alleen mobiel) */
		#mobile-dark-mode-toggle {
			margin-top: 0;
		}

		body.dark-mode #mobile-dark-mode-toggle::before {
			content: 'â˜€ï¸ ';
		}

		body.dark-mode #mobile-dark-mode-toggle {
			background: rgba(255,255,255,0.12);
		}

		/* ============================================
		   BOTTOM BAR (MOBIEL)
		   ============================================
		   Vaste strip onderaan met kaarten, score en munten
		   Altijd zichtbaar tijdens mobiel spelen
		   Bevat:
		   - Kaart keuze (3 opties)
		   - Score overzicht (compacte dots)
		   - Munten teller
		   - Bonus status
		*/
		#bottom-bar {
			position: fixed;
			left: 0;
			right: 0;
			bottom: var(--bottom-bar-bottom-offset);
			height: auto;
			min-height: var(--bottom-bar-height);
			padding: 0 0 6px;
			padding-left: calc(5px + env(safe-area-inset-left, 0px));
			padding-right: calc(5px + env(safe-area-inset-right, 0px));
			display: flex;
			flex-direction: column;
			background: linear-gradient(180deg, rgba(47,50,68,0.95) 0%, rgba(33,36,52,0.97) 52%, rgba(22,24,36,0.98) 100%);
			border-radius: 18px 18px 0 0;
			border-top: 1px solid rgba(255,255,255,0.16);
			box-shadow: 0 -18px 40px rgba(0,0,0,0.42);
			backdrop-filter: blur(12px);
			-webkit-backdrop-filter: blur(12px);
			overflow-x: hidden;
			overflow-y: hidden;
			overscroll-behavior-y: contain;
			clip-path: none;
			z-index: var(--z-bottom);
		}

		body.dark-mode #bottom-bar {
			background: linear-gradient(180deg, rgba(20,22,32,0.96) 0%, rgba(14,16,26,0.98) 55%, rgba(8,9,16,0.99) 100%);
			border-top-color: rgba(255,255,255,0.1);
		}

		#bottom-bar-cards {
			display: flex;
			align-items: center;
			justify-content: flex-start;
			gap: 0;
			overflow-x: hidden;
			overflow-y: hidden;
			overscroll-behavior: contain;
			touch-action: pan-x;
			scrollbar-width: none; /* Firefox */
			-ms-overflow-style: none; /* IE/Edge legacy */
			padding: 0;
			margin-top: 0;
			transform: none;
			scroll-snap-type: x mandatory;
			border-radius: 0;
			background: transparent;
			border: none;
			flex: 0 0 auto;
			height: 100px;
			min-height: 80px;
			position: relative;
			z-index: 10;
			clip-path: none;
		}

		br {
		display: none;
		}

		.bottom-bar-footer {
			display: flex;
			justify-content: space-between;
			align-items: flex-end;
			gap: 0;
			padding: 0 4px 0;
			transform: none;
		}

		#bottom-bar-score-coins {
			display: flex;
			flex-direction: row;
			align-items: flex-end;
			justify-content: space-between;
			gap: 8px;
			width: 100%;
		}

		#bottom-bar-score,
		#bottom-bar-coins {
			display: flex;
			align-items: center;
		}

		#bottom-bar-score {
			justify-content: flex-start;
			flex: 1 1 auto;
			min-width: 0;
			max-width: 450px;
		}

		#bottom-bar-coins {
			justify-content: flex-end;
			flex: 0 0 auto;
			flex-direction: column;
			align-items: flex-end;
			gap: 4px;
			min-width: 0;
		}

		#bottom-bar-cards::-webkit-scrollbar {
			display: none;
		}

		#card-choice-zone {
			flex: 1 0 auto;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			background: none;
			width: 100%;
			height: 100%;
			padding: 0;
			margin: 0;
			overflow: visible;
			clip-path: none;
		}

		/* In de mobile bottom bar moet het kaartvlak geen â€œlos panelâ€ zijn.
		   Dit voorkomt een asymmetrische aflopende rand onder de kaarten. */
		#bottom-bar #card-choice-zone {
			background: transparent;
			border: none;
			border-radius: 0;
			box-shadow: none;
			position: relative;
			z-index: 0;
		}

		#card-controls {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: space-between;
			gap: 8px;
			width: 100%;
			position: relative;
			z-index: 12;
			overflow: visible;
			clip-path: none;
		}

		#card-options {
			flex: 1 1 auto;
			min-width: 0;
			max-width: none;
			overflow: visible;
			clip-path: none;
		}

		#card-action-buttons {
			display: flex;
			flex-direction: column;
			gap: 6px;
			align-items: center;
			justify-content: center;
			flex: 0 0 auto;
			width: auto;
			min-width: 0;
			max-width: none;
			margin: 0;
			padding-top: 0;
	}

	#card-action-buttons .deck-preview {
		order: 3;
		margin: 0;
	}

#card-action-buttons #new-cards-btn {
	order: 0;
}	#card-action-buttons #rotate-card-btn,
	#card-action-buttons #mirror-card-btn {
		order: 1;
		display: none; /* Verberg in mobiel, toon alleen in floating preview */
	}

	#card-action-buttons #turn-counter-inline {
		order: 4;
	}		#card-action-buttons .card-action-btn {
			min-height: 50px;
			width: 50px;
			flex: 0 0 auto;
			padding: 0;
			border-radius: 14px;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 0;
			font-size: 1rem;
			letter-spacing: 0;
			text-transform: none;
			box-shadow: 0 12px 22px rgba(10,12,20,0.25);
		}

		#card-action-buttons .card-action-btn::after {
			display: none;
		}

		#card-action-buttons .card-action-btn::before {
			font-size: 1.6rem;
		}

		/* Deck preview: zelfde stijl als card action buttons */
		#card-action-buttons .deck-preview {
			min-height: 50px;
			width: 50px;
			flex: 0 0 auto;
			padding: 0;
			border-radius: 14px;
			display: flex;
			align-items: center;
			justify-content: center;
			background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
			border: 1px solid rgba(26,32,48,0.16);
			box-shadow: 0 12px 22px rgba(10,12,20,0.25);
		}

		#card-action-buttons .deck-preview::after {
			display: none;
		}

	#card-action-buttons .deck-count {
		position: static;
		min-width: auto;
		padding: 0;
		background: none;
		border: none;
		box-shadow: none;
		font-size: 1rem;
		font-weight: 700;
		color: #2b3148;
	}		#turn-counter-inline {
			margin-top: 0;
			padding: 4px 8px;
			font-size: 0.7rem;
			box-shadow: 0 6px 12px rgba(10,12,20,0.18);
			border-radius: 10px;
		}

		#card-choice-zone::-webkit-scrollbar { display: none; }
		#kiesKaartTitel { display: none; }

		#card-controls {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: space-between;
			gap: 8px;
			width: 100%;
			position: relative;
		}

		.hand-scroll-btn {
			display: none;
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			width: 24px;
			height: 24px;
			border-radius: 999px;
			border: 1px solid rgba(26,32,48,0.16);
			background: rgba(239,243,255,0.7);
			box-shadow: 0 6px 10px rgba(10,12,20,0.14);
			color: rgba(74,82,104,0.85);
			font-size: 16px;
			font-weight: 900;
			line-height: 1;
			align-items: center;
			justify-content: center;
			z-index: 25;
			cursor: pointer;
			user-select: none;
			pointer-events: auto;
		}

		#card-controls.hand-scroll-enabled .hand-scroll-btn {
			display: inline-flex;
		}

		#hand-scroll-left {
			left: calc(6px + env(safe-area-inset-left, 0px));
		}

		#hand-scroll-right {
			/* Keep clear of the action button column on the right. */
			right: calc(58px + env(safe-area-inset-right, 0px));
		}

		#card-controls.hand-scroll-enabled #hand-scroll-left:disabled,
		#card-controls.hand-scroll-enabled #hand-scroll-right:disabled {
			opacity: 0.45;
			cursor: default;
			box-shadow: none;
		}

		#bottom-bar #card-options {
			display: flex;
			gap: 6px;
			align-items: stretch;
			justify-content: flex-start;
			flex-wrap: nowrap;
			scroll-snap-type: x proximity;
			flex: 1 1 auto;
			min-width: 0;
			width: auto;
			max-width: none;
			padding: 0;
			margin: 0;
			transform: translateY(0px);
			position: relative;
			z-index: 20;
			overflow-x: auto;
			overflow-y: hidden;
			touch-action: pan-x;
			clip-path: none;
		}

		#bottom-bar #card-options::-webkit-scrollbar { display: none; }

		#bottom-bar #new-cards-btn {
			display: flex;
			align-items: center;
			justify-content: center;
			height: 44px;
			width: 44px;
			padding: 0;
			margin: 0;
			font-weight: 400;
			font-size: 1.5rem;
			cursor: pointer;
			border-radius: 10px;
			border: 1px solid rgba(26,32,48,0.16);
			background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
			box-shadow: 0 8px 14px rgba(10,12,20,0.22);
			transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.3s ease, border-color 0.3s ease;
			position: relative;
		}

		#bottom-bar #new-cards-btn::before {
			content: 'â†’';
			color: #4a5268;
			font-size: 1.8rem;
			font-weight: 700;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			transition: color 0.3s ease;
		}

		#bottom-bar #new-cards-btn.ready-for-next-turn {
			background: linear-gradient(155deg, #fef8e7 0%, #f0c149 100%);
			border-color: rgba(20,24,36,0.14);
		}

		#bottom-bar #new-cards-btn.ready-for-next-turn::before {
			color: #5a4a1e;
		}

		#bottom-bar #new-cards-btn:disabled {
			background: linear-gradient(155deg, #eff3ff 0%, #dbe2f6 100%);
			border-color: rgba(26,32,48,0.16);
			box-shadow: none;
			opacity: 0.6;
			cursor: default;
			transform: none;
			pointer-events: none;
		}

		#bottom-bar #new-cards-btn:disabled::before {
			color: rgba(74,82,104,0.6);
		}

		#bottom-bar #new-cards-btn.complete-round {
			background: linear-gradient(155deg, #e8f5e9 0%, #66bb6a 100%);
			border-color: rgba(46,125,50,0.3);
		}

		#bottom-bar #new-cards-btn.complete-round::before {
			content: 'âœ“';
			color: #1b5e20;
			font-size: 2rem;
			font-weight: 900;
		}

		@media (max-width: 520px) {
			#card-controls {
				gap: 6px;
			}

			#bottom-bar #new-cards-btn {
				height: 40px;
				width: 40px;
				border-radius: 10px;
			}

			#bottom-bar #new-cards-btn::before {
				font-size: 1.6rem;
			}

			#card-action-buttons .card-action-btn,
			#card-action-buttons .deck-preview {
				min-height: 44px;
				width: 44px;
				border-radius: 12px;
			}

			#hand-scroll-right {
				right: calc(54px + env(safe-area-inset-right, 0px));
			}

			/* Keep only the total coin text in the bottom bar. */
			#bottom-bar .coin,
			#bottom-bar #collected-coins {
				display: none !important;
			}
		}

		#bottom-bar #rotate-card-btn {
			display: none; /* Verberg in mobiel, alleen in floating preview */
		}

		#bottom-bar #rotate-card-btn::before {
			content: 'â†»';
			color: #4a5268;
			font-size: 1.6rem;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}

		#bottom-bar #new-cards-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 12px 20px rgba(10,12,20,0.26);
		}

		#bottom-bar #rotate-card-btn:hover:not(:disabled) {
			transform: translateY(-1px);
			box-shadow: 0 10px 18px rgba(10,12,20,0.26);
		}

		#bottom-bar #rotate-card-btn:disabled {
			opacity: 0.6;
			box-shadow: none;
			transform: none;
		}

		body.dark-mode #bottom-bar #new-cards-btn {
			color: #f5f6ff;
			border-color: rgba(255,255,255,0.16);
			background: linear-gradient(155deg, #3c3f55 0%, #25283a 100%);
			box-shadow: 0 10px 18px rgba(0,0,0,0.4);
		}

		body.dark-mode #bottom-bar #new-cards-btn::before {
			color: rgba(255,255,255,0.75);
		}

		body.dark-mode #bottom-bar #new-cards-btn.ready-for-next-turn {
			background: linear-gradient(155deg, #ffd560 0%, #ffb23c 100%);
			border-color: rgba(255,255,255,0.35);
		}

		body.dark-mode #bottom-bar #new-cards-btn.ready-for-next-turn::before {
			color: #1c1c1c;
		}

		body.dark-mode #bottom-bar #new-cards-btn:disabled {
			background: linear-gradient(155deg, #3c3f55 0%, #25283a 100%);
			border-color: rgba(255,255,255,0.16);
			box-shadow: none;
			opacity: 0.6;
			cursor: default;
			transform: none;
			pointer-events: none;
		}

		body.dark-mode #bottom-bar #new-cards-btn:disabled::before {
			color: rgba(245,246,255,0.6);
		}

		body.dark-mode #bottom-bar #new-cards-btn.complete-round {
			background: linear-gradient(155deg, #2e7d32 0%, #1b5e20 100%);
			border-color: rgba(129,199,132,0.3);
		}

		body.dark-mode #bottom-bar #new-cards-btn.complete-round::before {
			color: #a5d6a7;
		}

		body.dark-mode #bottom-bar #rotate-card-btn {
			color: #f4f6ff;
			border-color: rgba(255,255,255,0.18);
			background: linear-gradient(155deg, #2b3247 0%, #1c2233 100%);
			box-shadow: 0 9px 18px rgba(0,0,0,0.4);
		}

		body.dark-mode #bottom-bar #rotate-card-btn:disabled {
			opacity: 0.5;
			box-shadow: none;
		}

		#bottom-bar #card-choice-zone .card-option {
			flex: 1 1 auto;
			width: var(--hand-card-width, 75px);
			max-width: var(--hand-card-width, 75px);
			min-height: var(--hand-card-height, 100px);
			padding: 4px 5px 6px;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			gap: 3px;
			border-radius: 12px;
			background: linear-gradient(165deg, #ffffff 0%, #eef2ff 45%, #dfe4ff 100%);
			border: 1px solid rgba(40,55,120,0.16);
			box-shadow: 0 20px 35px rgba(10,12,20,0.35), 0 8px 16px rgba(10,12,20,0.2);
			scroll-snap-align: center;
			transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
			position: relative;
			overflow: hidden;
			z-index: 15;
		}

		#bottom-bar #card-choice-zone .card-option::after {
			content: "";
			position: absolute;
			inset: 0;
			border-radius: inherit;
			background: linear-gradient(120deg, rgba(255,255,255,0.65), rgba(255,255,255,0) 58%);
			opacity: 0.45;
			pointer-events: none;
		}

		#bottom-bar #card-choice-zone .card-option > * {
			position: relative;
			z-index: 1;
		}

		#bottom-bar #card-choice-zone .card-option:hover {
			transform: translateY(-6px);
			box-shadow: 0 26px 44px rgba(20,30,60,0.32);
		}

		#bottom-bar #card-choice-zone .card-option.selected {
			border-color: rgba(82,118,255,0.6);
			box-shadow: 0 28px 48px rgba(70,90,180,0.45);
		}

		#bottom-bar #card-choice-zone .card-pattern {
			display: grid;
			gap: var(--preview-gap);
			align-items: center;
			justify-items: center;
		}

		#bottom-bar #card-choice-zone .card-option .card-cell {
			width: 7px;
			height: 7px;
			/* Border-radius: max 5px, minder rond */
			border-radius: min(5px, calc(7px / 5));
			border: 1px solid rgba(12,16,30,0.1);
			box-shadow: inset 0 0 1px rgba(0,0,0,0.12);
		}

		#bottom-bar #card-choice-zone .card-label {
			display: inline-flex;
			align-items: center;
			gap: 2px;
			padding: 2px 5px;
			border-radius: 999px;
			background: rgba(20,24,36,0.06);
			font-size: 0.56rem;
			font-weight: 600;
			letter-spacing: 0.055em;
			text-transform: uppercase;
			color: rgba(20,24,36,0.62);
		}

		#bottom-bar #card-choice-zone .card-label span {
			display: inline-block;
		}

		#bottom-bar #card-choice-zone .card-label-dot {
			width: 6px;
			height: 6px;
			border-radius: 50%;
			box-shadow: 0 0 3px rgba(0,0,0,0.22);
		}

		#bottom-bar #card-choice-zone .card-meta {
			font-size: 0.6rem;
			letter-spacing: 0.045em;
			color: rgba(20,24,36,0.52);
		}

		body.dark-mode #bottom-bar #card-choice-zone .card-option {
			background: linear-gradient(160deg, #2d3142 0%, #232635 45%, #1b1e2c 100%);
			border-color: rgba(120,140,220,0.18);
			box-shadow: 0 20px 34px rgba(0,0,0,0.5);
		}

		body.dark-mode #bottom-bar #card-choice-zone .card-option::after {
			opacity: 0.25;
		}

		body.dark-mode #bottom-bar #card-choice-zone .card-option .card-cell {
			border-color: rgba(255,255,255,0.08);
			box-shadow: inset 0 0 6px rgba(0,0,0,0.35);
		}

		body.dark-mode #bottom-bar #card-choice-zone .card-label {
			background: rgba(255,255,255,0.08);
			color: rgba(255,255,255,0.8);
		}

		body.dark-mode #bottom-bar #card-choice-zone .card-label-dot {
			box-shadow: 0 0 6px rgba(0,0,0,0.45);
		}

		body.dark-mode #bottom-bar #card-choice-zone .card-meta {
			color: rgba(255,255,255,0.65);
		}

		@media (max-width: 450px) {
			#bottom-bar #card-options {
				transform: none;
			}

			#bottom-bar #card-choice-zone .card-option {
				width: var(--hand-card-width, 50px);
				min-height: var(--hand-card-height, 65px);
				padding: 2px;
			}

			#bottom-bar #card-choice-zone .card-option .card-cell {
				width: 7px;
				height: 7px;
			}

			#bottom-bar #card-choice-zone .card-label {
				font-size: 0.4rem;
			}

			#bottom-bar #card-choice-zone .card-meta {
				font-size: 0.45rem;
			}
			
			#turn-counter-inline {
				display: none;
			}
		}

		#bottom-bar #scoreboard {
			width: 100%;
			max-width: none;
			margin: 0;
			padding: 2px 3px;
			background: rgba(18,20,28,0.9);
			border: 1px solid rgba(255,255,255,0.12);
			border-radius: 10px;
			box-shadow: 0 8px 16px rgba(0,0,0,0.26);
			display: flex;
			flex-direction: row;
			flex-wrap: nowrap;
			gap: 4px;
			justify-content: space-between;
			align-items: center;
			color: #f5f6ff;
		}

		body.dark-mode #bottom-bar #scoreboard {
			background: rgba(12,14,22,0.92);
			border-color: rgba(255,255,255,0.14);
			color: #f5f6ff;
		}

		#bottom-bar #scoreboard::-webkit-scrollbar { display: none; }

		#bottom-bar #scoreboard::before,
		#bottom-bar #scoreboard hr {
			display: none;
		}

		#bottom-bar #scoreboard h2 {
			display: none;
		}

		#bottom-bar #scoreboard .score-row {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: center;
			gap: 4px;
			padding: 2px 4px;
			background: rgba(255,255,255,0.08);
			border-radius: 6px;
			color: inherit;
			font-size: 0.64rem;
			min-width: 0;
			flex: 1 1 auto;
		}

		#bottom-bar #scoreboard .score-row .color-box {
			width: 9px;
			height: 9px;
			border-radius: 50%;
			box-shadow: 0 0 5px rgba(0,0,0,0.26);
			flex-shrink: 0;
		}

		#bottom-bar #scoreboard .score-row .label {
			display: none;
		}

		#bottom-bar #scoreboard .score-row .score {
			margin: 0;
			font-weight: 700;
			font-size: 0.7rem;
			line-height: 1;
		}

		#bottom-bar #scoreboard .score-total {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: center;
			gap: 4px;
			padding: 2px 5px;
			background: rgba(255,255,255,0.12);
			border-radius: 6px;
			font-weight: 700;
			font-size: 0.72rem;
			min-width: 0;
			flex: 1 1 auto;
			box-shadow: none;
			border: none;
			color: inherit;
		}

		#bottom-bar #scoreboard .score-total::before {
			content: none;
		}

		#bottom-bar #scoreboard .score-total .label {
			display: inline;
			font-size: 0.6rem;
			letter-spacing: 0.04em;
			opacity: 0.75;
			line-height: 1;
		}

		#bottom-bar #scoreboard .score-total .total-score {
			font-size: 0.88rem;
			font-weight: 700;
			line-height: 1;
		}

		#bottom-bar #scoreboard .trap-summary {
			padding: 4px 6px;
			gap: 3px;
			border: none;
			border-radius: 6px;
			background: rgba(255,255,255,0.08);
		}

		#bottom-bar #scoreboard .trap-summary-header .trap-label,
		#bottom-bar #scoreboard .trap-summary-header .trap-count {
			display: none;
		}

		body.dark-mode #bottom-bar #scoreboard .trap-summary {
			background: rgba(255,255,255,0.04);
		}

		#bottom-bar #scoreboard .trap-summary-header {
			font-size: 0.58rem;
			letter-spacing: 0.05em;
		}

		#bottom-bar #scoreboard .trap-count {
			font-size: 0.62rem;
		}

		#bottom-bar #scoreboard .trap-preview {
			gap: 3px;
			padding-bottom: 0;
		}

		#bottom-bar #scoreboard .trap-preview.trap-preview--compact {
			gap: 4px;
		}

		#bottom-bar #scoreboard .trap-preview:empty::after {
			display: none;
		}

		#bottom-bar #scoreboard .trap-compact-chip {
			font-size: 0.62rem;
			padding: 1px 6px;
			border-radius: 12px;
		}

		#bottom-bar #scoreboard .trap-icon {
			width: 26px;
			height: 26px;
			border-radius: 8px;
			font-size: 1rem;
			box-shadow: 0 3px 6px rgba(196,56,56,0.16);
		}

		#bottom-bar #scoreboard .trap-icon .penalty-chip {
			right: -4px;
			bottom: -4px;
			font-size: 0.55rem;
			padding: 1px 4px;
		}

		#bottom-bar #scoreboard .trap-icon.trap-icon--black-hole {
			box-shadow: 0 4px 8px rgba(80,60,160,0.2);
		}

		#bottom-bar #gold-zone {
			width: auto;
			max-width: 100%;
			margin: 0;
			padding: 2px 6px;
			background: rgba(18,20,28,0.9);
			border: 1px solid rgba(255,255,255,0.12);
			border-radius: 8px;
			box-shadow: 0 8px 16px rgba(0,0,0,0.26);
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: center;
			gap: 6px;
			color: #f5f6ff;
			height: auto;
			min-height: 0;
		}

		body.dark-mode #bottom-bar #gold-zone {
			background: rgba(12,14,22,0.92);
			border-color: rgba(255,255,255,0.14);
		}

		#bottom-bar #gold-zone h2 {
			display: none;
		}

		/* Deck preview (binnen card-action-buttons) */
		.deck-preview {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			gap: 4px;
			flex: 0 0 auto;
			cursor: pointer;
			background: none;
			border: none;
			box-shadow: none;
			padding: 0;
			min-height: 0;
			transition: transform 0.15s ease;
		}

		.deck-preview:hover {
			transform: translateY(-2px);
		}

		#card-action-buttons .deck-preview {
			order: 3;
			width: 100%;
		}
		
		/* Verberg het ðŸ“š icoon in mobiele versie - alleen deck-count tonen */
		#card-action-buttons .deck-preview::before {
			display: none;
		}

		#card-action-buttons .deck-preview::after {
			display: none;
		}

		#card-action-buttons .deck-preview:focus-visible {
			outline: 2px solid rgba(255,215,80,0.7);
			outline-offset: 4px;
		}

		body.dark-mode #card-action-buttons .deck-preview:focus-visible {
			outline-color: rgba(120,160,255,0.65);
		}

		#bottom-bar #card-action-buttons {
			position: relative;
		}

		#bottom-bar #card-action-buttons .deck-preview {
			position: static;
		}

		.deck-count {
			background: linear-gradient(145deg, #ffd560, #ffb23c);
			border: 1px solid rgba(255,255,255,0.35);
			border-radius: 10px;
			padding: 6px 10px;
			font-size: 0.95rem;
			font-weight: 700;
			color: #1c1c1c;
			box-shadow: 0 6px 12px rgba(0,0,0,0.26);
			min-width: 46px;
			text-align: center;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 4px;
			pointer-events: auto;
		}

		.deck-preview:focus-visible .deck-count {
			outline: 3px solid rgba(255, 215, 80, 0.9);
			outline-offset: 3px;
		}

		body.dark-mode .deck-preview:focus-visible .deck-count {
			outline-color: rgba(120, 160, 255, 0.8);
		}

		.deck-count::before {
			content: 'ðŸ“š';
			font-size: 1.1rem;
		}

		body.dark-mode .deck-count {
			background: linear-gradient(145deg, #2f3546, #1c2233);
			border-color: rgba(255,255,255,0.12);
			color: rgba(255,255,255,0.88);
		}

		.preview-card {
			display: none;
		}


		#bottom-bar #gold-zone h2 {
			display: none;
		}

		/* Mobile: keep coin counter next to the buy button. */
		#bottom-bar #gold-zone::before {
			display: none;
			content: none;
		}
		#bottom-bar #gold-zone::after {
			content: '\1FA99  ' attr(data-coin-text);
			display: inline-flex;
			align-items: center;
			justify-content: center;
			order: 1;
			text-align: center;
			font-size: 0.82rem;
			font-weight: 800;
			color: #f5f6ff;
			padding: 0;
			background: transparent;
			border: none;
			white-space: nowrap;
			opacity: 0.92;
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial, sans-serif, "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji";
		}

		#bottom-bar #collected-coins {
			display: none !important;
		}
		
		/* Mobiele +1 blokplaatsing knop */
		#bottom-bar .buy-placement-btn {
			padding: 4px 8px;
			font-size: 0.7rem;
			border-radius: 6px;
			margin: 0;
			gap: 3px;
		}
		#bottom-bar .buy-placement-arrow {
			font-size: 0.9rem;
		}
		#bottom-bar .buy-placement-rainbow-cell {
			width: 14px;
			height: 14px;
			/* Border-radius: max 5px, minder rond */
			border-radius: min(5px, calc(14px / 5));
		}
		#bottom-bar .buy-placement-cost {
			padding: 1px 4px;
			font-size: 0.65rem;
		}

		#bottom-bar .coin {
			width: 13px;
			height: 13px;
			border-radius: 50%;
			background: rgba(255,255,255,0.18);
			border: 1px solid rgba(255,255,255,0.26);
			box-shadow: inset 0 0 0 1px rgba(0,0,0,0.22), 0 0 4px rgba(0,0,0,0.2);
			transition: transform 0.2s ease, background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
		}

		#bottom-bar .coin.active {
			background: radial-gradient(circle at 30% 30%, #fff6b5, #f7bb36 70%);
			border-color: #f3b12b;
			box-shadow: 0 0 8px rgba(255,209,90,0.78), inset 0 0 2px rgba(255,255,255,0.85);
			transform: scale(1.05);
		}

		#bottom-bar .coin.used {
			background: rgba(80,82,95,0.65);
			border-color: rgba(120,124,140,0.6);
			box-shadow: inset 0 0 0 1px rgba(0,0,0,0.4);
			transform: scale(1);
		}

		body.dark-mode #bottom-bar .coin {
			background: rgba(255,255,255,0.14);
			border-color: rgba(255,255,255,0.24);
		}

		body.dark-mode #bottom-bar .coin.used {
			background: rgba(60,60,72,0.7);
			border-color: rgba(110,110,130,0.55);
			box-shadow: inset 0 0 0 1px rgba(0,0,0,0.55);
			transform: scale(1);
		}

		body.dark-mode #bottom-bar .coin.active {
			background: radial-gradient(circle at 30% 30%, #ffe58c, #f5b72f 70%);
		}

		/* Mobile bonus-inventory: hide labels, show only swatches + counts */
		@media (max-width: 650px) {
			/* Two-row footer:
			   - row 1 (top): bonus inventory + coin total + buy button
			   - row 2 (bottom): scoreboard
			   Keeps everything visible with minimal height. */
			#bottom-bar-left {
				display: flex;
				flex-direction: column;
				align-items: stretch;
				justify-content: flex-start;
				gap: 6px;
				width: 100%;
				min-width: 0;
			}

			#bottom-bar-bonus {
				display: flex !important;
				flex-direction: row;
				align-items: center;
				justify-content: flex-start;
				gap: 8px;
				min-width: 0;
				padding: 0;
			}

			#bottom-bar-score-coins {
				display: flex;
				flex-direction: row;
				gap: 0;
				align-items: stretch;
			}

			#bottom-bar-score {
				flex: 1 1 auto;
				min-width: 0;
			}

			/* Give the bonus inventory most of the width (70/30 split vs coins) WITHOUT leaving a visible gap. */
			#bottom-bar-bonus {
				gap: 6px;
			}
			#bottom-bar-bonus #bonus-zone {
				flex: 1 1 auto;
				min-width: 0;
			}
			#bottom-bar-bonus #gold-zone {
				flex: 0 0 auto;
				min-width: 0;
			}

			#bottom-bar #gold-zone {
				flex: 0 1 auto;
			}

			#bottom-bar #buy-placement-container {
				flex: 0 1 auto;
				display: flex;
				align-items: center;
				justify-content: center;
				order: 2;
				margin: 0;
				padding: 0;
			}

			/* Inside the bottom bar, the bonus zone should not look like a big panel. */
			#bottom-bar #bonus-zone {
				background: transparent !important;
				border: none !important;
				box-shadow: none !important;
				padding: 0 !important;
				gap: 0 !important;
			}

			#bottom-bar #bonus-zone h2,
			#bottom-bar #bonus-zone .bonus-hint {
				display: none !important;
			}

			/* One-line, low-height bonus badges: must fit 5 side-by-side. */
			#bottom-bar .bonus-inventory {
				display: flex;
				flex-wrap: nowrap;
				gap: 3px;
				align-items: center;
				justify-content: space-between;
				overflow: hidden;
				padding: 0;
			}
			#bottom-bar .bonus-inventory::-webkit-scrollbar { display: none; }

			#bottom-bar .bonus-badge {
				flex: 1 1 0;
				min-width: 0;
				padding: 2px 4px;
				border-radius: 10px;
				gap: 3px;
				font-size: 0.58rem;
				line-height: 1;
				justify-content: center;
			}

			#bottom-bar .bonus-badge .bonus-swatch {
				width: 10px;
				height: 10px;
			}

			#bottom-bar .bonus-badge .bonus-count {
				margin-left: 0;
				font-size: 0.58rem;
				padding: 0 4px;
			}

			/* #gold-zone is styled as a compact pill globally; no special nesting needed. */

			#bottom-bar #gold-zone::after {
				font-size: 0.82rem;
				font-weight: 800;
			}

			#bottom-bar .buy-placement-btn {
				padding: 4px 8px;
				font-size: 0.66rem;
				border-radius: 8px;
				margin-top: 0 !important;
			}

			#bottom-bar .buy-placement-cost {
				font-size: 0.62rem;
				padding: 1px 4px;
			}

			/* Ensure bonus inventory stays one line (no vertical wrap) and looks compact. */
			#bottom-bar-bonus .bonus-inventory {
				display: flex;
				flex-wrap: nowrap;
				gap: 3px;
				justify-content: space-between;
				align-items: center;
				overflow: hidden;
				padding: 0;
			}
			#bottom-bar-bonus .bonus-inventory::-webkit-scrollbar { display: none; }

			#bottom-bar-bonus #bonus-zone {
				background: transparent !important;
				border: none !important;
				box-shadow: none !important;
				padding: 0 !important;
			}

			#bottom-bar-bonus .bonus-badge .bonus-label { display: none !important; }
			#bottom-bar-bonus .bonus-badge .bonus-swatch {
				width: 10px;
				height: 10px;
				border-radius: 3px;
			}
			#bottom-bar-bonus .bonus-badge .bonus-count {
				margin-left: 0;
				font-size: 0.58rem;
				padding: 0 4px;
			}

			/* Mobile: show ONLY the total coin text (under the buy button), never the coin circles. */
			#bottom-bar #gold-zone::before {
				display: none !important;
				content: none !important;
			}
			#bottom-bar #gold-zone::after {
				display: block !important;
			}

			#bottom-bar #collected-coins,
			#bottom-bar .coin {
				display: none !important;
			}

			/* Mobile cards strip: keep buttons fully inside the bar.
			   Reduce left padding and reserve a bit more space on the right. */
			#bottom-bar #card-controls {
				gap: 6px;
			}
			#bottom-bar #card-options {
				padding-left: 2px;
				padding-right: 14px;
				max-width: none;
			}
			#bottom-bar #card-action-buttons {
				flex: 0 0 52px;
			}
		}

		@media (max-width: 550px) {
			/* Compact mode: prevent coins/buy from pushing bonus inventory away. */
			.bottom-bar-footer {
				margin-top: 0 !important;
			}

			#bottom-bar-bonus {
				gap: 6px;
			}
			#bottom-bar-bonus #bonus-zone {
				flex: 7 1 0 !important;
				min-width: 0 !important;
				padding: 0 !important;
			}
			#bottom-bar-bonus #gold-zone {
				flex: 3 1 0 !important;
				min-width: 0 !important;
			}
			#bottom-bar .bonus-inventory,
			#bottom-bar-bonus .bonus-inventory {
				margin: 0 !important;
				overflow: hidden !important;
				flex-wrap: nowrap !important;
				align-items: center;
			}

			#bottom-bar .bonus-badge {
				padding: 2px 5px;
				border-radius: 9px;
				font-size: 0.58rem;
			}
			#bottom-bar .bonus-badge .bonus-swatch {
				width: 10px;
				height: 10px;
			}
			#bottom-bar .bonus-badge .bonus-count {
				font-size: 0.58rem;
				padding: 0 4px;
			}

			#bottom-bar #gold-zone {
				padding: 2px 4px !important;
				background: transparent !important;
				border: none !important;
				box-shadow: none !important;
				gap: 6px !important;
			}

			#bottom-bar #gold-zone::before {
				display: none !important;
				content: none !important;
			}

			#bottom-bar #gold-zone::after {
				font-size: 0.76rem;
				font-weight: 800;
			}

			#bottom-bar .buy-placement-btn {
				margin-top: 0 !important;
				padding: 3px 6px !important;
				gap: 4px !important;
				border: none !important;
				box-shadow: none !important;
				font-size: 0.62rem !important;
			}
			#bottom-bar .buy-placement-arrow { font-size: 0.8rem !important; }
			#bottom-bar .buy-placement-rainbow-cell { width: 12px !important; height: 12px !important; border-radius: min(5px, calc(12px / 5)) !important; }
			#bottom-bar .buy-placement-cost { font-size: 0.58rem !important; padding: 0 3px !important; }

			/* Bonus upgrade shop is no longer accessed via a button. */
			#bonus-shop-btn,
			#bottom-bar #bonus-shop-btn {
				display: none !important;
			}

			/* Make the key action buttons smaller on very compact mobile. */
			#bottom-bar #new-cards-btn,
			#bottom-bar #bonus-shop-btn {
				height: 42px;
				padding: 6px 10px;
				font-size: 0.68rem;
			}

			#card-action-buttons .card-action-btn,
			#card-action-buttons .deck-preview {
				min-height: 42px;
				width: 42px;
				border-radius: 12px;
			}

			#card-action-buttons .deck-count {
				padding: 0;
				font-size: 0.72rem;
				border-radius: 0;
				min-width: 0;
			}
			#card-action-buttons .deck-count::before { display: none; }

			/* Deck: show icon above smaller number (narrower). */
			#card-action-buttons .deck-preview {
				flex-direction: column;
				gap: 2px;
			}
			#card-action-buttons .deck-preview::before {
				content: 'ðŸ“š';
				display: block;
				font-size: 1.05rem;
				line-height: 1;
			}
		}
	}


	.score-popup {
	  position: absolute;
	  font-size: 1.4rem;
	  font-weight: bold;
	  color: #222;
	  text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
	  pointer-events: none;
	  opacity: 0;
	  transform: translateY(0);
	  animation: floatUp 1s ease-out forwards;
	  z-index: var(--z-score);
	}

	@keyframes floatUp {
	  0% {
		opacity: 1;
		transform: translateY(0);
	  }
	  100% {
		opacity: 0;
		transform: translateY(-40px);
	  }
	}
	
	.sparkle {
	  position: absolute;
	  width: 16px;
	  height: 16px;
	  border-radius: 70%;
	  background: gold;
	  opacity: 0.5;
	  animation: sparkle 1.8s ease-out forwards;
	  pointer-events: none;
	  z-index: var(--z-score);
	}

	@keyframes sparkle {
	  0% { transform: scale(1) translate(0, 0); opacity: 1; }
	  100% { transform: scale(0) translate(var(--dx), var(--dy)); opacity: 0; }
	}
	
		/* Zorg dat .flash overal kan werken */
	.flash {
	  animation: flashAnim 0.4s ease;
	}

	@keyframes flashAnim {
	  0% {
		transform: scale(1.4);
		color: #fff;
		text-shadow: 0 0 8px #fff;
		filter: brightness(2);
	  }
	  100% {
		transform: scale(1);
		text-shadow: none;
		filter: brightness(1);

	  }
}


	/* ============================================
	   DARK MODE TOGGLE BUTTON (DESKTOP)
	   ============================================
	   Ronde knop rechtsboven voor dark/light mode wisselen
	   Alleen zichtbaar op desktop (>650px)
	   Op mobiel zit dark mode toggle in hamburger menu
	*/
	#dark-mode-toggle {
	  position: fixed;
	  top: 15px;
	  right: 15px;
	  background: #fff;
	  color: #333;
	  border: none;
	  border-radius: 50%;
	  width: 40px;
	  height: 40px;
	  font-size: 20px;
	  cursor: pointer;
	  box-shadow: 0 2px 6px rgba(0,0,0,0.25);
	  transition: background 0.3s, transform 0.2s;
	  z-index: 2000;
	}
	/* Dark/light is available in the hamburger menu; hide this floating button to save top space. */
	#dark-mode-toggle { display: none !important; }

	@media (max-width: 650px) {
	  #dark-mode-toggle {
		display: none; /* Op mobiel gebruiken we de knop in het menu */
	  }
	}

	#dark-mode-toggle:hover {
	  transform: scale(1.1);
	}

	/* ============================================
	   DARK MODE ALGEMEEN - DESKTOP/SHARED
	   ============================================
	   Extra dark mode styling voor desktop elementen
	   Basis dark mode staat bovenaan in het bestand
	*/

	/* Titels krijgen lichtblauwe gloed voor betere zichtbaarheid */
	body.dark-mode h1, 
	body.dark-mode #total-score {
	  color: #f0f3ff;
	  text-shadow: 0 0 10px rgba(100, 150, 255, 0.3);
	}

	body.dark-mode h2 {
	  color: #a0a3ad;
	  font-weight: 500;
	}

	/* Cellen: donker met blauwe gloed bij activatie */
	body.dark-mode .cell {
	  background: #272a31;
	  border: 1px solid #3a3d45;
	  color: #ddd;
	  transition: background 0.25s, transform 0.15s;
	}

	body.dark-mode .cell.active {
	  background: #3a6ff7;
	  color: #fff;
	  box-shadow: 0 0 8px rgba(58,111,247,0.4);
	}

	/* Hover effect op cellen */
	body.dark-mode .cell:hover {
	  background: #31343b;
	}

	/* Symbolen iets minder verzadigd in dark mode */
	body.dark-mode .symbol {
	  filter: brightness(0.9) saturate(0.9);
	}

	body.dark-mode .symbol.trap-symbol {
	  background: #555555;
	}

	body.dark-mode .symbol.trap-symbol::after {
	  background: linear-gradient(135deg, rgba(220,220,220,0.25) 0%, rgba(220,220,220,0) 50%);
	}

	body.dark-mode .symbol.trap-symbol.trap-symbol--black-hole {
	  background: radial-gradient(circle, #2a2a3e 0%, #1a1a2e 60%, #0a0a15 100%);
	  border-radius: 50%;
	  box-shadow: 
		0 0 20px rgba(138, 43, 226, 0.8),
		0 0 30px rgba(75, 0, 130, 0.6),
		inset 0 0 25px rgba(138, 43, 226, 0.4);
	  border: 2px solid rgba(138, 43, 226, 0.6);
	}

	body.dark-mode .symbol.trap-symbol.trap-symbol--black-hole::after {
	  background: radial-gradient(circle, rgba(138, 43, 226, 0.3) 0%, transparent 70%);
	  opacity: 1;
	  border-radius: 50%;
	}
	
	/* Gouden vak wordt donkergrijs met scoreboard styling */
	body.dark-mode #gold-zone { 
		background: linear-gradient(145deg, #22252b, #1a1c21);
		border: 1px solid #2d2f36;
		box-shadow: 0 0 12px rgba(0,0,0,0.6);
		color: #e5e5e5;
	}

	/* Scorebord dark mode styling */
	body.dark-mode #scoreboard {
	  background: linear-gradient(145deg, #22252b, #1a1c21);
	  border: 1px solid #2d2f36;
	  box-shadow: 0 0 12px rgba(0,0,0,0.6);
	  color: #e5e5e5;
	}
	
	body.dark-mode .score-row { 
		background: #2a2d35;
		color: #e5e5e5;
	}

	/* Dark mode knop zelf krijgt ook dark styling */
	body.dark-mode #dark-mode-toggle {
	  background: #2d2f35;
	  color: #f0f3ff;
	  box-shadow: 0 2px 6px rgba(0,0,0,0.5);
	}

	/* ============================================
	   KAART SYSTEEM - BASIS
	   ============================================
	   Kaarten die je kunt plaatsen op het bord
	   Gebruikt CSS Grid voor cel-layout binnen kaart
	*/
	.card {
	  display: grid;
	  background: #f0f0f0;
	  border-radius: 8px;
	  transition: transform 0.2s, box-shadow 0.2s;
	}
	
	/* kaarten */
	body.dark-mode .card {
	  background: #333;
	}
	
	.card:hover {
	  transform: scale(1.05);
	  box-shadow: 0 0 6px rgba(0,0,0,0.25);
	}
	.card-cell {
	  width: var(--card-cell-size, 20px);
	  height: var(--card-cell-size, 20px);
	  /* Border-radius: max 5px, minder rond voor kleine cells */
	  border-radius: min(5px, calc(var(--card-cell-size, 20px) / 5));
	}

	.card.selected {
	  outline: 3px solid #7a8aad;
	}
	
	body.dark-mode .card.selected {
	  outline: 3px solid #a7a9ad;
	}

	.draggable {
	  cursor: none;
	  transition: box-shadow 0.2s;
	  z-index: var(--z-draggable);
	}

	.draggable:active {
	  cursor: none;
	  box-shadow: 0 0 10px rgba(0,0,0,0.5);
	}
	
	/* preview styling - cells blijven exact dezelfde grootte als grid cells */
	.cell.preview-allowed {
	  outline: 2px solid rgba(0,200,100,0.8);
	  transition: outline 0.08s;
	}
	.cell.preview-denied {
	  outline: 2px solid rgba(220,20,60,0.8);
	  transition: outline 0.08s;
	}
	
	body.dragging * {
	  cursor: none !important;
	  -webkit-user-select: none !important;
	  user-select: none !important;
	}

	.draggable { touch-action: none; user-select: none; cursor: none; }

	/* ============================================
	   BONUS INVENTORY STYLING (GLOBAL)
	   ============================================
	   Werkt voor zowel desktop (#bonus-zone) als mobiel (#bottom-bar-bonus)
	   Specifieke overrides voor mobiel staan in de mobiele media queries
	*/
	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge {
		position: relative;
		overflow: hidden;
		appearance: none;
		display: inline-flex;
		align-items: center;
		gap: 6px;
		border: 1px solid transparent;
		border-radius: 12px;
		padding: 6px 10px;
		font-size: 0.74rem;
		color: #1c2434;
		background: linear-gradient(150deg, rgba(255,255,255,0.96) 0%, rgba(236,246,255,0.92) 100%);
		box-shadow: 0 10px 22px rgba(10, 12, 20, 0.22);
		transition: transform 0.15s ease, box-shadow 0.15s ease;
		cursor: pointer;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge::before {
		content: "";
		position: absolute;
		inset: 0;
		background: linear-gradient(120deg, rgba(255,255,255,0.4), rgba(255,255,255,0));
		opacity: 0.45;
		pointer-events: none;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge:not(.disabled):hover {
		transform: translateY(-1px);
		box-shadow: 0 14px 30px rgba(10, 12, 20, 0.28);
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge .bonus-count {
		background: rgba(255,255,255,0.32);
		color: inherit;
		margin-left: auto;
		font-variant-numeric: tabular-nums;
		font-weight: 600;
		padding: 2px 6px;
		border-radius: 12px;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge .bonus-swatch {
		width: 14px;
		height: 14px;
		border-radius: 50%;
		flex-shrink: 0;
		box-shadow: inset 0 0 0 1px rgba(0,0,0,0.25);
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge .bonus-label {
		position: absolute;
		clip: rect(0 0 0 0);
		clip-path: inset(50%);
		height: 1px;
		width: 1px;
		overflow: hidden;
		white-space: nowrap;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="geel"] {
		background: linear-gradient(135deg, #fff2b0, #f2c94c);
		border-color: rgba(214, 176, 68, 0.6);
		color: #463100;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="rood"] {
		background: linear-gradient(135deg, #ffd6d3, #f58f9c);
		border-color: rgba(212, 112, 122, 0.55);
		color: #4a1420;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="groen"] {
		background: linear-gradient(135deg, #d5f5d2, #8fcfa0);
		border-color: rgba(104, 180, 126, 0.55);
		color: #143720;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="paars"] {
		background: linear-gradient(135deg, #eadcff, #b9a4f9);
		border-color: rgba(146, 110, 209, 0.55);
		color: #2d1955;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="blauw"] {
		background: linear-gradient(135deg, #d3e9ff, #8cbaf5);
		border-color: rgba(94, 138, 196, 0.55);
		color: #123357;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.active {
		box-shadow: 0 0 0 2px rgba(82,118,255,0.38), 0 12px 28px rgba(48,72,140,0.35);
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.bonus-mastered {
		border-style: solid;
		box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.6), 0 16px 30px rgba(255, 215, 0, 0.35);
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.bonus-mastered .bonus-count {
		background: rgba(255, 255, 255, 0.6);
		color: inherit;
		font-weight: 700;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.disabled,
	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge:disabled {
		opacity: 0.9;
		box-shadow: none;
		border-style: dashed;
		color: inherit;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.bonus-mastered.disabled,
	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.bonus-mastered:disabled {
		opacity: 1;
		border-style: solid;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.disabled::before,
	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge:disabled::before {
		opacity: 0.2;
	}

	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.disabled::after,
	:is(#bonus-zone, #bottom-bar-bonus) .bonus-badge:disabled::after {
		content: "";
		position: absolute;
		inset: 0;
		background: linear-gradient(0deg, rgba(255,255,255,0.55), rgba(255,255,255,0));
		pointer-events: none;
	}

	/* Dark mode bonus badges */
	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge {
		box-shadow: 0 16px 32px rgba(0,0,0,0.5);
		color: #f5f6ff;
	}
	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.bonus-mastered {
		box-shadow: 0 0 0 2px rgba(255, 214, 97, 0.7), 0 16px 34px rgba(255, 214, 97, 0.42);
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge::before {
		background: linear-gradient(120deg, rgba(255,255,255,0.18), rgba(255,255,255,0));
		opacity: 0.3;
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="geel"] {
		background: linear-gradient(140deg, rgba(255, 207, 102, 0.24), rgba(198, 147, 44, 0.58));
		border-color: rgba(255, 207, 102, 0.45);
		color: #fff3c0;
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="rood"] {
		background: linear-gradient(140deg, rgba(255, 170, 174, 0.25), rgba(215, 90, 112, 0.6));
		border-color: rgba(215, 90, 112, 0.45);
		color: #ffd6dc;
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="groen"] {
		background: linear-gradient(140deg, rgba(158, 223, 175, 0.2), rgba(78, 148, 102, 0.55));
		border-color: rgba(118, 186, 136, 0.45);
		color: #ddffe7;
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="paars"] {
		background: linear-gradient(140deg, rgba(210, 186, 255, 0.24), rgba(120, 92, 190, 0.65));
		border-color: rgba(167, 132, 230, 0.45);
		color: #f0e9ff;
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge[data-bonus-color="blauw"] {
		background: linear-gradient(140deg, rgba(168, 205, 255, 0.22), rgba(70, 116, 186, 0.6));
		border-color: rgba(120, 162, 226, 0.45);
		color: #e2f1ff;
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.active {
		box-shadow: 0 0 0 2px rgba(142,174,255,0.38), 0 16px 32px rgba(0,0,0,0.55);
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.disabled,
	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge:disabled {
		opacity: 0.85;
		border-color: rgba(142,174,255,0.35);
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge.disabled::after,
	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge:disabled::after {
		background: linear-gradient(0deg, rgba(4,6,14,0.55), rgba(4,6,14,0));
	}

	body.dark-mode :is(#bonus-zone, #bottom-bar-bonus) .bonus-badge .bonus-count {
		background: rgba(12,14,20,0.55);
		color: #f5f6ff;
	}

	

	/* ============================================
	   DESKTOP LAYOUT (>650px)
	   ============================================
	   Op grotere schermen gebruiken we een 4-kolommen layout
	   zonder bottom-bar. Alle controls zijn altijd zichtbaar.
	   
	   Kolom 1: Paars + Rood vak
	   Kolom 2: Groen + Geel vak
	   Kolom 3: Blauw vak
	   Kolom 4: Score, Munten, Bonus, Doelen
	*/
	@media (min-width: 651px) {
	  html {
		background: #2d3142;
		overflow: hidden;
		height: 100%;
	  }

	  html, body {
		scrollbar-width: none;
		-ms-overflow-style: none;
	  }

	  html::-webkit-scrollbar,
	  body::-webkit-scrollbar {
		display: none;
		width: 0;
		height: 0;
	  }

	  body {
		display: grid;
		position: static;
		margin: 0;
		padding: 10px;
		min-height: 100vh;
		min-height: 100svh;
		width: 100%;
		background: #2d3142;
		color: #e5e5e5;
		overflow: hidden;
	  }

	  body.dark-mode {
		background: #1b1d22;
		color: #e5e5e5;
	  }

	  /* ============================================
	     DESKTOP LAYOUT REORGANISATIE
	     ============================================
	     - Doel bovenaan (boven de grids)
	     - Menu linksbovenin
	     - Grids centraal
	     - Score, bonussen en kaarten onderaan
	  */

  /* Wrapper voor desktop layout */
  #desktop-wrapper {
	display: grid;
	grid-template-areas:
	  "menu objective objective"
	  "left grids right"
	  "left bottom right";
		grid-template-columns: minmax(200px, 280px) 1fr minmax(200px, 290px);
	grid-template-rows: auto 1fr auto;
	gap: 16px;
	padding: 12px;
	/* Use 100% instead of 100vw to avoid horizontal clipping inside padded body. */
	width: 100%;
	height: calc(100vh - 20px);
	box-sizing: border-box;
	margin: 0 auto;
	position: relative;
	overflow: hidden;
	transform-origin: top center;
  }

	  /* Portrait mode: stack (objective -> board -> bottom) so nothing ends up off-screen on narrow widths. */
	  body.desktop-portrait {
		/* No scrolling - everything should fit */
		overflow: hidden;
	  }

	  body.desktop-portrait #desktop-wrapper {
		display: flex;
		flex-direction: column;
		flex-wrap: nowrap;
		align-items: center;
		justify-content: flex-start;
		gap: 4px;
		width: 100%;
		max-width: 100%;
		margin: 0 auto;
		padding: 6px;
		box-sizing: border-box;
		height: calc(100vh - 20px);
		height: calc(100svh - 20px);
		min-height: 0;
		max-height: none;
		overflow: hidden;
	  }

	  /* Hide empty sidebars in portrait: JS moves content into #desktop-bottom. */
	  body.desktop-portrait #desktop-left,
	  body.desktop-portrait #desktop-right {
		display: none !important;
	  }

	  /* Board area - don't stretch, just fit content and scale */
	  body.desktop-portrait #desktop-grids {
		flex: 0 0 auto;
		min-height: 0;
		width: 100%;
		display: flex;
		justify-content: center;
		align-items: flex-start;
		overflow: visible;
	  }

	  /* Scale board to fit in constrained portrait */
	  body.desktop-portrait #desktop-grids .board {
		transform-origin: top center;
	  }

	  body.desktop-portrait #desktop-bottom {
		flex: 0 0 auto;
		width: 100%;
		max-width: 100%;
		margin-top: 2px;
	  }

	  /* Narrow desktop portrait (split-screen / iPad-ish): keep bottom UI compact so the board keeps height. */
	  @media (min-width: 651px) and (max-width: 925px) {
		/* Compact objective in portrait */
		body.desktop-portrait #objective-zone {
			padding: 6px 12px;
			min-height: 32px;
			gap: 8px;
		}
		body.desktop-portrait #objective-zone h2 {
			font-size: 0.85rem;
		}
		body.desktop-portrait #objective-current {
			font-size: 0.8rem;
		}
		
		body.desktop-portrait #desktop-bottom {
			flex-wrap: nowrap;
			justify-content: center;
			align-items: stretch;
			gap: 8px;
			padding: 4px 8px;
			max-height: 160px;
		}

		body.desktop-portrait #desktop-bottom-left {
			flex: 0 0 140px !important;
			min-width: 130px !important;
			max-width: 160px !important;
		}

		body.desktop-portrait #desktop-bottom-center {
			flex: 1 1 auto !important;
			min-width: 180px !important;
			max-width: 350px !important;
			align-items: center;
		}